

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Cube analysis with Gammapy (part 1) &mdash; gammapy v0.8.dev5774</title>
  

  
  
    <link rel="shortcut icon" href="../_static/gammapy_logo.ico"/>
  
  
  
    <link rel="canonical" href="http://docs.gammapy.org/dev/notebooks/cube_analysis_part1.html"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/gammapy.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="gammapy v0.8.dev5774" href="../index.html"/>
        <link rel="up" title="Tutorial notebooks" href="../tutorials.html"/>
        <link rel="next" title="Cube analysis with Gammapy (part 2)" href="cube_analysis_part2.html"/>
        <link rel="prev" title="Flux point fitting in Gammapy" href="sed_fitting_gammacat_fermi.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> gammapy
          

          
          </a>

          
            
            
              <div class="version">
                0.8.dev5774
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#quick-install-guide">Quick install guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#stable-version">Stable version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#development-version">Development version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#verify">Verify</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#need-help">Need help?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#detailed-information">Detailed information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/conda.html">Installation with conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/pip.html">Installation with pip or setup.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/pip.html#install-pip">pip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/pip.html#setup-py">setup.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/macports.html">Installation with Macports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/other.html">Other package managers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id1">apt-get</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id2">yum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id3">Homebrew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id4">Fermi ScienceTools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/check.html">Check Gammapy installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#how-to-run-checks">How to run checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#common-issues">Common issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/dependencies.html">Dependencies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#gammapy-as-a-python-package-and-set-of-science-tools">Gammapy as a Python package and set of science tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#getting-set-up">Getting set up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#need-help">Need help?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#using-gammapy-as-a-python-package">Using Gammapy as a Python package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#using-gammapy-from-the-jupyter-notebooks">Using Gammapy from the Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#using-gammapy-via-command-line-tools">Using Gammapy via command line tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#what-next">What next?</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorial notebooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#what-is-this">What is this?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#set-up">Set up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#execute-tutorials-online">Execute tutorials online</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#the-basics">The basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#python">Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#scientific-python">Scientific Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#astropy">Astropy</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#notebooks">Notebooks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="first_steps.html">Getting started with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Sky-images">Sky images</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Event-lists">Event lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Source-catalogs">Source catalogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Spectral-models-and-flux-points">Spectral models and flux points</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cta_1dc_introduction.html">CTA first data challenge (1DC) with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Notebook-and-Gammapy-Setup">Notebook and Gammapy Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Getting-the-1DC-data">Getting the 1DC data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#EVENT-data">EVENT data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#EVENT-analysis-example">EVENT analysis example</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#IRFs">IRFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Index-files-and-DataStore">Index files and DataStore</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Select-observations">Select observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Load-data">Load data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Model-XML-files">Model XML files</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cta_data_analysis.html">CTA data analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Select-observations">Select observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Make-sky-images">Make sky images</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Source-Detection">Source Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Spatial-analysis">Spatial analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_iact.html">IACT DL3 data with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_iact.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_iact.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_iact.html#Data-store">Data store</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_iact.html#Observation-selection">Observation selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_iact.html#Events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_iact.html#Effective-area">Effective area</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_iact.html#Energy-dispersion">Energy dispersion</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_iact.html#PSF">PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_iact.html#Background-model">Background model</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_iact.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_iact.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_fermi_lat.html">Fermi-LAT data with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_fermi_lat.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_fermi_lat.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_fermi_lat.html#FermiLATDataset-class">FermiLATDataset class</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_fermi_lat.html#Events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_fermi_lat.html#PSF">PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_fermi_lat.html#Exposure">Exposure</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_fermi_lat.html#Galactic-diffuse-background">Galactic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_fermi_lat.html#Isotropic-diffuse-background">Isotropic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_fermi_lat.html#Estimating-basic-input-sky-images-for-high-level-analyses">Estimating basic input sky images for high level analyses</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_fermi_lat.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_fermi_lat.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_pipe.html">Image analysis with Gammapy (run pipeline)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_pipe.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_pipe.html#Define-inputs">Define inputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_pipe.html#Make-the-images">Make the images</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_pipe.html#Check-the-results">Check the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_pipe.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_analysis.html">Image analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Dataset">Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Counts-image">Counts image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_analysis.html#Background-modeling">Background modeling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Morphology-fit">Morphology fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="detect_ts.html">Source detection with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Compute-TS-image">Compute TS image</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Plot-images">Plot images</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Source-catalog">Source catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Measurements">Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Compare-to-2FHL">Compare to 2FHL</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_fitting_with_sherpa.html">CTA 2D source fitting with Sherpa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Read-sky-images">Read sky images</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_models.html">Spectral models in Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Create-a-model">Create a model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Get-and-set-model-parameters">Get and set model parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#List-available-models">List available models</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Plotting">Plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Parameter-errors">Parameter errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Integral-fluxes">Integral fluxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#User-defined-model">User-defined model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#What's-next?">What’s next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_pipe.html">Spectrum analysis with Gammapy (run pipeline)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Select-data">Select data</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Configure-the-analysis">Configure the analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Run-the-analysis">Run the analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Check-out-the-results">Check out the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_analysis.html">Spectral analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Configure-logger">Configure logger</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Load-Data">Load Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Define-Target-Region">Define Target Region</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Load-exclusion-mask">Load exclusion mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Estimate-background">Estimate background</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Source-statistic">Source statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Extract-spectrum">Extract spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Look-at-observations">Look at observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Fit-spectrum">Fit spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Compute-Flux-Points">Compute Flux Points</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Stack-observations">Stack observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cta_simulation.html">CTA simulation tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cta_simulation.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_simulation.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_simulation.html#PKS-2155-304-selection-from-the-3FHL-Fermi/LAT-catalogue">PKS 2155-304 selection from the 3FHL Fermi/LAT catalogue</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_simulation.html#Select-a-model-for-EBL-absorption">Select a model for EBL absorption</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_simulation.html#CTA-instrument-response-functions">CTA instrument response functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_simulation.html#CTA-simulation-of-an-observation">CTA simulation of an observation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_simulation.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_simulation.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_fitting_with_sherpa.html">Fitting gammapy spectra with sherpa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Importing-sherpa-high-level-UI">Importing sherpa high level UI</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Creating-the-source-model">Creating the source model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Perform-the-fit-and-compute-errors">Perform the fit and compute errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Plot-the-result">Plot the result</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Errors-and-confidence-contours">Errors and confidence contours</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sed_fitting_gammacat_fermi.html">Flux point fitting in Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Load-spectral-points">Load spectral points</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Fitter-Setup">Fitter Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Power-Law-Fit">Power Law Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Exponential-Cut-Off-Powerlaw-Fit">Exponential Cut-Off Powerlaw Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Log-Parabola-Fit">Log-Parabola Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Cube analysis with Gammapy (part 1)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Data-preparation">Data preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cube_analysis_part2.html">Cube analysis with Gammapy (part 2)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cube_analysis_part2.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cube_analysis_part2.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cube_analysis_part2.html#3D-analysis-assuming-that-there-is-no-energy-dispersion-(perfect-energy-resolution)">3D analysis assuming that there is no energy dispersion (perfect energy resolution)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cube_analysis_part2.html#Add-an-exlusion-mask-for-the-Fit">Add an exlusion mask for the Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="cube_analysis_part2.html#3D-analysis-taking-into-account-the-energy-dispersion">3D analysis taking into account the energy dispersion</a></li>
<li class="toctree-l4"><a class="reference internal" href="cube_analysis_part2.html#Discussion">Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="light_curve.html">Example of light curve</a><ul>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Extract-spectral-data">Extract spectral data</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Light-curve-estimation">Light curve estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Exercises">Exercises</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#extra-topics">Extra topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="background_model.html">Template background model production with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Compute-background-model">Compute background model</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Inspect-the-background-model">Inspect the background model</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Make-new-HDU-index-table-including-background">Make new HDU index table including background</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cwt.html">CWT Algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#CWT-Algorithm.-PlayGround">CWT Algorithm. PlayGround</a></li>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#Results-of-analysis">Results of analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="nddata_demo.html">How to use the NDDataArray class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nddata_demo.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="nddata_demo.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="nddata_demo.html#1D-example">1D example</a></li>
<li class="toctree-l4"><a class="reference internal" href="nddata_demo.html#2D-example">2D example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="using_numpy.html">Rapid introduction on using numpy, scipy, matplotlib</a><ul>
<li class="toctree-l4"><a class="reference internal" href="using_numpy.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="using_numpy.html#numpy:-arrays,-indexing-etc">numpy: arrays, indexing etc</a></li>
<li class="toctree-l4"><a class="reference internal" href="using_numpy.html#Plotting-with-matplotlib">Plotting with matplotlib</a></li>
<li class="toctree-l4"><a class="reference internal" href="using_numpy.html#Vectorization-or-loops:-A-very-simple-MC">Vectorization or loops: A very simple MC</a></li>
<li class="toctree-l4"><a class="reference internal" href="using_numpy.html#Exercices">Exercices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#work-in-progress">Work in progress</a><ul>
<li class="toctree-l3"><a class="reference internal" href="source_population_model.html">Astrophysical source population modeling with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Simulate-positions">Simulate positions</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Simulate-luminosities">Simulate luminosities</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Compute-observable-parameters">Compute observable parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Check-output">Check output</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source_catalogs.html">Gamma-ray source catalogs with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source_catalogs.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_catalogs.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_catalogs.html#Access-catalogs-and-sources">Access catalogs and sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_catalogs.html#Loading-catalogs">Loading catalogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_catalogs.html#Select-a-subset-of-sources-of-interest">Select a subset of sources of interest</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_catalogs.html#Plot-parameter-distributions">Plot parameter distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_catalogs.html#Plot-a-sky-image-with-source-position-markers">Plot a sky image with source position markers</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_catalogs.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fermi_vela_model.html">Gammapy IPython notebook : Fermi-LAT Vela region model</a></li>
<li class="toctree-l3"><a class="reference internal" href="source_diffuse_estimation.html">Simulating and analysing sources and diffuse emission</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source_diffuse_estimation.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_diffuse_estimation.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_diffuse_estimation.html#Simulation">Simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_diffuse_estimation.html#Analysis">Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_diffuse_estimation.html#Plot-results">Plot results</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_diffuse_estimation.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_diffuse_estimation.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="time_analysis.html">Time analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="time_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="time_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="time_analysis.html#Light-curves">Light curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="time_analysis.html#Event-analysis">Event analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="time_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="time_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dataformats/index.html">Data Formats</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dataformats/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataformats/index.html#sub-pages">Sub-pages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dataformats/file_formats.html">File formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dataformats/file_formats.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataformats/file_formats.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataformats/file_formats.html#validation">Validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataformats/file_formats.html#useful-links">Useful links</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../astro/index.html">Sources / population models (<code class="docutils literal notranslate"><span class="pre">astro</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#sub-packages">Sub-packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../astro/source/index.html">Astrophysical source models (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#using-gammapy-astro-source">Using <code class="docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../astro/population/index.html">Astrophysical source population models (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.population</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">Background estimation (<code class="docutils literal notranslate"><span class="pre">background</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/index.html#using-gammapy-background">Using <code class="docutils literal notranslate"><span class="pre">gammapy.background</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../background/energy_offset_array.html">EnergyOffset Array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../background/reflected.html">Reflected regions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/index.html#module-gammapy.background">gammapy.background Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../background/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../background/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../catalog/index.html">Source catalogs (<code class="docutils literal notranslate"><span class="pre">catalog</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#available-catalogs">Available catalogs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#how-it-works">How it works</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#content">Content</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/gammacat.html">gamma-cat</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../catalog/gammacat.html#catalog">Catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/gammacat.html#data-collection">Data collection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#module-gammapy.catalog">gammapy.catalog Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cube/index.html">3D cube analysis (<code class="docutils literal notranslate"><span class="pre">cube</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#using-gammapy-cube">Using <code class="docutils literal notranslate"><span class="pre">gammapy.cube</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cube/index.html#module-gammapy.cube">gammapy.cube Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">Data / observation handling (<code class="docutils literal notranslate"><span class="pre">data</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#using-gammapy-data">Using <code class="docutils literal notranslate"><span class="pre">gammapy.data</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/dm.html">Data Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/dm.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dm.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dm.html#command-line-tools">Command line tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dm.html#data-formats">Data formats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../data/obs_group.html">Observation grouping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/obs_group.html#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#module-gammapy.data">gammapy.data Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../datasets/index.html">Dataset access (<code class="docutils literal notranslate"><span class="pre">datasets</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#gammapy-extra">gammapy-extra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#gamma-cat">Gamma-cat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#using-gammapy-datasets">Using <code class="docutils literal notranslate"><span class="pre">gammapy.datasets</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../datasets/make_datasets.html">Simulate event lists</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../datasets/make_datasets.html#using-ctobssim">Using ctobssim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../datasets/make_datasets.html#using-gammapy">Using Gammapy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../datasets/index.html#module-gammapy.datasets">gammapy.datasets Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../datasets/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../datasets/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../datasets/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../detect/index.html">Source detection tools (<code class="docutils literal notranslate"><span class="pre">detect</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#computation-of-ts-images">Computation of TS images</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../detect/index.html#command-line-tool">Command line tool</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#computation-of-li-ma-significance-images">Computation of Li &amp; Ma significance images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#iterative-source-detection">Iterative source detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../detect/index.html#module-gammapy.detect">gammapy.detect Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../detect/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../detect/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../image/index.html">2D image analysis (<code class="docutils literal notranslate"><span class="pre">image</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#using-gammapy-image">Using <code class="docutils literal notranslate"><span class="pre">gammapy.image</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../image/sky_image.html">Sky image</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/sky_image.html#introduction-and-concept">Introduction and Concept</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/sky_image.html#getting-started">Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/sky_image.html#cutout-and-paste">Cutout and paste</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/plotting.html">Image plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/plotting.html#colormaps">Colormaps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/plotting.html#multi-panel-galactic-plane-survey-image-plots">Multi-panel Galactic plane survey image plots</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/models.html">Morphology models (<code class="docutils literal notranslate"><span class="pre">gammapy.image.models</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#reference-api">Reference/API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../image/index.html#module-gammapy.image">gammapy.image Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/index.html#module-gammapy.image.models">gammapy.image.models Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#id1">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#id2">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../irf/index.html">Instrument response functions (<code class="docutils literal notranslate"><span class="pre">irf</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#using-gammapy-irf">Using <code class="docutils literal notranslate"><span class="pre">gammapy.irf</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../irf/theory.html">IRF Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/aeff.html">Effective area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/edisp.html">Energy dispersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/psf.html">Point spread function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../irf/psf.html#table-psf">Table PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../irf/psf.html#king-psf">King PSF</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../irf/index.html#module-gammapy.irf">gammapy.irf Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../irf/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../irf/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum/index.html">1D spectrum analysis (<code class="docutils literal notranslate"><span class="pre">spectrum</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#using-gammapy-spectrum">Using <code class="docutils literal notranslate"><span class="pre">gammapy.spectrum</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/fitting.html">Spectral Fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/fitting.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/fitting.html#interactive-sherpa-fit">Interactive Sherpa Fit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/energy_group.html">Spectrum energy grouping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/energy_group.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/energy_group.html#other-packages">Other packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/energy_group.html#gammapy-design">Gammapy Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/energy_group.html#gammapy-examples">Gammapy Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/energy_group.html#gammapy-implementation">Gammapy implementation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/index.html#module-gammapy.spectrum">gammapy.spectrum Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/index.html#module-gammapy.spectrum.models">gammapy.spectrum.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#id4">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stats/index.html">Statistics tools (<code class="docutils literal notranslate"><span class="pre">stats</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#li-ma-significance">Li &amp; Ma Significance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#confidence-intervals">Confidence Intervals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#using-gammapy-stats">Using <code class="docutils literal notranslate"><span class="pre">gammapy.stats</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/feldman_cousins.html">Feldman and Cousins Confidence Intervals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#acceptance-interval-fixing">Acceptance Interval Fixing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#sensitivity">Sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#general-case">General Case</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#verification">Verification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stats/fit_statistics.html">Fit statistics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#gaussian-data">Gaussian data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#poisson-data">Poisson data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#poisson-data-with-background-measurement">Poisson data with background measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#further-references">Further references</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#module-gammapy.stats">gammapy.stats Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../time/index.html">Time analysis (<code class="docutils literal notranslate"><span class="pre">time</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#lightcurve">Lightcurve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#variability-test">Variability test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#other-codes">Other codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#content">Content</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/period.html">Period detection and plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#module-gammapy.time">gammapy.time Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#module-gammapy.time.models">gammapy.time.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">Utility functions / classes (<code class="docutils literal notranslate"><span class="pre">utils</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#time-handling-in-gammapy">Time handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#time-format-and-scale">Time format and scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#mission-elapsed-times-met">Mission elapsed times (MET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#time-differences">Time differences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#energy-handling-in-gammapy">Energy handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#energy">Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#energybounds">EnergyBounds</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.energy">gammapy.utils.energy Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.units">gammapy.utils.units Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.coordinates">gammapy.utils.coordinates Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id3">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#variables">Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.table">gammapy.utils.table Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id4">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.fits">gammapy.utils.fits Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#gammapy-fits-utilities">Gammapy FITS utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id5">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id6">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.root">gammapy.utils.root Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id7">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.random">gammapy.utils.random Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id8">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.distributions">gammapy.utils.distributions Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id9">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id10">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.scripts">gammapy.utils.scripts Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id11">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id12">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.testing">gammapy.utils.testing Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id13">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.wcs">gammapy.utils.wcs Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id14">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.nddata">gammapy.utils.nddata Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id15">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id16">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.time">gammapy.utils.time Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id17">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.modeling">gammapy.utils.modeling Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id18">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.fitting">gammapy.utils.fitting Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id19">Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../maps/index.html">Structures for images / cubes (<code class="docutils literal notranslate"><span class="pre">maps</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#constructing-with-factory-methods">Constructing with Factory Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#accessor-methods">Accessor Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#interface-with-mapcoord-and-skycoord">Interface with <code class="docutils literal notranslate"><span class="pre">MapCoord</span></code> and <code class="docutils literal notranslate"><span class="pre">SkyCoord</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#mapcoord">MapCoord</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#interpolation">Interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#projection">Projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#slicing-methods">Slicing Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#iterating-on-a-map">Iterating on a Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#fits-i-o">FITS I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#visualization">Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#creating-a-counts-cube-from-an-ft1-file">Creating a Counts Cube from an FT1 File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#generating-a-cutout-of-a-model-cube">Generating a Cutout of a Model Cube</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#using-gammapy-maps">Using <code class="docutils literal notranslate"><span class="pre">gammapy.maps</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/hpxmap.html">HEALPix-based Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../maps/hpxmap.html#healpix-geometry">HEALPix Geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maps/hpxmap.html#sparse-maps">Sparse Maps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../maps/wcsmap.html">WCS-based Maps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#module-gammapy.maps">gammapy.maps Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../maps/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maps/index.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Command line tools (<code class="docutils literal notranslate"><span class="pre">scripts</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#execute">Execute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#command-not-found">Command not found</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#reference">Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#gammapy">gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-check">check</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-image">image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-info">info</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#implementation">Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#limitations">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#plan">Plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#write-your-own-cli">Write your own CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#module-gammapy.scripts">gammapy.scripts Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Developer documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/index.html#contact-points">Contact points</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/index.html#pages">Pages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/intro.html">How to contribute to Gammapy?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#what-is-this">What is this?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#get-in-touch-early">Get in touch early</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#make-small-pull-requests">Make small pull requests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#get-set-up">Get set up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#make-a-working-example">Make a working example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#integrate-the-code-in-gammapy">Integrate the code in Gammapy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#make-a-pull-request">Make a pull request</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#code-review">Code review</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#close-the-loop">Close the loop</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development/setup.html">Gammapy project setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#gammapy-repository">gammapy repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#gammapy-extra-repository">gammapy-extra repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#other-repositories">Other repositories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#gammapy-webpages">Gammapy webpages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#continuous-integration">Continuous integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#code-quality">Code quality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#releases">Releases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#data-formats">Data formats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development/howto.html">Developer HOWTO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#how-to-clean-up-old-files">How to clean up old files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#where-should-i-import-from">Where should I import from?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#functions-returning-several-values">Functions returning several values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#python-2-and-3-support">Python 2 and 3 support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#skip-unit-tests-for-some-astropy-versions">Skip unit tests for some Astropy versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#fix-non-unix-line-endings">Fix non-Unix line endings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#check-html-links">Check HTML links</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#other-codes">Other codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#what-checks-and-conversions-should-i-do-for-inputs">What checks and conversions should I do for inputs?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#float-data-type-32-bit-or-64-bit">Float data type: 32 bit or 64 bit?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#clobber-or-overwrite">Clobber or overwrite?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#pixel-coordinate-convention">Pixel coordinate convention</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#when-to-use-c-or-cython-or-numba-for-speed">When to use C or Cython or Numba for speed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#what-belongs-in-gammapy-and-what-doesn-t">What belongs in Gammapy and what doesn’t?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#assert-convention">Assert convention</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#random-numbers">Random numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#logging">Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#command-line-tools-using-click">Command line tools using click</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#bsd-or-gpl-license">BSD or GPL license?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#changelog">Changelog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#file-and-directory-path-handling">File and directory path handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#bundled-gammapy-extern-code">Bundled gammapy.extern code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#interpolation-and-extrapolation">Interpolation and extrapolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#locate-origin-of-warnings">Locate origin of warnings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#object-summary-info-string">Object summary info string</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#validating-h-e-s-s-fits-exporters">Validating H.E.S.S. FITS exporters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#using-the-nddataarray">Using the NDDataArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#write-a-test-for-an-ipython-notebook">Write a test for an IPython notebook</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#sphinx-docs-build">Sphinx docs build</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#documentation-guidelines">Documentation guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#different-versions-of-notebooks-in-binder">Different versions of notebooks in Binder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#link-to-a-notebook-in-gammapy-extra-from-the-docs">Link to a notebook in gammapy-extra from the docs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#include-images-from-gammapy-extra-into-the-docs">Include images from gammapy-extra into the docs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development/release.html">How to make a Gammapy release</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/release.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/release.html#pre-release">Pre release</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/release.html#make-release">Make release</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/release.html#post-release">Post release</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/index.html">PIGs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/pigs/pig-001.html">PIG 1 - PIG purpose and guidelines</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../references.html#publications">Publications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#glossary">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#other-gamma-ray-packages">Other gamma-ray packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#other-useful-packages">Other useful packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#unreleased">0.8 (unreleased)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#pull-requests">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p7-release">0.7 (2018-02-28)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id3">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id4">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-28-2017">0.6 (April 28, 2017)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id5">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id6">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#november-22-2016">0.5 (November 22, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id7">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id8">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-20-2016">0.4 (April 20, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id9">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id10">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#august-13-2015">0.3 (August 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id11">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id12">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-13-2015">0.2 (April 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id13">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id14">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#august-25-2014">0.1 (August 25, 2014)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id15">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id16">Pull requests</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gammapy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorial notebooks</a> &raquo;</li>
        
      <li>Cube analysis with Gammapy (part 1)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/cube_analysis_part1.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<script type="text/javascript" src="../_static/linksdl.js"></script><div class="admonition note">
<p class="first fa fa-exclamation-circle"><strong>This is a fixed-text formatted version of a Jupyter notebook.</strong></p>
<p class="last">Try online <a class="reference external" href="https://beta.mybinder.org/v2/gh/gammapy/gammapy-extra/master?filepath=cube_analysis_part1.ipynb"><img alt="Binder" src="https://mybinder.org/badge.svg" /></a>
You can also contribute with your own notebooks in this <a class="reference external" href="https://github.com/gammapy/gammapy-extra/tree/master/notebooks">GitHub
repository</a>.
<strong>Source files:</strong>
<a class="reference external" href="../_static/notebooks/cube_analysis_part1.ipynb">cube_analysis_part1.ipynb</a>
|
<a class="reference external" href="../_static/notebooks/cube_analysis_part1.py">cube_analysis_part1.py</a></p>
</div>
<div class="section" id="Cube-analysis-with-Gammapy-(part-1)">
<h1>Cube analysis with Gammapy (part 1)<a class="headerlink" href="#Cube-analysis-with-Gammapy-(part-1)" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>In order to run a cube likelihood analysis (combined spectrum and
morphology fitting), we first have to prepare the dataset and compute
the following inputs by stacking data from observation runs: * counts,
background and exposure cube * mean PSF * mean RMF</p>
<p>These are the inputs to the likelihood fitting step, where you assume a
parameterised gamma-ray emission model and fit it to the stacked data.</p>
<p>This notebook is part 1 of 2 of a tutorial how to use
<a class="reference internal" href="../cube/index.html"><span class="doc">gammapy.cube</span></a> to do cube analysis of IACT data.
Part 1 is about these pre-computations, part 2 will be about the
likelihood fitting.</p>
<p>We will be using the following classes: *
<a class="reference internal" href="../api/gammapy.data.DataStore.html"><span class="doc">gammapy.data.DataStore</span></a> to load
the data to stack in the cube *
<a class="reference internal" href="../api/gammapy.image.SkyImage.html"><span class="doc">gammapy.image.SkyImage</span></a> to work
with sky images *
<a class="reference internal" href="../api/gammapy.cube.SkyCube.html"><span class="doc">gammapy.cube.SkyCube</span></a> and
<a class="reference internal" href="../api/gammapy.cube.StackedObsCubeMaker.html"><span class="doc">gammapy.cube.StackedObsCubeMaker</span></a>
to stack the data in the Cube *
<a class="reference internal" href="../api/gammapy.data.ObservationList.html"><span class="doc">gammapy.data.ObservationList</span></a>
to make the computation of the mean PSF and mean RMF from a set of runs.</p>
<p>The data used in this tutorial is 4 Crab runs from H.E.S.S..</p>
</div>
<div class="section" id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Permalink to this headline">¶</a></h2>
<p>As always, we start with some setup for the notebook, and with imports.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span><span class="p">,</span> <span class="n">Angle</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">simple_norm</span>

<span class="kn">from</span> <span class="nn">gammapy.data</span> <span class="kn">import</span> <span class="n">DataStore</span>
<span class="kn">from</span> <span class="nn">gammapy.image</span> <span class="kn">import</span> <span class="n">SkyImage</span>
<span class="kn">from</span> <span class="nn">gammapy.cube</span> <span class="kn">import</span> <span class="n">SkyCube</span><span class="p">,</span> <span class="n">StackedObsCubeMaker</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Data-preparation">
<h2>Data preparation<a class="headerlink" href="#Data-preparation" title="Permalink to this headline">¶</a></h2>
<p>Gammapy only supports binned likelihood fits, so we start by defining
the spatial and energy grid of the data:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># define WCS specification</span>
<span class="n">WCS_SPEC</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;nxpix&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
            <span class="s1">&#39;nypix&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
            <span class="s1">&#39;binsz&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
            <span class="s1">&#39;xref&#39;</span><span class="p">:</span> <span class="mf">83.63</span><span class="p">,</span>
            <span class="s1">&#39;yref&#39;</span><span class="p">:</span> <span class="mf">22.01</span><span class="p">,</span>
            <span class="s1">&#39;proj&#39;</span><span class="p">:</span> <span class="s1">&#39;TAN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;coordsys&#39;</span><span class="p">:</span> <span class="s1">&#39;CEL&#39;</span><span class="p">}</span>

<span class="c1"># define reconstructed energy binning</span>
<span class="n">ENERGY_SPEC</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;edges&#39;</span><span class="p">,</span>
               <span class="s1">&#39;enumbins&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
               <span class="s1">&#39;emin&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
               <span class="s1">&#39;emax&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
               <span class="s1">&#39;eunit&#39;</span><span class="p">:</span> <span class="s1">&#39;TeV&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<p>From this we create an empty <code class="docutils literal notranslate"><span class="pre">SkyCube</span></code> object, that we will use as
reference for all other sky cube data:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># instanciate reference cube</span>
<span class="n">REF_CUBE</span> <span class="o">=</span> <span class="n">SkyCube</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="o">**</span><span class="n">WCS_SPEC</span><span class="p">,</span> <span class="o">**</span><span class="n">ENERGY_SPEC</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next we create a <code class="docutils literal notranslate"><span class="pre">DataStore</span></code> object, which allows us to access and
load DL3 level data. In this case we will use four Crab runs of
simulated HESS data, which is bundled in gammapy-extra:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># setting up the data store</span>
<span class="n">data_store</span> <span class="o">=</span> <span class="n">DataStore</span><span class="o">.</span><span class="n">from_dir</span><span class="p">(</span><span class="s2">&quot;$GAMMAPY_EXTRA/test_datasets/cube/data&quot;</span><span class="p">)</span>

<span class="c1"># temporary fix for load psftable for one of the run that is not implemented yet...</span>
<span class="n">data_store</span><span class="o">.</span><span class="n">hdu_table</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For the later background estimation we define an exclusion mask. The
background image will normalized on the counts map outside the exclusion
region (the so called FOV background method). For convenience we use and
all-sky exclusin mask, which was created from the TeVCat catalog and
reproject it to our analysis region:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># read in TeVCat exclusion mask</span>
<span class="n">exclusion_mask</span> <span class="o">=</span> <span class="n">SkyImage</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;$GAMMAPY_EXTRA/datasets/exclusion_masks/tevcat_exclusion.fits&#39;</span><span class="p">)</span>

<span class="c1"># reproject exclusion mask to reference cube</span>
<span class="n">exclusion_mask</span> <span class="o">=</span> <span class="n">exclusion_mask</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="n">reference</span><span class="o">=</span><span class="n">REF_CUBE</span><span class="o">.</span><span class="n">sky_image_ref</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;nearest-neighbor&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>That’s what the exclusion mask looks like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">exclusion_mask</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_cube_analysis_part1_15_0.png" src="../_images/notebooks_cube_analysis_part1_15_0.png" />
</div>
</div>
<p>Now we can feed all the input to the <code class="docutils literal notranslate"><span class="pre">StackedObsCubeMaker</span></code> class. In
addition we have to select a offset cut:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Select the offset band on which you want to select the events in the FOV of each observation</span>
<span class="n">offset_band</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.49</span><span class="p">],</span> <span class="s1">&#39;deg&#39;</span><span class="p">)</span>

<span class="c1"># instanciate StackedObsCubeMaker</span>
<span class="n">cube_maker</span> <span class="o">=</span> <span class="n">StackedObsCubeMaker</span><span class="p">(</span>
    <span class="n">empty_cube_images</span><span class="o">=</span><span class="n">REF_CUBE</span><span class="p">,</span>
    <span class="n">empty_exposure_cube</span><span class="o">=</span><span class="n">REF_CUBE</span><span class="p">,</span>
    <span class="n">offset_band</span><span class="o">=</span><span class="n">offset_band</span><span class="p">,</span>
    <span class="n">data_store</span><span class="o">=</span><span class="n">data_store</span><span class="p">,</span>
    <span class="n">obs_table</span><span class="o">=</span><span class="n">data_store</span><span class="o">.</span><span class="n">obs_table</span><span class="p">,</span>
    <span class="n">exclusion_mask</span><span class="o">=</span><span class="n">exclusion_mask</span><span class="p">,</span>
    <span class="n">save_bkg_scale</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>We run the cube maker by calling <code class="docutils literal notranslate"><span class="pre">.make_cubes</span></code>. We pass an correlation
radius of 4 pixels to compute the Li&amp;Ma significance image:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># run cube maker</span>
<span class="n">cube_maker</span><span class="o">.</span><span class="n">make_cubes</span><span class="p">(</span><span class="n">make_background_image</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">4.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s take a look at the computed result cubes:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># get counts cube</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">cube_maker</span><span class="o">.</span><span class="n">counts_cube</span>

<span class="n">energies</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">energies</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;edges&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Bin edges of the count cubes: </span><span class="se">\n</span><span class="s2">{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">energies</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Bin edges of the count cubes:
[  0.5          1.20112443   2.88539981   6.93144843  16.65106415  40.        ] TeV
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># show counts image with idx = 0</span>
<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">counts</span><span class="o">.</span><span class="n">sky_image_idx</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Energy range: {emin:.2f} to {emax:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">emin</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">emax</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_cube_analysis_part1_22_0.png" src="../_images/notebooks_cube_analysis_part1_22_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Energy range: 0.50 TeV to 1.20 TeV
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">idx</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">counts</span><span class="o">.</span><span class="n">sky_image_idx</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Energy range: {emin:.2f} to {emax:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">emin</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">emax</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_cube_analysis_part1_23_0.png" src="../_images/notebooks_cube_analysis_part1_23_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Energy range: 6.93 TeV to 16.65 TeV
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">background</span> <span class="o">=</span> <span class="n">cube_maker</span><span class="o">.</span><span class="n">bkg_cube</span>

<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">background</span><span class="o">.</span><span class="n">sky_image_idx</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Energy range: {emin:.2f} to {emax:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">emin</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">emax</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_cube_analysis_part1_24_0.png" src="../_images/notebooks_cube_analysis_part1_24_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Energy range: 0.50 TeV to 1.20 TeV
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">excess</span> <span class="o">=</span> <span class="n">cube_maker</span><span class="o">.</span><span class="n">excess_cube</span>

<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">excess</span><span class="o">.</span><span class="n">sky_image_idx</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Energy range: {emin:.2f} to {emax:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">emin</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">emax</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_cube_analysis_part1_25_0.png" src="../_images/notebooks_cube_analysis_part1_25_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Energy range: 0.50 TeV to 1.20 TeV
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">significance</span> <span class="o">=</span> <span class="n">cube_maker</span><span class="o">.</span><span class="n">significance_cube</span>

<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">significance</span><span class="o">.</span><span class="n">sky_image_idx</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Energy range: {emin:.2f} to {emax:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">emin</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">emax</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_cube_analysis_part1_26_0.png" src="../_images/notebooks_cube_analysis_part1_26_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Energy range: 0.50 TeV to 1.20 TeV
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">exposure</span> <span class="o">=</span> <span class="n">cube_maker</span><span class="o">.</span><span class="n">exposure_cube</span>

<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">exposure</span><span class="o">.</span><span class="n">sky_image_idx</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Energy range: {emin:.2f} to {emax:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">emin</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">emax</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_cube_analysis_part1_27_0.png" src="../_images/notebooks_cube_analysis_part1_27_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Energy range: 0.50 TeV to 1.20 TeV
</pre></div></div>
</div>
<p>As a last step we’de like to compute a mean PSF across all observations
in the list. For this purpose we use the <code class="docutils literal notranslate"><span class="pre">.make_mean_psf_cube()</span></code>
method on the <code class="docutils literal notranslate"><span class="pre">StackedObsCubeMaker</span></code> object. We only have to specify a
reference cube, which is used to evaluate the PSF model:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
    <span class="n">mean_psf_cube</span> <span class="o">=</span> <span class="n">cube_maker</span><span class="o">.</span><span class="n">make_mean_psf_cube</span><span class="p">(</span><span class="n">REF_CUBE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s take a quick look a the resulting PSF:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">idx</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">psf_image</span> <span class="o">=</span> <span class="n">mean_psf_cube</span><span class="o">.</span><span class="n">sky_image_idx</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">psf_image</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">psf_image</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Energy range: {emin:.2f} to {emax:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">emin</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">emax</span><span class="o">=</span><span class="n">energies</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_cube_analysis_part1_31_0.png" src="../_images/notebooks_cube_analysis_part1_31_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Energy range: 6.93 TeV to 16.65 TeV
</pre></div></div>
</div>
<p>Now we repeat the computation but assume a different energy binning for
the “true” energy:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># define true energy binning</span>
<span class="n">ENERGY_TRUE_SPEC</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;edges&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;enumbins&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                    <span class="s1">&#39;emin&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                    <span class="s1">&#39;emax&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                    <span class="s1">&#39;eunit&#39;</span><span class="p">:</span> <span class="s1">&#39;TeV&#39;</span><span class="p">}</span>

<span class="c1"># init refereence cube</span>
<span class="n">REF_CUBE_TRUE</span> <span class="o">=</span> <span class="n">SkyCube</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="o">**</span><span class="n">WCS_SPEC</span><span class="p">,</span> <span class="o">**</span><span class="n">ENERGY_TRUE_SPEC</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The reference cube is now passed to the <code class="docutils literal notranslate"><span class="pre">empty_exposure_cube</span></code>
argument:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cube_maker</span> <span class="o">=</span> <span class="n">StackedObsCubeMaker</span><span class="p">(</span>
    <span class="n">empty_cube_images</span><span class="o">=</span><span class="n">REF_CUBE</span><span class="p">,</span>
    <span class="n">empty_exposure_cube</span><span class="o">=</span><span class="n">REF_CUBE_TRUE</span><span class="p">,</span>
    <span class="n">offset_band</span><span class="o">=</span><span class="n">offset_band</span><span class="p">,</span>
    <span class="n">data_store</span><span class="o">=</span><span class="n">data_store</span><span class="p">,</span>
    <span class="n">obs_table</span><span class="o">=</span><span class="n">data_store</span><span class="o">.</span><span class="n">obs_table</span><span class="p">,</span>
    <span class="n">exclusion_mask</span><span class="o">=</span><span class="n">exclusion_mask</span><span class="p">,</span>
    <span class="n">save_bkg_scale</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">cube_maker</span><span class="o">.</span><span class="n">make_cubes</span><span class="p">(</span><span class="n">make_background_image</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The PSF can computed using the “true” energy reference cube as well:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
    <span class="n">mean_psf_cube</span> <span class="o">=</span> <span class="n">cube_maker</span><span class="o">.</span><span class="n">make_mean_psf_cube</span><span class="p">(</span><span class="n">REF_CUBE_TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">e_reco</span> <span class="o">=</span> <span class="n">cube_maker</span><span class="o">.</span><span class="n">counts_cube</span><span class="o">.</span><span class="n">energies</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;edges&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Energy bin edges of the count cube: </span><span class="se">\n</span><span class="s2">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e_reco</span><span class="p">))</span>

<span class="n">e_true</span> <span class="o">=</span> <span class="n">cube_maker</span><span class="o">.</span><span class="n">exposure_cube</span><span class="o">.</span><span class="n">energies</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;edges&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Energy bin edges of the exposure cube: </span><span class="se">\n</span><span class="s2">{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e_true</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Energy bin edges of the count cube:
[  0.5          1.20112443   2.88539981   6.93144843  16.65106415  40.        ] TeV

Energy bin edges of the exposure cube:
[  1.00000000e-01   1.41253754e-01   1.99526231e-01   2.81838293e-01
   3.98107171e-01   5.62341325e-01   7.94328235e-01   1.12201845e+00
   1.58489319e+00   2.23872114e+00   3.16227766e+00   4.46683592e+00
   6.30957344e+00   8.91250938e+00   1.25892541e+01   1.77827941e+01
   2.51188643e+01   3.54813389e+01   5.01187234e+01   7.07945784e+01
   1.00000000e+02] TeV
</pre></div></div>
</div>
<p>Finally we compute the mean RMF (energy dispersion matrix) across
multiple observations:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># get reference energies</span>
<span class="n">obs_list</span> <span class="o">=</span> <span class="n">data_store</span><span class="o">.</span><span class="n">obs_list</span><span class="p">(</span><span class="n">data_store</span><span class="o">.</span><span class="n">obs_table</span><span class="p">[</span><span class="s1">&#39;OBS_ID&#39;</span><span class="p">])</span>
<span class="n">position</span> <span class="o">=</span> <span class="n">REF_CUBE</span><span class="o">.</span><span class="n">sky_image_ref</span><span class="o">.</span><span class="n">center</span>
<span class="n">e_true</span> <span class="o">=</span> <span class="n">REF_CUBE_TRUE</span><span class="o">.</span><span class="n">energies</span><span class="p">(</span><span class="s1">&#39;edges&#39;</span><span class="p">)</span>
<span class="n">e_reco</span> <span class="o">=</span> <span class="n">REF_CUBE</span><span class="o">.</span><span class="n">energies</span><span class="p">(</span><span class="s1">&#39;edges&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
    <span class="n">mean_rmf</span> <span class="o">=</span> <span class="n">obs_list</span><span class="o">.</span><span class="n">make_mean_edisp</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">e_true</span><span class="o">=</span><span class="n">e_true</span><span class="p">,</span> <span class="n">e_reco</span><span class="o">=</span><span class="n">e_reco</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mean_rmf</span><span class="o">.</span><span class="n">plot_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/matplotlib/colors.py:1152: UserWarning: Power-law scaling on negative values is ill-defined, clamping to 0.
  warnings.warn(&#34;Power-law scaling on negative values is &#34;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[25]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x10e0ecef0&gt;
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/matplotlib/colors.py:1113: RuntimeWarning: invalid value encountered in power
  np.power(resdat, gamma, resdat)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_cube_analysis_part1_41_3.png" src="../_images/notebooks_cube_analysis_part1_41_3.png" />
</div>
</div>
</div>
<div class="section" id="Exercises">
<h2>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Take another dataset</li>
<li>Change the Cube binning</li>
</ul>
<p>Now that we created some cubes for counts, background, exposure, psf
from a set of runs we will learn in the future tutorials how to use it
for a 3D analysis (morphological and spectral)</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cube_analysis_part2.html" class="btn btn-neutral float-right" title="Cube analysis with Gammapy (part 2)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sed_fitting_gammacat_fermi.html" class="btn btn-neutral" title="Flux point fitting in Gammapy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, The Gammapy developers.
      Last updated on 15 Apr 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.8.dev5774',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>