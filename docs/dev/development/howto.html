

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Developer HOWTO &mdash; gammapy v0.8.dev5910</title>
  

  
  
    <link rel="shortcut icon" href="../_static/gammapy_logo.ico"/>
  
  
  
    <link rel="canonical" href="http://docs.gammapy.org/dev/development/howto.html"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/gammapy.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="gammapy v0.8.dev5910" href="../index.html"/>
        <link rel="up" title="Developer documentation" href="index.html"/>
        <link rel="next" title="How to make a Gammapy release" href="release.html"/>
        <link rel="prev" title="Gammapy project setup" href="setup.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> gammapy
          

          
          </a>

          
            
            
              <div class="version">
                0.8.dev5910
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#quick-install-guide">Quick install guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#stable-version">Stable version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#development-version">Development version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#verify">Verify</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#need-help">Need help?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#detailed-information">Detailed information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/conda.html">Installation with conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/pip.html">Installation with pip or setup.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/pip.html#install-pip">pip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/pip.html#setup-py">setup.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/macports.html">Installation with Macports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/other.html">Other package managers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id1">apt-get</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id2">yum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id3">Homebrew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id4">Fermi ScienceTools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/check.html">Check Gammapy installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#how-to-run-checks">How to run checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#common-issues">Common issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/dependencies.html">Dependencies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#gammapy-as-a-python-package-and-set-of-science-tools">Gammapy as a Python package and set of science tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#getting-set-up">Getting set up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#need-help">Need help?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#using-gammapy-as-a-python-package">Using Gammapy as a Python package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#using-gammapy-from-the-jupyter-notebooks">Using Gammapy from the Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#using-gammapy-via-command-line-tools">Using Gammapy via command line tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#what-next">What next?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorial notebooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#what-is-this">What is this?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#set-up">Set up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#execute-tutorials-online">Execute tutorials online</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#the-basics">The basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#python">Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#scientific-python">Scientific Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#astropy">Astropy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#notebooks">Notebooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/first_steps.html">Getting started with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/first_steps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/first_steps.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/first_steps.html#Sky-images">Sky images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/first_steps.html#Event-lists">Event lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/first_steps.html#Source-catalogs">Source catalogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/first_steps.html#Spectral-models-and-flux-points">Spectral models and flux points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/first_steps.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html">CTA first data challenge (1DC) with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#Notebook-and-Gammapy-Setup">Notebook and Gammapy Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#Getting-the-1DC-data">Getting the 1DC data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#EVENT-data">EVENT data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#EVENT-analysis-example">EVENT analysis example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#IRFs">IRFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#Index-files-and-DataStore">Index files and DataStore</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#Select-observations">Select observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#Load-data">Load data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#Model-XML-files">Model XML files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_1dc_introduction.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/cta_data_analysis.html">CTA data analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_data_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_data_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_data_analysis.html#Select-observations">Select observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_data_analysis.html#Make-sky-images">Make sky images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_data_analysis.html#Source-Detection">Source Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_data_analysis.html#Spatial-analysis">Spatial analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_data_analysis.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_data_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_data_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/analysis_3d.html">3D analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/analysis_3d.html#Imports-and-versions">Imports and versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/analysis_3d.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/analysis_3d.html#Make-maps">Make maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/analysis_3d.html#Compute-PSF-kernel">Compute PSF kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/analysis_3d.html#Model-fit">Model fit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/simulate_3d.html">3D simulation and fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/simulate_3d.html#Imports-and-versions">Imports and versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/simulate_3d.html#Simulate">Simulate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/simulate_3d.html#Fit">Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/simulate_3d.html#iminuit">iminuit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/image_analysis.html">Image analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/image_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/image_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/image_analysis.html#Dataset">Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/image_analysis.html#Counts-image">Counts image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/image_analysis.html#Background-modeling">Background modeling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/image_analysis.html#Morphology-fit">Morphology fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/image_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/image_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/detect_ts.html">Source detection with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/detect_ts.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/detect_ts.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/detect_ts.html#Compute-TS-image">Compute TS image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/detect_ts.html#Plot-images">Plot images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/detect_ts.html#Source-catalog">Source catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/detect_ts.html#Measurements">Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/detect_ts.html#Compare-to-2FHL">Compare to 2FHL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/detect_ts.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/detect_ts.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/image_fitting_with_sherpa.html">CTA 2D source fitting with Sherpa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/image_fitting_with_sherpa.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/image_fitting_with_sherpa.html#Read-sky-images">Read sky images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/image_fitting_with_sherpa.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/image_fitting_with_sherpa.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/spectrum_models.html">Spectral models in Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_models.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_models.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_models.html#Create-a-model">Create a model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_models.html#Get-and-set-model-parameters">Get and set model parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_models.html#List-available-models">List available models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_models.html#Plotting">Plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_models.html#Parameter-errors">Parameter errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_models.html#Integral-fluxes">Integral fluxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_models.html#User-defined-model">User-defined model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_models.html#What's-next?">What’s next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/spectrum_pipe.html">Spectrum analysis with Gammapy (run pipeline)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_pipe.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_pipe.html#Select-data">Select data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_pipe.html#Configure-the-analysis">Configure the analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_pipe.html#Run-the-analysis">Run the analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_pipe.html#Check-out-the-results">Check out the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_pipe.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/spectrum_analysis.html">Spectral analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Configure-logger">Configure logger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Load-Data">Load Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Define-Target-Region">Define Target Region</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Create-exclusion-mask">Create exclusion mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Estimate-background">Estimate background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Source-statistic">Source statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Extract-spectrum">Extract spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Look-at-observations">Look at observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Fit-spectrum">Fit spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Compute-Flux-Points">Compute Flux Points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Stack-observations">Stack observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/cta_simulation.html">CTA simulation tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_simulation.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_simulation.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_simulation.html#PKS-2155-304-selection-from-the-3FHL-Fermi/LAT-catalogue">PKS 2155-304 selection from the 3FHL Fermi/LAT catalogue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_simulation.html#Select-a-model-for-EBL-absorption">Select a model for EBL absorption</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_simulation.html#CTA-instrument-response-functions">CTA instrument response functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_simulation.html#CTA-simulation-of-an-observation">CTA simulation of an observation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_simulation.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cta_simulation.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/spectrum_fitting_with_sherpa.html">Fitting gammapy spectra with sherpa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_fitting_with_sherpa.html#Importing-sherpa-high-level-UI">Importing sherpa high level UI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_fitting_with_sherpa.html#Creating-the-source-model">Creating the source model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_fitting_with_sherpa.html#Perform-the-fit-and-compute-errors">Perform the fit and compute errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_fitting_with_sherpa.html#Plot-the-result">Plot the result</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/spectrum_fitting_with_sherpa.html#Errors-and-confidence-contours">Errors and confidence contours</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/sed_fitting_gammacat_fermi.html">Flux point fitting in Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/sed_fitting_gammacat_fermi.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/sed_fitting_gammacat_fermi.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/sed_fitting_gammacat_fermi.html#Load-spectral-points">Load spectral points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/sed_fitting_gammacat_fermi.html#Fitter-Setup">Fitter Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/sed_fitting_gammacat_fermi.html#Power-Law-Fit">Power Law Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/sed_fitting_gammacat_fermi.html#Exponential-Cut-Off-Powerlaw-Fit">Exponential Cut-Off Powerlaw Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/sed_fitting_gammacat_fermi.html#Log-Parabola-Fit">Log-Parabola Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/sed_fitting_gammacat_fermi.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/sed_fitting_gammacat_fermi.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/light_curve.html">Example of light curve</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/light_curve.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/light_curve.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/light_curve.html#Extract-spectral-data">Extract spectral data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/light_curve.html#Light-curve-estimation">Light curve estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/light_curve.html#Results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/light_curve.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/data_fermi_lat.html">Fermi-LAT data with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/data_fermi_lat.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/data_fermi_lat.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/data_fermi_lat.html#FermiLATDataset-class">FermiLATDataset class</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/data_fermi_lat.html#Events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/data_fermi_lat.html#PSF">PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/data_fermi_lat.html#Exposure">Exposure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/data_fermi_lat.html#Galactic-diffuse-background">Galactic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/data_fermi_lat.html#Isotropic-diffuse-background">Isotropic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/data_fermi_lat.html#Estimating-basic-input-sky-images-for-high-level-analyses">Estimating basic input sky images for high level analyses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/data_fermi_lat.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/data_fermi_lat.html#What-next?">What next?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#extra-topics">Extra topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/hgps.html">HGPS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/hgps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/hgps.html#Notebook-Overview">Notebook Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/hgps.html#Packages">Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/hgps.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/hgps.html#Download-Data">Download Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/hgps.html#Catalog-with-Astropy">Catalog with Astropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/hgps.html#Maps-with-Astropy">Maps with Astropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/hgps.html#Catalog-with-Gammapy">Catalog with Gammapy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/hgps.html#Maps-with-Gammapy">Maps with Gammapy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/hgps.html#Conclusions">Conclusions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/hgps.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/source_population_model.html">Astrophysical source population modeling with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/source_population_model.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/source_population_model.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/source_population_model.html#Simulate-positions">Simulate positions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/source_population_model.html#Simulate-luminosities">Simulate luminosities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/source_population_model.html#Compute-observable-parameters">Compute observable parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/source_population_model.html#Check-output">Check output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/source_population_model.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/source_population_model.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/background_model.html">Template background model production with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/background_model.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/background_model.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/background_model.html#Compute-background-model">Compute background model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/background_model.html#Inspect-the-background-model">Inspect the background model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/background_model.html#Make-new-index-table">Make new index table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/background_model.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/background_model.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/cwt.html">CWT Algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cwt.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cwt.html#CWT-Algorithm.-PlayGround">CWT Algorithm. PlayGround</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/cwt.html#Results-of-analysis">Results of analysis</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../astro/index.html">Sources / population models (<code class="docutils literal notranslate"><span class="pre">astro</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#sub-packages">Sub-packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../astro/source/index.html">Astrophysical source models (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#using-gammapy-astro-source">Using <code class="docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../astro/population/index.html">Astrophysical source population models (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.population</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">Background estimation (<code class="docutils literal notranslate"><span class="pre">background</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/index.html#using-gammapy-background">Using <code class="docutils literal notranslate"><span class="pre">gammapy.background</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../background/energy_offset_array.html">EnergyOffset Array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../background/reflected.html">Reflected regions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/index.html#module-gammapy.background">gammapy.background Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../background/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../background/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../catalog/index.html">Source catalogs (<code class="docutils literal notranslate"><span class="pre">catalog</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#available-catalogs">Available catalogs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#how-it-works">How it works</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#using-gammapy-catalog">Using <code class="docutils literal notranslate"><span class="pre">gammapy.catalog</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/gammacat.html">gamma-cat</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../catalog/gammacat.html#catalog">Catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/gammacat.html#data-collection">Data collection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#module-gammapy.catalog">gammapy.catalog Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cube/index.html">3D cube analysis (<code class="docutils literal notranslate"><span class="pre">cube</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#using-gammapy-cube">Using <code class="docutils literal notranslate"><span class="pre">gammapy.cube</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cube/index.html#module-gammapy.cube">gammapy.cube Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">Data / observation handling (<code class="docutils literal notranslate"><span class="pre">data</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#using-gammapy-data">Using <code class="docutils literal notranslate"><span class="pre">gammapy.data</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/dm.html">Data Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/dm.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dm.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dm.html#data-formats">Data formats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../data/obs_group.html">Observation grouping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/obs_group.html#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#module-gammapy.data">gammapy.data Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../datasets/index.html">Dataset access (<code class="docutils literal notranslate"><span class="pre">datasets</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#gammapy-extra">gammapy-extra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#gamma-cat">Gamma-cat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#using-gammapy-datasets">Using <code class="docutils literal notranslate"><span class="pre">gammapy.datasets</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../datasets/make_datasets.html">Simulate event lists</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../datasets/make_datasets.html#using-ctobssim">Using ctobssim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../datasets/make_datasets.html#using-gammapy">Using Gammapy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../datasets/index.html#module-gammapy.datasets">gammapy.datasets Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../datasets/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../datasets/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../datasets/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../detect/index.html">Source detection tools (<code class="docutils literal notranslate"><span class="pre">detect</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#computation-of-ts-images">Computation of TS images</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../detect/index.html#command-line-tool">Command line tool</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#computation-of-li-ma-significance-images">Computation of Li &amp; Ma significance images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#iterative-source-detection">Iterative source detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../detect/index.html#module-gammapy.detect">gammapy.detect Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../detect/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../detect/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../image/index.html">2D image analysis (<code class="docutils literal notranslate"><span class="pre">image</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#using-gammapy-image">Using <code class="docutils literal notranslate"><span class="pre">gammapy.image</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../image/sky_image.html">Sky image</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/sky_image.html#introduction-and-concept">Introduction and Concept</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/sky_image.html#getting-started">Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/sky_image.html#cutout-and-paste">Cutout and paste</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/plotting.html">Image plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/plotting.html#colormaps">Colormaps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/plotting.html#multi-panel-galactic-plane-survey-image-plots">Multi-panel Galactic plane survey image plots</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/models.html">Morphology models (<code class="docutils literal notranslate"><span class="pre">gammapy.image.models</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#reference-api">Reference/API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../image/index.html#module-gammapy.image">gammapy.image Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/index.html#module-gammapy.image.models">gammapy.image.models Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../irf/index.html">Instrument response functions (<code class="docutils literal notranslate"><span class="pre">irf</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#using-gammapy-irf">Using <code class="docutils literal notranslate"><span class="pre">gammapy.irf</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../irf/theory.html">IRF Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/aeff.html">Effective area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/edisp.html">Energy dispersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/psf.html">Point spread function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../irf/psf.html#table-psf">Table PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../irf/psf.html#king-psf">King PSF</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../irf/index.html#module-gammapy.irf">gammapy.irf Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../irf/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../irf/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum/index.html">1D spectrum analysis (<code class="docutils literal notranslate"><span class="pre">spectrum</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#using-gammapy-spectrum">Using <code class="docutils literal notranslate"><span class="pre">gammapy.spectrum</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/fitting.html">Spectral Fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/fitting.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/fitting.html#interactive-sherpa-fit">Interactive Sherpa Fit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/energy_group.html">Spectrum energy grouping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/energy_group.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/energy_group.html#other-packages">Other packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/energy_group.html#gammapy-design">Gammapy Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/energy_group.html#gammapy-examples">Gammapy Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/energy_group.html#gammapy-implementation">Gammapy implementation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/index.html#module-gammapy.spectrum">gammapy.spectrum Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/index.html#module-gammapy.spectrum.models">gammapy.spectrum.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#id4">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stats/index.html">Statistics tools (<code class="docutils literal notranslate"><span class="pre">stats</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#li-ma-significance">Li &amp; Ma Significance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#confidence-intervals">Confidence Intervals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#using-gammapy-stats">Using <code class="docutils literal notranslate"><span class="pre">gammapy.stats</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/feldman_cousins.html">Feldman and Cousins Confidence Intervals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#acceptance-interval-fixing">Acceptance Interval Fixing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#sensitivity">Sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#general-case">General Case</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#verification">Verification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stats/fit_statistics.html">Fit statistics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#gaussian-data">Gaussian data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#poisson-data">Poisson data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#poisson-data-with-background-measurement">Poisson data with background measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#further-references">Further references</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#module-gammapy.stats">gammapy.stats Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../time/index.html">Time analysis (<code class="docutils literal notranslate"><span class="pre">time</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#lightcurve">Lightcurve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#variability-test">Variability test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#other-codes">Other codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#content">Content</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/period.html">Period detection and plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#module-gammapy.time">gammapy.time Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#module-gammapy.time.models">gammapy.time.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">Utility functions / classes (<code class="docutils literal notranslate"><span class="pre">utils</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#time-handling-in-gammapy">Time handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#time-format-and-scale">Time format and scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#mission-elapsed-times-met">Mission elapsed times (MET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#time-differences">Time differences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#energy-handling-in-gammapy">Energy handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#energy">Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#energybounds">EnergyBounds</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.energy">gammapy.utils.energy Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.units">gammapy.utils.units Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.coordinates">gammapy.utils.coordinates Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id3">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#variables">Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.table">gammapy.utils.table Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id4">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.fits">gammapy.utils.fits Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#gammapy-fits-utilities">Gammapy FITS utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id5">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id6">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.random">gammapy.utils.random Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id7">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.distributions">gammapy.utils.distributions Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id8">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id9">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.scripts">gammapy.utils.scripts Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id10">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id11">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.testing">gammapy.utils.testing Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id12">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.wcs">gammapy.utils.wcs Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id13">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.nddata">gammapy.utils.nddata Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id14">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id15">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.time">gammapy.utils.time Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id16">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.modeling">gammapy.utils.modeling Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id17">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.fitting">gammapy.utils.fitting Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id18">Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../maps/index.html">Structures for images / cubes (<code class="docutils literal notranslate"><span class="pre">maps</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#constructing-with-factory-methods">Constructing with Factory Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#accessor-methods">Accessor Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#interface-with-mapcoord-and-skycoord">Interface with <code class="docutils literal notranslate"><span class="pre">MapCoord</span></code> and <code class="docutils literal notranslate"><span class="pre">SkyCoord</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#mapcoord">MapCoord</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#interpolation">Interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#projection">Projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#slicing-methods">Slicing Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#iterating-on-a-map">Iterating on a Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#fits-i-o">FITS I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#visualization">Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#creating-a-counts-cube-from-an-ft1-file">Creating a Counts Cube from an FT1 File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#generating-a-cutout-of-a-model-cube">Generating a Cutout of a Model Cube</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#using-gammapy-maps">Using <code class="docutils literal notranslate"><span class="pre">gammapy.maps</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/hpxmap.html">HEALPix-based Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../maps/hpxmap.html#healpix-geometry">HEALPix Geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maps/hpxmap.html#sparse-maps">Sparse Maps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../maps/wcsmap.html">WCS-based Maps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#module-gammapy.maps">gammapy.maps Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../maps/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maps/index.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Command line tools (<code class="docutils literal notranslate"><span class="pre">scripts</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#execute">Execute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#command-not-found">Command not found</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#reference">Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#gammapy">gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-check">check</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-image">image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-info">info</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#implementation">Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#limitations">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#plan">Plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#write-your-own-cli">Write your own CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#module-gammapy.scripts">gammapy.scripts Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#contact-points">Contact points</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#pages">Pages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="intro.html">How to contribute to Gammapy?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#what-is-this">What is this?</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#get-in-touch-early">Get in touch early</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#make-small-pull-requests">Make small pull requests</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#get-set-up">Get set up</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#make-a-working-example">Make a working example</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#integrate-the-code-in-gammapy">Integrate the code in Gammapy</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#make-a-pull-request">Make a pull request</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#code-review">Code review</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#close-the-loop">Close the loop</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="setup.html">Gammapy project setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="setup.html#gammapy-repository">gammapy repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="setup.html#gammapy-extra-repository">gammapy-extra repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="setup.html#other-repositories">Other repositories</a></li>
<li class="toctree-l4"><a class="reference internal" href="setup.html#gammapy-webpages">Gammapy webpages</a></li>
<li class="toctree-l4"><a class="reference internal" href="setup.html#continuous-integration">Continuous integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="setup.html#code-quality">Code quality</a></li>
<li class="toctree-l4"><a class="reference internal" href="setup.html#releases">Releases</a></li>
<li class="toctree-l4"><a class="reference internal" href="setup.html#data-formats">Data formats</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Developer HOWTO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#how-to-clean-up-old-files">How to clean up old files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#where-should-i-import-from">Where should I import from?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#functions-returning-several-values">Functions returning several values</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-2-and-3-support">Python 2 and 3 support</a></li>
<li class="toctree-l4"><a class="reference internal" href="#skip-unit-tests-for-some-astropy-versions">Skip unit tests for some Astropy versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fix-non-unix-line-endings">Fix non-Unix line endings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#check-html-links">Check HTML links</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-codes">Other codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-checks-and-conversions-should-i-do-for-inputs">What checks and conversions should I do for inputs?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#float-data-type-32-bit-or-64-bit">Float data type: 32 bit or 64 bit?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clobber-or-overwrite">Clobber or overwrite?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pixel-coordinate-convention">Pixel coordinate convention</a></li>
<li class="toctree-l4"><a class="reference internal" href="#when-to-use-c-or-cython-or-numba-for-speed">When to use C or Cython or Numba for speed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-belongs-in-gammapy-and-what-doesn-t">What belongs in Gammapy and what doesn’t?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#assert-convention">Assert convention</a></li>
<li class="toctree-l4"><a class="reference internal" href="#random-numbers">Random numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#logging">Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="#command-line-tools-using-click">Command line tools using click</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bsd-or-gpl-license">BSD or GPL license?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#changelog">Changelog</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file-and-directory-path-handling">File and directory path handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bundled-gammapy-extern-code">Bundled gammapy.extern code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interpolation-and-extrapolation">Interpolation and extrapolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#locate-origin-of-warnings">Locate origin of warnings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#object-summary-info-string">Object summary info string</a></li>
<li class="toctree-l4"><a class="reference internal" href="#validating-h-e-s-s-fits-exporters">Validating H.E.S.S. FITS exporters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-the-nddataarray">Using the NDDataArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="#write-a-test-for-an-ipython-notebook">Write a test for an IPython notebook</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sphinx-docs-build">Sphinx docs build</a></li>
<li class="toctree-l4"><a class="reference internal" href="#documentation-guidelines">Documentation guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#different-versions-of-notebooks-in-binder">Different versions of notebooks in Binder</a></li>
<li class="toctree-l4"><a class="reference internal" href="#link-to-a-notebook-in-gammapy-extra-from-the-docs">Link to a notebook in gammapy-extra from the docs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#include-images-from-gammapy-extra-into-the-docs">Include images from gammapy-extra into the docs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="release.html">How to make a Gammapy release</a><ul>
<li class="toctree-l4"><a class="reference internal" href="release.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="release.html#pre-release">Pre release</a></li>
<li class="toctree-l4"><a class="reference internal" href="release.html#make-release">Make release</a></li>
<li class="toctree-l4"><a class="reference internal" href="release.html#post-release">Post release</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pigs/index.html">PIGs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pigs/pig-001.html">PIG 1 - PIG purpose and guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dataformats.html">Data Formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dataformats.html#overview">Overview</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../references.html#publications">Publications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#glossary">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#other-gamma-ray-packages">Other gamma-ray packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#other-useful-packages">Other useful packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#unreleased">0.8 (unreleased)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#pull-requests">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p7-release">0.7 (2018-02-28)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id3">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id4">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-28-2017">0.6 (April 28, 2017)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id5">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id6">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#november-22-2016">0.5 (November 22, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id7">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id8">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-20-2016">0.4 (April 20, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id9">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id10">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#august-13-2015">0.3 (August 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id11">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id12">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-13-2015">0.2 (April 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id13">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id14">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#august-25-2014">0.1 (August 25, 2014)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id15">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id16">Pull requests</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gammapy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Developer documentation</a> &raquo;</li>
        
      <li>Developer HOWTO</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/development/howto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="developer-howto">
<span id="dev-howto"></span><h1>Developer HOWTO<a class="headerlink" href="#developer-howto" title="Permalink to this headline">¶</a></h1>
<p>This page is a collection of notes for Gammapy contributors and maintainers,
in the form of short “How to” or “Q &amp; A” entries.</p>
<div class="section" id="how-to-clean-up-old-files">
<span id="make-clean"></span><h2>How to clean up old files<a class="headerlink" href="#how-to-clean-up-old-files" title="Permalink to this headline">¶</a></h2>
<p>TODO: Gammapy now has a Makefile … this section should be expanded to a page about setup.py and make.</p>
<p>Many projects have a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> to build and install the software and do all kinds of other tasks.
In Astropy and Gammapy and most Python projects, there is no <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>, but the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file
and you’re supposed to type <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">&lt;cmd&gt;</span></code> and use <code class="docutils literal notranslate"><span class="pre">--help</span></code> and <code class="docutils literal notranslate"><span class="pre">--help-commands</span></code> to
see all the available commands and options.</p>
<p>There’s one common task, cleaning up old generated files, that’s not done via <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>.
The equivalent of <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clean</span></code> is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ rm -r build docs/_build docs/api htmlcov docs/notebooks docs/_static/notebooks
</pre></div>
</div>
<p>These folders only contain generated files and are always safe to delete!
Most of the time you don’t have to delete them, but if you e.g. remove or rename files or functions / classes,
then you should, because otherwise the old files will still be around and you might get confusing results,
such as Sphinx warnings or import errors or code that works locally because it uses old things, but fails
on travis-ci or for other developers.</p>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">build</span></code> folder is where <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">build</span></code> or <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></code> generate files.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">docs/api</span></code> folder is where <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">build_docs</span></code> generates [RST] files from the docstrings
(temporary files part of the HTML documentation generation).</li>
<li>The  <code class="docutils literal notranslate"><span class="pre">docs/_build</span></code> folder is where <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">build_docs</span></code> generates the HTML and other Sphinx
documentation output files.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">htmlcov</span></code> folder is where <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">test</span> <span class="pre">--coverage</span></code> generates the HTML coverage report.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">docs/notebooks</span></code> folder is where the source Jupyter notebooks are placed before conversion into Sphinx formatted HTML documents.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">docs/_static/notebooks</span></code> folder is where raw .ipynb files and .py scripts versions of Jupyter notebooks are placed so they may be downloaded from links in the documentation.</li>
</ul>
<p>If you use <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">build_ext</span> <span class="pre">--inplace</span></code>, then files are generated in the <code class="docutils literal notranslate"><span class="pre">gammapy</span></code> source folder.
Usually that’s not a problem, but if you want to clean up those generated files, you can use
<a class="reference external" href="http://git-scm.com/docs/git-clean">git clean</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git status
<span class="c1"># The following command will remove all untracked files!</span>
<span class="c1"># If you have written code that is not committed yet in a new file it will be gone!</span>
<span class="c1"># So use with caution!</span>
$ git clean -fdx
</pre></div>
</div>
<p>At least for now we prefer not to add a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> to Gammapy, because that splits the developers into
those that use <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> and those that use <code class="docutils literal notranslate"><span class="pre">make</span></code>, which can grow into an overall <strong>more</strong> complicated
system where some things are possible only with <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> and others only with <code class="docutils literal notranslate"><span class="pre">make</span></code>.</p>
</div>
<div class="section" id="where-should-i-import-from">
<span id="dev-import"></span><h2>Where should I import from?<a class="headerlink" href="#where-should-i-import-from" title="Permalink to this headline">¶</a></h2>
<p>You should import from the “end-user namespaces”, not the “implementation module”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.data</span> <span class="kn">import</span> <span class="n">EventList</span>  <span class="c1"># good</span>
<span class="kn">from</span> <span class="nn">gammapy.data.event_list</span> <span class="kn">import</span> <span class="n">EventList</span> <span class="c1"># bad</span>

<span class="kn">from</span> <span class="nn">gammapy.stats</span> <span class="kn">import</span> <span class="n">cash</span>  <span class="c1"># good</span>
<span class="kn">from</span> <span class="nn">gammapy.stats.fit_statistics</span> <span class="kn">import</span> <span class="n">cash</span>  <span class="c1"># bad</span>
</pre></div>
</div>
<p>The end-user namespace is the location that is shown in the API docs, i.e. you can
use the Sphinx full-text search to quickly find it.</p>
<p>To make code maintenance easier, the implementation of the functions and classes is
spread across multiple modules (<code class="docutils literal notranslate"><span class="pre">.py</span></code> files), but the user shouldn’t care about their
names, that would be too much to remember.</p>
<p>The only reason to import from a module directly is if you need to access a private
function, class or variable (something that is not listed in <code class="docutils literal notranslate"><span class="pre">__all__</span></code> and thus not
imported into the end-user namespace.</p>
<p>Note that this means that in the definition of an “end-user namespace”, e.g. in the
<code class="docutils literal notranslate"><span class="pre">gammapy/data/__init__.py</span></code> file, the imports have to be sorted in a way such that
modules in <code class="docutils literal notranslate"><span class="pre">gammapy/data</span></code> are loaded when imported from other modules in that sub-package.</p>
</div>
<div class="section" id="functions-returning-several-values">
<span id="dev-result-object"></span><h2>Functions returning several values<a class="headerlink" href="#functions-returning-several-values" title="Permalink to this headline">¶</a></h2>
<p>Functions that return more than a single value shouldn’t return a list
or dictionary of values but rather a Python Bunch result object. A Bunch
is similar to a dict, except that it allows attribute access to the result
values. The approach is the same as e.g. the use of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.OptimizeResult.html#scipy.optimize.OptimizeResult" title="(in SciPy v1.1.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizeResult</span></code></a>.
An example of how Bunches are used in gammapy is given by the <a class="reference internal" href="../api/gammapy.image.SkyImageList.html#gammapy.image.SkyImageList" title="gammapy.image.SkyImageList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyImageList</span></code></a>
class.</p>
</div>
<div class="section" id="python-2-and-3-support">
<span id="dev-python2and3"></span><h2>Python 2 and 3 support<a class="headerlink" href="#python-2-and-3-support" title="Permalink to this headline">¶</a></h2>
<p>We support Python 2.7 and 3.4 or later using a single code base.
This is the strategy adopted by most scientific Python projects and a good starting point to learn about it is
<a class="reference external" href="http://python3porting.com/noconv.html">here</a> and
<a class="reference external" href="http://docs.astropy.org/en/latest/development/codeguide.html#writing-portable-code-for-python-2-and-3">here</a>.</p>
<p>For developers, it would have been nice to only support Python 3 in Gammapy.
But the CIAO and Fermi Science tools software are distributed with Python 2.7
and probably never will be updated to Python 3.
Plus many potential users will likely keep running on Python 2.7 for many years
(see e.g. <a class="reference external" href="http://ipython.org/usersurvey2013.html#python-versions">this survey</a>).</p>
<p>The decision to drop Python 2.6 and 3.2 support was made in August 2014 just before the Gammapy 0.1 release,
based on a few scientific Python user surveys on the web that show that only a small minority are still
using such an old version, so that it’s not worth the developer and maintainer effort to test
these old versions and to find workarounds for their missing features or bugs.</p>
<p>Python 3.3 support was dropped in August 2015 because conda packages for some of the affiliated packages
weren’t available for testing on travis-ci.</p>
</div>
<div class="section" id="skip-unit-tests-for-some-astropy-versions">
<span id="dev-skip-tests"></span><h2>Skip unit tests for some Astropy versions<a class="headerlink" href="#skip-unit-tests-for-some-astropy-versions" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">astropy</span>
<span class="kn">import</span> <span class="nn">pytest</span>

<span class="n">ASTROPY_VERSION</span> <span class="o">=</span> <span class="p">(</span><span class="n">astropy</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">major</span><span class="p">,</span> <span class="n">astropy</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">minor</span><span class="p">)</span>
<span class="nd">@pytest.mark.xfail</span><span class="p">(</span><span class="n">ASTROPY_VERSION</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Astropy API change&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_something</span><span class="p">():</span>
   <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="fix-non-unix-line-endings">
<h2>Fix non-Unix line endings<a class="headerlink" href="#fix-non-unix-line-endings" title="Permalink to this headline">¶</a></h2>
<p>In the past we had non-Unix (i.e. Mac or Windows) line endings in some files.
This can be painful, e.g. git diff and autopep8 behave strangely.
Here’s to commands to check for and fix this (see <a class="reference external" href="http://stackoverflow.com/a/22521008/498873">here</a>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clean -fdx
$ find . -type f -print0 <span class="p">|</span> xargs -0 -n <span class="m">1</span> -P <span class="m">4</span> dos2unix -c mac
$ find . -type f -print0 <span class="p">|</span> xargs -0 -n <span class="m">1</span> -P <span class="m">4</span> dos2unix -c ascii
$ git status
$ <span class="nb">cd</span> astropy_helpers <span class="o">&amp;&amp;</span> git checkout -- . <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ..
</pre></div>
</div>
</div>
<div class="section" id="check-html-links">
<span id="dev-check-html-links"></span><h2>Check HTML links<a class="headerlink" href="#check-html-links" title="Permalink to this headline">¶</a></h2>
<p>To check for broken external links from the Sphinx documentation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python setup.py install
$ <span class="nb">cd</span> docs<span class="p">;</span> make linkcheck
</pre></div>
</div>
</div>
<div class="section" id="other-codes">
<h2>Other codes<a class="headerlink" href="#other-codes" title="Permalink to this headline">¶</a></h2>
<p>These projects are on Github, which is great because
it has full-text search and git history view:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/gammapy/gammapy">https://github.com/gammapy/gammapy</a></li>
<li><a class="reference external" href="https://github.com/gammapy/gammapy-extra">https://github.com/gammapy/gammapy-extra</a></li>
<li><a class="reference external" href="https://github.com/astropy/astropy">https://github.com/astropy/astropy</a></li>
<li><a class="reference external" href="https://github.com/astropy/photutils">https://github.com/astropy/photutils</a></li>
<li><a class="reference external" href="https://github.com/gammalib/gammalib">https://github.com/gammalib/gammalib</a></li>
<li><a class="reference external" href="https://github.com/ctools/ctools">https://github.com/ctools/ctools</a></li>
<li><a class="reference external" href="https://github.com/sherpa/sherpa">https://github.com/sherpa/sherpa</a></li>
<li><a class="reference external" href="https://github.com/zblz/naima">https://github.com/zblz/naima</a></li>
<li><a class="reference external" href="https://github.com/woodmd/gammatools">https://github.com/woodmd/gammatools</a></li>
<li><a class="reference external" href="https://github.com/fermiPy/fermipy">https://github.com/fermiPy/fermipy</a></li>
<li><a class="reference external" href="https://github.com/kialio/VHEObserverTools">https://github.com/kialio/VHEObserverTools</a></li>
<li><a class="reference external" href="https://github.com/taldcroft/xrayevents">https://github.com/taldcroft/xrayevents</a></li>
</ul>
<p>These are unofficial, unmaintained copies on open codes on Github:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/Xarthisius/yt-drone">https://github.com/Xarthisius/yt-drone</a></li>
<li><a class="reference external" href="https://github.com/cdeil/Fermi-ScienceTools-mirror">https://github.com/cdeil/Fermi-ScienceTools-mirror</a></li>
</ul>
<p>Actually at this point we welcome experimentation, so you can use cool new technologies
to implement some functionality in Gammapy if you like, e.g.</p>
<ul class="simple">
<li><a class="reference external" href="http://numba.pydata.org/">Numba</a></li>
<li><a class="reference external" href="http://bokeh.pydata.org/en/latest/">Bokeh</a></li>
<li><a class="reference external" href="http://blaze.pydata.org/en/latest/">Blaze</a></li>
</ul>
</div>
<div class="section" id="what-checks-and-conversions-should-i-do-for-inputs">
<h2>What checks and conversions should I do for inputs?<a class="headerlink" href="#what-checks-and-conversions-should-i-do-for-inputs" title="Permalink to this headline">¶</a></h2>
<p>In Gammapy we assume that
<a class="reference external" href="https://mail.python.org/pipermail/tutor/2003-October/025932.html">“we’re all consenting adults”</a>,
which means that when you write a function you should write it like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">do_something</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Do something.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : `numpy.ndarray`</span>
<span class="sd">        Data</span>
<span class="sd">    option : {&#39;this&#39;, &#39;that&#39;}</span>
<span class="sd">        Option</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;this&#39;</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;that&#39;</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">data</span> <span class="o">**</span> <span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid option: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">option</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
<ul>
<li><p class="first"><strong>Don’t always add `isinstance` checks for everything</strong> … assume the caller passes valid inputs,
… in the example above this is not needed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Don’t always add `numpy.asanyarray` calls for all array-like inputs</strong> … the caller can do this if
it’s really needed … in the example above document <code class="docutils literal notranslate"><span class="pre">data</span></code> as type <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a>
instead of array-like and don’t put this line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Do always add an `else` clause to your `if`-`elif` clauses</strong> … this is boilerplate code,
but not adding it would mean users get this error if they pass an invalid option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">UnboundLocalError</span><span class="p">:</span> <span class="n">local</span> <span class="n">variable</span> <span class="s1">&#39;out&#39;</span> <span class="n">referenced</span> <span class="n">before</span> <span class="n">assignment</span>
</pre></div>
</div>
</li>
</ul>
<p>Now if you really want, you can add the <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.asanyarray.html#numpy.asanyarray" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.asanyarray</span></code></a> and <a class="reference external" href="https://docs.python.org/3/library/functions.html#isinstance" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isinstance</span></code></a> checks
for functions that end-users might often use for interactive work to provide them with
better exception messages, but doing it everywhere would mean 1000s of lines of boilerplate
code and take the fun out of Python programming.</p>
</div>
<div class="section" id="float-data-type-32-bit-or-64-bit">
<h2>Float data type: 32 bit or 64 bit?<a class="headerlink" href="#float-data-type-32-bit-or-64-bit" title="Permalink to this headline">¶</a></h2>
<p>Most of the time what we want is to use 32 bit to store data on disk and 64 bit to do
computations in memory.</p>
<p>Using 64 bit to store data and results (e.g. large images or cubes) on disk would mean
a factor ~2 increase in file sizes and slower I/O, but I’m not aware of any case
where we need that precision.</p>
<p>On the other hand, doing computations with millions and billions of pixels very frequently
results in inaccurate results … e.g. the likelihood is the sum over per-pixel likelihoods
and using 32-bit will usually result in erratic and hard-to-debug optimizer behaviour
and even if the fit works incorrect results.</p>
<p>Now you shouldn’t put this line at the top of every function … assume the caller
passes 64-bit data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>But you should add explicit type conversions to 64 bit when reading float data from files
and explicit type conversions to 32 bit before writing to file.</p>
</div>
<div class="section" id="clobber-or-overwrite">
<h2>Clobber or overwrite?<a class="headerlink" href="#clobber-or-overwrite" title="Permalink to this headline">¶</a></h2>
<p>In Gammapy we use on <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> bool option for <a class="reference internal" href="../scripts/index.html#module-gammapy.scripts" title="gammapy.scripts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.scripts</span></code></a> and functions that
write to files.</p>
<p>Why not use <code class="docutils literal notranslate"><span class="pre">clobber</span></code> instead?
After all the <a class="reference external" href="https://heasarc.gsfc.nasa.gov/ftools/ftools_menu.html">FTOOLS</a> always use <code class="docutils literal notranslate"><span class="pre">clobber</span></code>.</p>
<p>The reason is that <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is clear to everyone, but <code class="docutils literal notranslate"><span class="pre">clobber</span></code> is defined by the dictionary
(e.g. see <a class="reference external" href="http://dictionary.reference.com/browse/clobber">here</a>)
as “to batter severely; strike heavily. to defeat decisively. to denounce or criticize vigorously.”
and isn’t intuitively clear to new users.</p>
<p>Astropy has started the process of changing their APIs to consistently use <code class="docutils literal notranslate"><span class="pre">overwrite</span></code>
and deprecated the use of <code class="docutils literal notranslate"><span class="pre">clobber</span></code>. So we do the same in Gammapy.</p>
</div>
<div class="section" id="pixel-coordinate-convention">
<h2>Pixel coordinate convention<a class="headerlink" href="#pixel-coordinate-convention" title="Permalink to this headline">¶</a></h2>
<p>All code in Gammapy should follow the Astropy pixel coordinate convention that the center of the first pixel
has pixel coordinates <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code> (and not <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code> as shown e.g. in ds9).
It’s currently documented <a class="reference external" href="http://photutils.readthedocs.io/en/latest/photutils/overview.html#coordinate-conventions">here</a>
but I plan to document it in the Astropy docs soon (see <a class="reference external" href="https://github.com/astropy/astropy/issues/2607">issue 2607</a>).</p>
<p>You should use <code class="docutils literal notranslate"><span class="pre">origin=0</span></code> when calling any of the pixel to world or world to pixel coordinate transformations in <a class="reference external" href="http://docs.astropy.org/en/latest/wcs/index.html#module-astropy.wcs" title="(in Astropy v3.1.dev21911)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.wcs</span></code></a>.</p>
</div>
<div class="section" id="when-to-use-c-or-cython-or-numba-for-speed">
<h2>When to use C or Cython or Numba for speed<a class="headerlink" href="#when-to-use-c-or-cython-or-numba-for-speed" title="Permalink to this headline">¶</a></h2>
<p>Most of Gammapy is written using Python and Numpy array expressions calling functions (e.g. from Scipy)
that operate on Numpy arrays.
This is often nice because it means that algorithms can be implemented with few lines of high-level code,</p>
<p>There is a very small fraction of code though (one or a few percent) where this results in code that is
either cumbersome or too slow. E.g. to compute TS or upper limit images, one needs to do a root finding
method with different number of iterations for each pixel … that’s impossible (or at least very
cumbersome / hard to read) to implement with array expressions and Python loops over pixels are slow.</p>
<p>In these cases we encourage the use of <a class="reference external" href="http://cython.org/">Cython</a> or <a class="reference external" href="http://numba.pydata.org/">Numba</a>,
or writing the core code in C and exposing it to Python via Cython.
These are popular and simple ways to get C speed from Python.</p>
<p>To use several CPU cores consider using the Python standard library
<a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html">multiprocessing</a> module.</p>
<p>Note that especially the use of Numba should be considered an experiment.
It is a very nice, but new technology and no-one uses it in production.
Before the Gammapy 1.0 release we will re-evaluate the status of Numba and decide whether it’s
an optional dependency we use for speed, or whether we use the much more established Cython
(Scipy, scikit-image, Astropy, … all use Cython).</p>
<p>At the time of writing (April 2015), the TS map computation code uses Cython and multiprocessing
and Numba is not used yet.</p>
</div>
<div class="section" id="what-belongs-in-gammapy-and-what-doesn-t">
<h2>What belongs in Gammapy and what doesn’t?<a class="headerlink" href="#what-belongs-in-gammapy-and-what-doesn-t" title="Permalink to this headline">¶</a></h2>
<p>The scope of Gammapy is currently not very well defined … if in doubt whether it makes sense to
add something, please ask on the mailing list or via a Github issue.</p>
<p>Roughly the scope is high-level science analysis of gamma-ray data, starting with event lists
after gamma-hadron separation and corresponding IRFs, as well as source and source population modeling.</p>
<p>For lower-level data processing (calibration, event reconstruction, gamma-hadron separation)
there’s <a class="reference external" href="https://github.com/cta-observatory/ctapipe">ctapipe</a>. There’s some functionality (event list processing, PSF or background model building,
sensitivity computations …) that could go in either ctapipe or Gammapy and we’ll have to try
and avoid duplication.</p>
<p>SED modeling code belongs in <a class="reference external" href="https://github.com/zblz/naima">naima</a>.</p>
<p>A lot of code that’s not gamma-ray specific belongs in other packages
(e.g. <a class="reference external" href="http://scipy.org/scipylib/">Scipy</a>, <a class="reference external" href="http://astropy.org">Astropy</a>, other Astropy-affiliated packages, <a class="reference external" href="http://cxc.cfa.harvard.edu/sherpa/">Sherpa</a>).
We currently have quite a bit of code that should be moved “upstream” or already has been,
but the Gammapy code hasn’t been adapted yet.</p>
</div>
<div class="section" id="assert-convention">
<h2>Assert convention<a class="headerlink" href="#assert-convention" title="Permalink to this headline">¶</a></h2>
<p>When performing tests, the preferred numerical assert method is
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.testing.assert_allclose.html#numpy.testing.assert_allclose" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.testing.assert_allclose</span></code></a>. Use</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">assert_allclose</span>
</pre></div>
</div>
<p>at the top of the file and then just use <code class="docutils literal notranslate"><span class="pre">assert_allclose</span></code> for
the tests. This makes the lines shorter, i.e. there is more space
for the arguments.</p>
<p><code class="docutils literal notranslate"><span class="pre">assert_allclose</span></code> covers all use cases for numerical asserts, so
it should be used consistently everywhere instead of using the
dozens of other available asserts from pytest or numpy in various
places.</p>
<p>In case of assertion on arrays of quantity objects, such as
<a class="reference external" href="http://docs.astropy.org/en/latest/api/astropy.units.Quantity.html#astropy.units.Quantity" title="(in Astropy v3.1.dev21911)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quantity</span></code></a> or <a class="reference external" href="http://docs.astropy.org/en/latest/api/astropy.coordinates.Angle.html#astropy.coordinates.Angle" title="(in Astropy v3.1.dev21911)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Angle</span></code></a>, the
following method can be used:
<a class="reference external" href="http://docs.astropy.org/en/latest/api/astropy.tests.helper.assert_quantity_allclose.html#astropy.tests.helper.assert_quantity_allclose" title="(in Astropy v3.1.dev21911)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.tests.helper.assert_quantity_allclose</span></code></a>.
In this case, use</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.tests.helper</span> <span class="kn">import</span> <span class="n">assert_quantity_allclose</span>
</pre></div>
</div>
<p>at the top of the file and then just use <code class="docutils literal notranslate"><span class="pre">assert_quantity_allclose</span></code>
for the tests.</p>
</div>
<div class="section" id="random-numbers">
<span id="dev-random"></span><h2>Random numbers<a class="headerlink" href="#random-numbers" title="Permalink to this headline">¶</a></h2>
<p>All functions that need to call a random number generator should
take a <code class="docutils literal notranslate"><span class="pre">random_state</span></code> input parameter and call the
<a class="reference internal" href="../api/gammapy.utils.random.get_random_state.html#gammapy.utils.random.get_random_state" title="gammapy.utils.random.get_random_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_random_state</span></code></a> utility function like this
(you can copy &amp; paste the three docstring lines and the first code line
to the function you’re writing):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.utils.random</span> <span class="kn">import</span> <span class="n">get_random_state</span>

<span class="k">def</span> <span class="nf">make_random_stuff</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="s1">&#39;random-seed&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;...</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    random_state : {int, &#39;random-seed&#39;, &#39;global-rng&#39;, `~numpy.random.RandomState`}</span>
<span class="sd">        Defines random number generator initialisation.</span>
<span class="sd">        Passed to `~gammapy.utils.random.get_random_state`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">random_state</span> <span class="o">=</span> <span class="n">get_random_state</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>This allows callers flexible control over which random number generator
(i.e. which <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.RandomState.html#numpy.random.RandomState" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.random.RandomState</span></code></a> instance) is used and how it’s initialised.
The default <code class="docutils literal notranslate"><span class="pre">random_state='random-seed'</span></code> means “create a new RNG, seed it in a random way”,
i.e. different random numbers will be generated on every call.</p>
<p>There’s a few ways to get deterministic results from a script that call
functions that generate random numbers.</p>
<p>One option is to create a single <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.RandomState.html#numpy.random.RandomState" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RandomState</span></code></a> object seeded with an integer
and then pass that <code class="docutils literal notranslate"><span class="pre">random_state</span></code> object to every function that generates random numbers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">RandomState</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">stuff1</span> <span class="o">=</span> <span class="n">make_some_random_stuff</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<span class="n">stuff2</span> <span class="o">=</span> <span class="n">make_more_random_stuff</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
</pre></div>
</div>
<p>Another option is to pass an integer seed to every function that generates random numbers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">stuff1</span> <span class="o">=</span> <span class="n">make_some_random_stuff</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
<span class="n">stuff2</span> <span class="o">=</span> <span class="n">make_more_random_stuff</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</pre></div>
</div>
<p>This pattern was inspired by the way
<a class="reference external" href="http://scikit-learn.org/stable/developers/#random-numbers">scikit-learn handles random numbers</a>.
We have changed the <code class="docutils literal notranslate"><span class="pre">None</span></code> option of <code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.utils.check_random_state</span></code> to <code class="docutils literal notranslate"><span class="pre">'global-rng'</span></code>,
because we felt that this meaning for <code class="docutils literal notranslate"><span class="pre">None</span></code> was confusing given that <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.RandomState.html#numpy.random.RandomState" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.random.RandomState</span></code></a>
uses a different meaning (for which we use the option <code class="docutils literal notranslate"><span class="pre">'global-rng'</span></code>).</p>
</div>
<div class="section" id="logging">
<h2>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h2>
<p>Gammapy is a library. This means that it should never contain print statements, because with
print statements the library users have no easy way to configure where the print output goes
(e.g. to <code class="docutils literal notranslate"><span class="pre">stdout</span></code> or <code class="docutils literal notranslate"><span class="pre">stderr</span></code> or a log file) and what the log level (<code class="docutils literal notranslate"><span class="pre">warning</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code>, <code class="docutils literal notranslate"><span class="pre">debug</span></code>)
and format is (e.g. include timestamp and log level?).</p>
<p>So logging is much better than printing. But also logging is only rarely needed.
Many developers use print or log statements to debug some piece of code while they write it.
Once it’s written and works, it’s rare that callers want it to be chatty and log messages all the time.
Print and log statements should mostly be contained in end-user scripts that use Gammapy,
not in Gammapy itself.</p>
<p>That said, there are cases where emitting log messages can be useful.
E.g. a long-running algorithm with many steps can log info or debug statements.
In a function that reads and writes several files it can make sense to include info log messages
for normal operation, and warning or error log messages when something goes wrong.
Also, command line tools that are included in Gammapy <strong>should</strong> contain log messages,
informing the user about what they are doing.</p>
<p>Gammapy uses the Python standard library <a class="reference external" href="https://docs.python.org/3/library/logging.html#module-logging" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">logging</span></code></a> module. This module is extremely flexible,
but also quite complex. But our logging needs are very modest, so it’s actually quite simple …</p>
<div class="section" id="generating-log-messages">
<h3>Generating log messages<a class="headerlink" href="#generating-log-messages" title="Permalink to this headline">¶</a></h3>
<p>To generate log messages from any file in Gammapy, include these two lines at the top:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates a module-level <a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Logger" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">logging.Logger</span></code></a> object called <code class="docutils literal notranslate"><span class="pre">log</span></code>, and you can then create
log messages like this from any function or method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">process_lots_of_data</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Starting processing data ...&#39;</span><span class="p">)</span>

    <span class="c1"># do lots of work</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Writing {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">outfile</span><span class="p">))</span>
</pre></div>
</div>
<p>You should never log messages from the module level (i.e. on import) or configure the log
level or format in Gammapy, that should be left to callers … except from command line tools …</p>
<p>There is also the rare case of functions or classes with the main job to check
and log things. For these you can optionally let the caller pass a logger when
constructing the class to make it easier to configure the logging.
See the <a class="reference internal" href="../api/gammapy.data.EventListDatasetChecker.html#gammapy.data.EventListDatasetChecker" title="gammapy.data.EventListDatasetChecker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EventListDatasetChecker</span></code></a> as an example.</p>
</div>
<div class="section" id="configuring-logging-from-command-line-tools">
<h3>Configuring logging from command line tools<a class="headerlink" href="#configuring-logging-from-command-line-tools" title="Permalink to this headline">¶</a></h3>
<p>Every Gammapy command line tool should have a <code class="docutils literal notranslate"><span class="pre">--loglevel</span></code> option:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--loglevel&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span>
                    <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;warning&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;critical&#39;</span><span class="p">],</span>
                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Set the logging level&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This option is then processed at the end of <code class="docutils literal notranslate"><span class="pre">main</span></code> using this helper function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">set_up_logging_from_args</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<p>This sets up the root logger with the log level and format (the format isn’t configurable
for the command line scripts at the moment).</p>
<p>See <code class="docutils literal notranslate"><span class="pre">gammapy/scripts/find_obs.py</span></code> as an example.</p>
</div>
</div>
<div class="section" id="command-line-tools-using-click">
<h2>Command line tools using click<a class="headerlink" href="#command-line-tools-using-click" title="Permalink to this headline">¶</a></h2>
<p>Command line tools that use the <a class="reference external" href="http://click.pocoo.org/">click</a> module should disable
the unicode literals warnings to clean up the output of the tool:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">click</span>
<span class="n">click</span><span class="o">.</span><span class="n">disable_unicode_literals_warning</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>See <a class="reference external" href="http://click.pocoo.org/5/python3/#unicode-literals">here</a> for further
information.</p>
</div>
<div class="section" id="bsd-or-gpl-license">
<h2>BSD or GPL license?<a class="headerlink" href="#bsd-or-gpl-license" title="Permalink to this headline">¶</a></h2>
<p>Gammapy is BSD licensed (same license as Numpy, Scipy, Matplotlib, scikit-image, Astropy, photutils, yt, …).</p>
<p>We prefer this over the GPL3 or LGPL license because it means that the packages we are most likely to
share code with have the same license, e.g. we can take a function or class and “upstream” it, i.e. contribute
it e.g. to Astropy or Scipy if it’s generally useful.</p>
<p>Some optional dependencies of Gammapy (i.e. other packages like Sherpa or Gammalib or ROOT that we import in some
places) are GPL3 or LGPL licensed.</p>
<p>Now the GPL3 and LGPL license contains clauses that other package that copy or modify it must be released under
the same license.
We take the standpoint that Gammapy is independent from these libraries, because we don’t copy or modify them.
This is a common standpoint, e.g. <code class="docutils literal notranslate"><span class="pre">astropy.wcs</span></code> is BSD licensed, but uses the LGPL-licensed WCSLib.</p>
<p>Note that if you distribute Gammapy together with one of the GPL dependencies,
the whole distribution then falls under the GPL license.</p>
</div>
<div class="section" id="changelog">
<h2>Changelog<a class="headerlink" href="#changelog" title="Permalink to this headline">¶</a></h2>
<p>In Gammapy we keep a <a class="reference internal" href="../changelog.html#changelog"><span class="std std-ref">Changelog</span></a> with a list of pull requests.
We sort by release and within the release by PR number (largest first).</p>
<p>As explained in the <a class="reference external" href="http://docs.astropy.org/en/latest/development/workflow/maintainer_workflow.html#changelog-format" title="(in Astropy v3.1.dev21911)"><span>Updating and Maintaining the Changelog</span></a> section in the Astropy docs,
there are (at least) two approaches for adding to the changelog, each with pros
and cons.</p>
<p>We’ve had some pain due to merge conflicts in the changelog and having to wait
until the contributor rebases (and having to explain git rebase to new contributors).</p>
<p>So our recommendation is that changelog entries are not added in pull requests,
but that the core developer adds a changelog entry after right after having
merged a pull request (you can add <code class="docutils literal notranslate"><span class="pre">[skip</span> <span class="pre">ci]</span></code> on this commit).</p>
</div>
<div class="section" id="file-and-directory-path-handling">
<h2>File and directory path handling<a class="headerlink" href="#file-and-directory-path-handling" title="Permalink to this headline">¶</a></h2>
<p>In Gammapy use <code class="docutils literal notranslate"><span class="pre">Path</span></code> objects to handle file and directory paths.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.extern.pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="nb">dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;folder/subfolder&#39;</span><span class="p">)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="nb">dir</span> <span class="o">/</span> <span class="s1">&#39;filename.fits&#39;</span>
<span class="nb">dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
</pre></div>
</div>
<p>Note how the <code class="docutils literal notranslate"><span class="pre">/</span></code> operator makes it easy to construct paths
(as opposed to repeated calls to the string-handling function <code class="docutils literal notranslate"><span class="pre">os.path.join</span></code>)
and how methods on <code class="docutils literal notranslate"><span class="pre">Path</span></code> objects provide a nicer interface to most
of the functionality from <code class="docutils literal notranslate"><span class="pre">os.path</span></code> (<code class="docutils literal notranslate"><span class="pre">mkdir</span></code> in this example).</p>
<p>One gotcha is that many functions (such as <code class="docutils literal notranslate"><span class="pre">table.write</span></code> in this example)
expect <code class="docutils literal notranslate"><span class="pre">str</span></code> objects and refuse to work with <code class="docutils literal notranslate"><span class="pre">Path</span></code> objects, so you have
to explicitly convert to <code class="docutils literal notranslate"><span class="pre">str(path)</span></code>.</p>
<p>Note that pathlib was added to the Python standard library in 3.4
(see <a class="reference external" href="https://docs.python.org/3/library/pathlib.html">here</a>),
but since we support Python 2.7 and the Python devs keep improving the
version in the standard library (by adding new methods and new options
for existing methods), we decided to bundle the latest version
(from <a class="reference external" href="https://pypi.org/project/pathlib2/">here</a>) in
<code class="docutils literal notranslate"><span class="pre">gammapy/extern/pathlib.py</span></code> and that should always be used.</p>
</div>
<div class="section" id="bundled-gammapy-extern-code">
<h2>Bundled gammapy.extern code<a class="headerlink" href="#bundled-gammapy-extern-code" title="Permalink to this headline">¶</a></h2>
<p>We bundle some code in <code class="docutils literal notranslate"><span class="pre">gammapy.extern</span></code>.
This is external code that we don’t maintain or modify in Gammapy.
We only bundle small pure-Python files (currently all single-file modules) purely for convenience,
because having to explain about these modules as Gammapy dependencies to end-users would be annoying.
And in some cases the file was extracted from some other project, i.e. can’t be installed
separately as a dependency.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">gammapy.extern</span></code> we don’t generate Sphinx API docs.
To see what is there, check out the <code class="docutils literal notranslate"><span class="pre">gammapy/extern</span></code> directory locally or on
<a class="reference external" href="https://github.com/gammapy/gammapy/tree/master/gammapy/extern">Github</a>.
Notes on the bundled files are kept in the docstring of
<a class="reference external" href="https://github.com/gammapy/gammapy/blob/master/gammapy/extern/__init__.py">gammapy/extern/__init__.py</a>.</p>
</div>
<div class="section" id="interpolation-and-extrapolation">
<span id="interpolation-extrapolation"></span><h2>Interpolation and extrapolation<a class="headerlink" href="#interpolation-and-extrapolation" title="Permalink to this headline">¶</a></h2>
<p>In Gammapy, we use interpolation a lot, e.g. to evaluate instrument response functions (IRFs) on
data grids, or to reproject diffuse models on data grids.</p>
<p>Note: For some use cases that require interpolation the
<a class="reference internal" href="../api/gammapy.utils.nddata.NDDataArray.html#gammapy.utils.nddata.NDDataArray" title="gammapy.utils.nddata.NDDataArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NDDataArray</span></code></a> base class might be useful.</p>
<p>The default interpolator we use is <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.RegularGridInterpolator.html#scipy.interpolate.RegularGridInterpolator" title="(in SciPy v1.1.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.interpolate.RegularGridInterpolator</span></code></a> because it’s fast and robust
(more fancy interpolation schemes can lead to unstable response in some cases, so more careful checking
across all of parameter space would be needed).</p>
<p>You should use this pattern to implement a function of method that does interpolation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">do_something</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">interp_kwargs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Do something.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    interp_kwargs : dict or None</span>
<span class="sd">        Interpolation parameter dict passed to `scipy.interpolate.RegularGridInterpolator`.</span>
<span class="sd">        If you pass ``None``, the default ``interp_params=dict(bounds_error=False)`` is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">interp_kwargs</span><span class="p">:</span>
        <span class="n">interp_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">bounds_error</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="n">interpolator</span> <span class="o">=</span> <span class="n">RegularGridInterpolator</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">**</span><span class="n">interp_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Since the other defaults are <code class="docutils literal notranslate"><span class="pre">method='linear'</span></code> and <code class="docutils literal notranslate"><span class="pre">fill_value=nan</span></code>, this implies that linear interpolation
is used and <a class="reference external" href="https://en.wikipedia.org/wiki/NaN">NaN</a> values are returned for points outside of the interpolation domain.
This is a compromise between the alternatives:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">bounds_error=True</span></code> – Very “safe”, refuse to return results for any points if one of the points is outside the valid domain.
Can be annoying for the caller to not get any result.</li>
<li><code class="docutils literal notranslate"><span class="pre">bounds_error=False,</span> <span class="pre">fill_value=nan</span></code> – Medium “safe”. Always return a result, but put NaN values to make it easy
for analysers to spot that there’s an issue in their results (if pixels with NaN are used, that will usually lead
to NaN values in high-level analysis results.</li>
<li><code class="docutils literal notranslate"><span class="pre">bounds_error=False,</span> <span class="pre">fill_value=0</span></code> or <code class="docutils literal notranslate"><span class="pre">bounds_error=False,</span> <span class="pre">fill_value=None</span></code> – Least “safe”.
Extrapolate with zero or edge values (this is what <code class="docutils literal notranslate"><span class="pre">None</span></code> means).
Can be very convenient for the caller, but can also lead to errors where e.g. stacked high-level analysis results
aren’t quite correct because IRFs or background models or … were used outside their valid range.</li>
</ul>
<p>Methods that use interpolation should provide an option to the caller to pass interpolation options on to
<code class="docutils literal notranslate"><span class="pre">RegularGridInterpolator</span></code> in case the default behaviour doesn’t suit the application.</p>
<p>TODO: we have some classes (aeff2d and edisp2d) that pre-compute an interpolator, currently in the constructor.
In those cases the <code class="docutils literal notranslate"><span class="pre">interp_kwargs</span></code> would have to be exposed e.g. also on the <code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code> and other constructors.
Do we want / need that?</p>
</div>
<div class="section" id="locate-origin-of-warnings">
<h2>Locate origin of warnings<a class="headerlink" href="#locate-origin-of-warnings" title="Permalink to this headline">¶</a></h2>
<p>By default, warnings appear on the console, but often it’s not clear where a given warning
originates (e.g. when building the docs or running scripts or tests) or how to fix it.</p>
<p>Sometimes putting this in <code class="docutils literal notranslate"><span class="pre">gammapy/__init__.py</span></code> can help:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Following the advice <a class="reference external" href="http://stackoverflow.com/questions/22373927/get-traceback-of-warnings/22376126#22376126">here</a>,
putting this in <code class="docutils literal notranslate"><span class="pre">docs/conf.py</span></code> can also help sometimes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">warn_with_traceback</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">traceback</span><span class="o">.</span><span class="n">print_stack</span><span class="p">()</span>
    <span class="n">log</span> <span class="o">=</span> <span class="n">file</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s1">&#39;write&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span>
    <span class="n">log</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">warnings</span><span class="o">.</span><span class="n">formatwarning</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">,</span> <span class="n">line</span><span class="p">))</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">showwarning</span> <span class="o">=</span> <span class="n">warn_with_traceback</span>
</pre></div>
</div>
</div>
<div class="section" id="object-summary-info-string">
<h2>Object summary info string<a class="headerlink" href="#object-summary-info-string" title="Permalink to this headline">¶</a></h2>
<p>If you want to add a method to provide some basic information about a class instance,
you should use the Python <code class="docutils literal notranslate"><span class="pre">__str__</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Spam</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ham</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ham</span> <span class="o">=</span> <span class="n">ham</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="s1">&#39;Summary Info about class Spam</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">ss</span> <span class="o">+=</span> <span class="s1">&#39;{:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ham</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ss</span>
</pre></div>
</div>
<p>If you want to add configurable info output, please provide a method <code class="docutils literal notranslate"><span class="pre">summary</span></code>,
like <code class="xref py py-func docutils literal notranslate"><span class="pre">here</span></code>.
In this case the <code class="docutils literal notranslate"><span class="pre">__str__</span></code> method should be a call to <code class="docutils literal notranslate"><span class="pre">summary</span></code> with default
parameters. Do not use an <code class="docutils literal notranslate"><span class="pre">info</span></code> method, since this would lead to conflicts
for some classes in Gammapy (e.g. classes that inherit the <code class="docutils literal notranslate"><span class="pre">info</span></code> method from
<code class="docutils literal notranslate"><span class="pre">astropy.table.Table</span></code>.</p>
</div>
<div class="section" id="validating-h-e-s-s-fits-exporters">
<h2>Validating H.E.S.S. FITS exporters<a class="headerlink" href="#validating-h-e-s-s-fits-exporters" title="Permalink to this headline">¶</a></h2>
<p>The H.E.S.S. experiment has 3 independent analysis chains, which all have exporters to the <a class="reference external" href="http://gamma-astro-data-formats.readthedocs.io/en/latest/index.html#main-page" title="(in Data formats for gamma-ray astronomy v0.1)"><span>Data formats for gamma-ray astronomy</span></a> format.
The Gammapy tests contain a mechanism to track changes in these exporters.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">gammapy-extra</span></code> repository there is a script <code class="docutils literal notranslate"><span class="pre">test_datasets/reference/make_reference_files.py</span></code> that reads
IRF files from different chains and prints the output of the <code class="docutils literal notranslate"><span class="pre">__str__</span></code> method to a file. It also creates a YAML file
holding information about the datastore used for each chain, the observations used, etc.</p>
<p>The test <code class="docutils literal notranslate"><span class="pre">gammapy/irf/tests/test_hess_chains.py</span></code> load exactly the same files as the script and compares the output of the
<code class="docutils literal notranslate"><span class="pre">__str__</span></code> function to the reference files on disk. That way all changes in the exporters or the way the IRF files are read by
Gammapy can be tracked. So, if you made changes to the H.E.S.S. IRF exporters you have to run the <code class="docutils literal notranslate"><span class="pre">make_reference_files.py</span></code> script
again to ensure the passing of all Gammapy tests.</p>
<p>If you want to compare the IRF files between two different datastores (to compare between to chains or fits productions) you have to
manually edit the YAML file written by <code class="docutils literal notranslate"><span class="pre">make_reference_files.py</span></code> and include the info which datastore should be compared to which reference file.</p>
</div>
<div class="section" id="using-the-nddataarray">
<span id="use-nddata"></span><h2>Using the NDDataArray<a class="headerlink" href="#using-the-nddataarray" title="Permalink to this headline">¶</a></h2>
<p>Gammapy has a class for generic n-dimensional data arrays,
<a class="reference internal" href="../api/gammapy.utils.nddata.NDDataArray.html#gammapy.utils.nddata.NDDataArray" title="gammapy.utils.nddata.NDDataArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NDDataArray</span></code></a>. Classes that represent such an array
should use this class. The goal is to reuse code for interpolation
and have an coherent I/O interface, mainly in <a class="reference internal" href="../irf/index.html#module-gammapy.irf" title="gammapy.irf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">irf</span></code></a>.</p>
<p>A usage example can be found in :gp-extra-notebooks:<code class="docutils literal notranslate"><span class="pre">nddata_demo</span></code>.</p>
<p>Also, consult <a class="reference internal" href="#interpolation-extrapolation"><span class="std std-ref">Interpolation and extrapolation</span></a> if you are not sure how to
setup your interpolator.</p>
</div>
<div class="section" id="write-a-test-for-an-ipython-notebook">
<h2>Write a test for an IPython notebook<a class="headerlink" href="#write-a-test-for-an-ipython-notebook" title="Permalink to this headline">¶</a></h2>
<p>There is a script called <code class="docutils literal notranslate"><span class="pre">test_notebooks.py</span></code> in the gammapy main folder. It
exectues all notebooks listed in file <code class="docutils literal notranslate"><span class="pre">notebook.yaml</span></code> in
<code class="docutils literal notranslate"><span class="pre">gammapy-extra/notebooks.yaml</span></code> using
<a class="reference external" href="https://github.com/paulgb/runipy">runipy</a>. So if you edit an existing
notebook or make changes to gammapy that break an existing notebook, you have
to run <code class="docutils literal notranslate"><span class="pre">test_notebooks.py</span></code> until all notebooks run without raising an error.
If you add a new notebook and want it to be under test (which of course is what
you want) you have to add it to <code class="docutils literal notranslate"><span class="pre">gammapy-extra/notebooks/notebooks.yaml</span></code>.
Note that there is also the command <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test-notebooks</span></code> which is used for</p>
<p>continuous integration on travis CI. It is not recommended to use this locally,
since it overwrides your gammapy installation (see issue 727).</p>
</div>
<div class="section" id="sphinx-docs-build">
<h2>Sphinx docs build<a class="headerlink" href="#sphinx-docs-build" title="Permalink to this headline">¶</a></h2>
<p>Generating the HTML docs for Gammapy is straight-forward:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build_docs</span>
<span class="nb">open</span> <span class="n">docs</span><span class="o">/</span><span class="n">_build</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p>Generating the PDF docs is more complex.
This should work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build_docs</span> <span class="o">-</span><span class="n">b</span> <span class="n">latex</span>
<span class="n">cd</span> <span class="n">docs</span><span class="o">/</span><span class="n">_build</span><span class="o">/</span><span class="n">latex</span>
<span class="n">makeindex</span> <span class="o">-</span><span class="n">s</span> <span class="n">python</span><span class="o">.</span><span class="n">ist</span> <span class="n">gammapy</span><span class="o">.</span><span class="n">idx</span>
<span class="n">pdflatex</span> <span class="o">-</span><span class="n">interaction</span><span class="o">=</span><span class="n">nonstopmode</span> <span class="n">gammapy</span><span class="o">.</span><span class="n">tex</span>
<span class="nb">open</span> <span class="n">gammapy</span><span class="o">.</span><span class="n">pdf</span>
</pre></div>
</div>
<p>You need a bunch or LaTeX stuff, specifically <code class="docutils literal notranslate"><span class="pre">texlive-fonts-extra</span></code> is needed.</p>
<p>Jupyter notebooks present in the <code class="docutils literal notranslate"><span class="pre">gammapy-extra</span></code> repository are by default copied
to the <code class="docutils literal notranslate"><span class="pre">docs/notebooks</span></code> and <code class="docutils literal notranslate"><span class="pre">docs/_static/notebooks</span></code> folders during
the process of generating HTML docs. This triggers its conversion to  Sphinx
formatted HTML files and .py scripts. The Sphinx formatted versions of the notebooks provide access to the raw .ipynb Jupyter files and .py script versions stored in <code class="docutils literal notranslate"><span class="pre">docs/_static/notebooks</span></code> folder.</p>
<p>Once the documentation built you can optimize the speed of re-building processes,
for example in case you are modifying or creating new docs and you would like to check
these changes are displayed nicely. For that purpose, if your modified doc file
does not contain links to notebooks, you may set the flag <code class="docutils literal notranslate"><span class="pre">build_notebooks</span></code> to False
in the <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> file, so they are not re-written again by Sphinx.</p>
</div>
<div class="section" id="documentation-guidelines">
<h2>Documentation guidelines<a class="headerlink" href="#documentation-guidelines" title="Permalink to this headline">¶</a></h2>
<p>Like almost all Python projects, the Gammapy documentation is written in a format called
<a class="reference external" href="http://sphinx-doc.org/rest.html">restructured text (RST)</a> and built using <a class="reference external" href="http://sphinx-doc.org/">Sphinx</a>.
We mostly follow the <a class="reference external" href="http://docs.astropy.org/en/latest/development/docguide.html#documentation-guidelines" title="(in Astropy v3.1.dev21911)"><span class="xref std std-ref">Astropy documentation guidelines</span></a>,
which are based on the <a class="reference external" href="https://github.com/numpy/numpy/blob/master/doc/HOWTO_DOCUMENT.rst.txt">Numpy docstring standard</a>,
which is what most scientific Python packages use.</p>
<p>There’s a few details that are not easy to figure out by browsing the Numpy or Astropy
documentation guidelines, or that we actually do differently in Gammapy.
These are listed here so that Gammapy developers have a reference.</p>
<p>Usually the quickest way to figure out how something should be done is to browse the Astropy
or Gammapy code a bit (either locally with your editor or online on Github or via the HTML docs),
or search the Numpy or Astropy documentation guidelines mentioned above.
If that doesn’t quickly turn up something useful, please ask by putting a comment on the issue or
pull request you’re working on on Github, or send an email to the Gammapy mailing list.</p>
<div class="section" id="functions-or-class-methods-that-return-a-single-object">
<h3>Functions or class methods that return a single object<a class="headerlink" href="#functions-or-class-methods-that-return-a-single-object" title="Permalink to this headline">¶</a></h3>
<p>For functions or class methods that return a single object, following the
Numpy docstring standard and adding a <em>Returns</em> section usually means
that you duplicate the one-line description and repeat the function name as
return variable name.
See <a class="reference external" href="http://docs.astropy.org/en/latest/api/astropy.cosmology.LambdaCDM.html#astropy.cosmology.LambdaCDM.w" title="(in Astropy v3.1.dev21911)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.cosmology.LambdaCDM.w</span></code></a> or <a class="reference external" href="http://docs.astropy.org/en/latest/api/astropy.time.Time.html#astropy.time.Time.sidereal_time" title="(in Astropy v3.1.dev21911)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.time.Time.sidereal_time</span></code></a>
as examples in the Astropy codebase. Here’s a simple example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">circle_area</span><span class="p">(</span><span class="n">radius</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Circle area.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    radius : `~astropy.units.Quantity`</span>
<span class="sd">        Circle radius</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    area : `~astropy.units.Quantity`</span>
<span class="sd">        Circle area</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">3.14</span> <span class="o">*</span> <span class="p">(</span><span class="n">radius</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>In these cases, the following shorter format omitting the <em>Returns</em> section is recommended:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">circle_area</span><span class="p">(</span><span class="n">radius</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Circle area (`~astropy.units.Quantity`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    radius : `~astropy.units.Quantity`</span>
<span class="sd">        Circle radius</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">3.14</span> <span class="o">*</span> <span class="p">(</span><span class="n">radius</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Usually the parameter description doesn’t fit on the one line, so it’s
recommended to always keep this in the <em>Parameters</em> section.</p>
<p>This is just a recommendation, e.g. for <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.cube.SkyCube.spectral_index</span></code>
we decided to use this shorter format, but for <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.cube.SkyCube.flux</span></code> we
decided to stick with the more verbose format, because the return type and units
didn’t fit on the first line.</p>
<p>A common case where the short format is appropriate are class properties,
because they always return a single object.
As an example see <a class="reference internal" href="../api/gammapy.data.EventList.html#gammapy.data.EventList.radec" title="gammapy.data.EventList.radec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.data.EventList.radec</span></code></a>, which is reproduced here:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">radec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Event RA / DEC sky coordinates (`~astropy.coordinates.SkyCoord`).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;DEC&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="class-attributes">
<h3>Class attributes<a class="headerlink" href="#class-attributes" title="Permalink to this headline">¶</a></h3>
<p>Class attributes (data members) and properties are currently a bit of a mess,
see <a class="reference internal" href="../api/gammapy.cube.SkyCube.html#gammapy.cube.SkyCube" title="gammapy.cube.SkyCube"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyCube</span></code></a> as an example.
Attributes are listed in an <em>Attributes</em> section because I’ve listed them in a class-level
docstring attributes section as recommended <a class="reference external" href="https://github.com/numpy/numpy/blob/master/doc/HOWTO_DOCUMENT.rst.txt#class-docstring">here</a>.
Properties are listed in separate <em>Attributes summary</em> and <em>Attributes Documentation</em>
sections, which is confusing to users (“what’s the difference between attributes and properties?”).</p>
<p>One solution is to always use properties, but that can get very verbose if we have to write
so many getters and setters. I don’t have a solution for this yet … for now I’ll go read
<a class="reference external" href="https://nbviewer.ipython.org/urls/gist.github.com/ChrisBeaumont/5758381/raw/descriptor_writeup.ipynb">this</a> and meditate.</p>
<p>TODO: make a decision on this and describe the issue / solution here.</p>
</div>
<div class="section" id="constructor-parameters">
<h3>Constructor parameters<a class="headerlink" href="#constructor-parameters" title="Permalink to this headline">¶</a></h3>
<p>TODO: should we put the constructor parameters in the class or <code class="docutils literal notranslate"><span class="pre">__init__</span></code> docstring?</p>
</div>
</div>
<div class="section" id="different-versions-of-notebooks-in-binder">
<h2>Different versions of notebooks in Binder<a class="headerlink" href="#different-versions-of-notebooks-in-binder" title="Permalink to this headline">¶</a></h2>
<p>Jupyter notebooks may be accessed and executed on-line in the
<a class="reference external" href="http://mybinder.org/repo/gammapy/gammapy-extra">Gammapy Binder</a> space. Each <em>fixed-text</em> sphinx
formatted notebook present in the documentation has its own link pointing to its specific space in
Gammapy Binder. Since notebooks are evolving with Gammapy functionalities and documentation, it is
possible to link the different versions of the notebooks stored in GitHub repository <code class="docutils literal notranslate"><span class="pre">gammapy-extra</span></code>
to the same versions built in Gammapy Binder. For this purpose just edit the variable <strong>git_commit</strong>
in <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> file and provide the branch, tag or commit of GitHub repository <code class="docutils literal notranslate"><span class="pre">gammapy-extra</span></code>
that will be used to access the same version of the notebook in Gammapy Binder.</p>
</div>
<div class="section" id="link-to-a-notebook-in-gammapy-extra-from-the-docs">
<h2>Link to a notebook in gammapy-extra from the docs<a class="headerlink" href="#link-to-a-notebook-in-gammapy-extra-from-the-docs" title="Permalink to this headline">¶</a></h2>
<p>Jupyter notebooks stored in <code class="docutils literal notranslate"><span class="pre">gammpy-extra</span></code> are copied to the <code class="docutils literal notranslate"><span class="pre">notebooks</span></code> folder
during the process of Sphinx building documentation. They are converted to HTML files
using <a class="reference external" href="http://nbsphinx.readthedocs.io/">nb_sphinx</a> Sphinx extension that provides
a source parser for .ipynb files. From docstrings and high-level docs in Gammapy you
can link to these <em>fixed-text</em> formatted versions using the <code class="docutils literal notranslate"><span class="pre">gp-extra-notebook</span></code>
Sphinx role providing <strong>only the filename</strong>.</p>
<p>Example: <a class="reference external" href="../notebooks/image_analysis.html">image_analysis.html</a></p>
<p>Sphinx directive to generate that link:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>:gp-extra-notebook:`image_analysis`
</pre></div>
</div>
<p>More info on Sphinx roles is <a class="reference external" href="http://www.sphinx-doc.org/en/stable/markup/inline.html">here</a></p>
<p>Alternatively you can also link to the notebooks providing its filename with .html file extension and the relative path to the <code class="docutils literal notranslate"><span class="pre">notebooks</span></code> folder. This folder is created at the root of the <code class="docutils literal notranslate"><span class="pre">docs</span></code> folder in the process of documentation building.</p>
<p>Example: <a class="reference external" href="../notebooks/first_steps.html">First steps with Gammapy</a></p>
<p>Sphinx directive to generate that link:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`First steps with Gammapy &lt;../notebooks/first_steps.html&gt;`__
</pre></div>
</div>
</div>
<div class="section" id="include-images-from-gammapy-extra-into-the-docs">
<h2>Include images from gammapy-extra into the docs<a class="headerlink" href="#include-images-from-gammapy-extra-into-the-docs" title="Permalink to this headline">¶</a></h2>
<p>Similar to the <code class="docutils literal notranslate"><span class="pre">gp-extra-notebook</span></code> role, Gammapy has a <code class="docutils literal notranslate"><span class="pre">gp-extra-image</span></code> directive.</p>
<p>To include an image from <code class="docutils literal notranslate"><span class="pre">gammapy-extra/figures/</span></code>, use the <code class="docutils literal notranslate"><span class="pre">gp-extra-image</span></code> directive
instead of the usual Sphinx <code class="docutils literal notranslate"><span class="pre">image</span></code> directive like this:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">gp-extra-image</span><span class="p">::</span> detect/fermi_ts_image.png
    <span class="nc">:scale:</span> <span class="nf">100%</span>
</pre></div>
</div>
<p>More info on the image directive is <a class="reference external" href="http://www.sphinx-doc.org/en/stable/rest.html#images">here</a></p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="release.html" class="btn btn-neutral float-right" title="How to make a Gammapy release" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="setup.html" class="btn btn-neutral" title="Gammapy project setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, The Gammapy developers.
      Last updated on 17 May 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.8.dev5910',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>