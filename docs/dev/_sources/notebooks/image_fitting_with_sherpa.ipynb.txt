{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<script type=\"text/javascript\" src=\"../_static/linksdl.js\"></script>\n",
    "<div class='alert alert-info'>\n",
    "**This is a fixed-text formatted version of a Jupyter notebook.**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy/master?urlpath=lab/tree/image_fitting_with_sherpa.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[image_fitting_with_sherpa.ipynb](../_static/notebooks/image_fitting_with_sherpa.ipynb) |\n",
    "[image_fitting_with_sherpa.py](../_static/notebooks/image_fitting_with_sherpa.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Fitting 2D images with Sherpa\n",
    "\n",
    "### Introduction\n",
    "\n",
    "Sherpa is the X-ray satellite Chandra modeling and fitting application. It enables the user to construct complex models from simple definitions and fit those models to data, using a variety of statistics and optimization methods. \n",
    "The issues of constraining the source position and morphology are common in X- and Gamma-ray astronomy. \n",
    "This notebook will show you how to apply Sherpa to CTA data.\n",
    "\n",
    "Here we will set up Sherpa to fit the counts map and loading the ancillary images for subsequent use. A relevant test statistic for data with Poisson fluctuations is the one proposed by Cash (1979). The simplex (or Nelder-Mead) fitting algorithm is a good compromise between efficiency and robustness. The source fit is best performed in pixel coordinates.\n",
    "\n",
    "This tutorial has 2 important parts\n",
    "1. Generating the Maps\n",
    "2. The actual fitting with sherpa.\n",
    "\n",
    "Since sherpa deals only with 2-dim images, the first part of this tutorial shows how to prepare gammapy maps to make classical images."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Necessary imports"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "from astropy.io import fits\n",
    "import astropy.units as u\n",
    "from astropy.wcs import WCS\n",
    "from astropy.coordinates import SkyCoord\n",
    "from gammapy.extern.pathlib import Path\n",
    "from gammapy.data import DataStore\n",
    "from gammapy.irf import EnergyDispersion, make_mean_psf\n",
    "from gammapy.maps import WcsGeom, MapAxis, Map\n",
    "from gammapy.cube import MapMaker, PSFKernel"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Generate the required Maps\n",
    "\n",
    "We first generate the required maps using 3 simulated runs on the Galactic center, exactly as in the [analysis_3d](analysis_3d.ipynb) tutorial.\n",
    "\n",
    "It is always advisable to make the maps on fine energy bins, and then sum them over to get an image."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define which data to use\n",
    "data_store = DataStore.from_dir(\"$GAMMAPY_DATA/cta-1dc/index/gps/\")\n",
    "obs_ids = [110380, 111140, 111159]\n",
    "observations = data_store.get_observations(obs_ids)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "energy_axis = MapAxis.from_edges(\n",
    "    np.logspace(-1, 1.0, 10), unit=\"TeV\", name=\"energy\", interp=\"log\"\n",
    ")\n",
    "geom = WcsGeom.create(\n",
    "    skydir=(0, 0),\n",
    "    binsz=0.02,\n",
    "    width=(10, 8),\n",
    "    coordsys=\"GAL\",\n",
    "    proj=\"CAR\",\n",
    "    axes=[energy_axis],\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 9.8 s, sys: 1.9 s, total: 11.7 s\n",
      "Wall time: 11.7 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "maker = MapMaker(geom, offset_max=4.0 * u.deg)\n",
    "maps = maker.run(observations)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Making a PSF Map\n",
    "\n",
    "Make a PSF map and weigh it with the exposure at the source position to get a 2D PSF "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "# mean PSF\n",
    "src_pos = SkyCoord(0, 0, unit=\"deg\", frame=\"galactic\")\n",
    "table_psf = make_mean_psf(observations, src_pos)\n",
    "\n",
    "# PSF kernel used for the model convolution\n",
    "psf_kernel = PSFKernel.from_table_psf(table_psf, geom, max_radius=\"0.3 deg\")\n",
    "\n",
    "# get the exposure at the source position\n",
    "exposure_at_pos = maps[\"exposure\"].get_by_coord(\n",
    "    {\n",
    "        \"lon\": src_pos.l.value,\n",
    "        \"lat\": src_pos.b.value,\n",
    "        \"energy\": energy_axis.center,\n",
    "    }\n",
    ")\n",
    "\n",
    "# now compute the 2D PSF\n",
    "psf2D = psf_kernel.make_image(exposures=exposure_at_pos)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Make 2D images from 3D ones\n",
    "\n",
    "Since sherpa image fitting works only with 2-dim images,\n",
    "we convert the generated maps to 2D images using `make_images()` and save them as fits files. The exposure is weighed with the spectrum before averaging (assumed to be a power law by default).\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "maps = maker.make_images()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "Path(\"analysis_3d\").mkdir(exist_ok=True)\n",
    "\n",
    "maps[\"counts\"].write(\"analysis_3d/counts_2D.fits\", overwrite=True)\n",
    "maps[\"background\"].write(\"analysis_3d/background_2D.fits\", overwrite=True)\n",
    "maps[\"exposure\"].write(\"analysis_3d/exposure_2D.fits\", overwrite=True)\n",
    "fits.writeto(\"analysis_3d/psf_2D.fits\", psf2D.data, overwrite=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Read the maps and store them in a sherpa model\n",
    "\n",
    "We now have the prepared files which sherpa can read. \n",
    "This part of the notebook shows how to do image analysis using sherpa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "WARNING: imaging routines will not be available, \n",
      "failed to import sherpa.image.ds9_backend due to \n",
      "'RuntimeErr: DS9Win unusable: Could not find ds9 on your PATH'\n",
      "WARNING: failed to import sherpa.astro.xspec; XSPEC models will not be available\n"
     ]
    }
   ],
   "source": [
    "import sherpa.astro.ui as sh\n",
    "\n",
    "sh.set_stat(\"cash\")\n",
    "sh.set_method(\"simplex\")\n",
    "\n",
    "sh.load_image(\"analysis_3d/counts_2D.fits\")\n",
    "sh.set_coord(\"logical\")\n",
    "\n",
    "sh.load_table_model(\"expo\", \"analysis_3d/exposure_2D.fits\")\n",
    "sh.load_table_model(\"bkg\", \"analysis_3d/background_2D.fits\")\n",
    "sh.load_psf(\"psf\", \"analysis_3d/psf_2D.fits\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In principle one might first want to fit the background amplitude. However the background estimation method already yields the correct normalization, so we freeze the background amplitude to unity instead of adjusting it. The (smoothed) residuals from this background model are then computed and shown."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "sh.set_full_model(bkg)\n",
    "bkg.ampl = 1\n",
    "sh.freeze(bkg)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "resid = Map.read(\"analysis_3d/counts_2D.fits\")\n",
    "resid.data = sh.get_data_image().y - sh.get_model_image().y\n",
    "resid_smooth = resid.smooth(width=4)\n",
    "resid_smooth.plot(add_cbar=True);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Find and fit the brightest source\n",
    "We then find the position of the maximum in the (smoothed) residuals map, and fit a (symmetrical) Gaussian source with that initial position:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "yp, xp = np.unravel_index(\n",
    "    np.nanargmax(resid_smooth.data), resid_smooth.data.shape\n",
    ")\n",
    "ampl = resid_smooth.get_by_pix((xp, yp))[0]\n",
    "\n",
    "# creates g0 as a gauss2d instance\n",
    "sh.set_full_model(bkg + psf(sh.gauss2d.g0) * expo)\n",
    "g0.xpos, g0.ypos = xp, yp\n",
    "sh.freeze(g0.xpos, g0.ypos)  # fix the position in the initial fitting step\n",
    "\n",
    "# fix exposure amplitude so that typical exposure is of order unity\n",
    "expo.ampl = 1e-9\n",
    "sh.freeze(expo)\n",
    "sh.thaw(g0.fwhm, g0.ampl)  # in case frozen in a previous iteration\n",
    "\n",
    "g0.fwhm = 10  # give some reasonable initial values\n",
    "g0.ampl = ampl"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'NoneType' object has no attribute 'cdelt'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "\u001b[0;32m<timed eval>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n",
      "\u001b[0;32m<string>\u001b[0m in \u001b[0;36mfit\u001b[0;34m(id, *otherids, **kwargs)\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, id, *otherids, **kwargs)\u001b[0m\n\u001b[1;32m   9449\u001b[0m         \"\"\"\n\u001b[1;32m   9450\u001b[0m         \u001b[0mkwargs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'bkg_only'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 9451\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0motherids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   9452\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   9453\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mfit_bkg\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0motherids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36m_fit\u001b[0;34m(self, id, *otherids, **kwargs)\u001b[0m\n\u001b[1;32m   9546\u001b[0m             \u001b[0mids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_bkg_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   9547\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 9548\u001b[0;31m             \u001b[0mids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   9549\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   9550\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;34m'filter_nan'\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mkwargs\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mkwargs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'filter_nan'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_get_fit\u001b[0;34m(self, id, otherids, estmethod)\u001b[0m\n\u001b[1;32m   7467\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_get_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mestmethod\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7468\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 7469\u001b[0;31m         \u001b[0mfit_to_ids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdatasets\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodels\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_prepare_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   7470\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7471\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_extra_data_and_models\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfit_to_ids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdatasets\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodels\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_prepare_fit\u001b[0;34m(self, id, otherids)\u001b[0m\n\u001b[1;32m   7442\u001b[0m             \u001b[0mmod\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7443\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_models\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_sources\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 7444\u001b[0;31m                 \u001b[0mmod\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   7445\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7446\u001b[0m             \u001b[0;31m# The issue with putting a try/catch here is that if an exception\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_get_model\u001b[0;34m(self, id)\u001b[0m\n\u001b[1;32m   5507\u001b[0m         \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_data\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5508\u001b[0m         \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mis_source\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_model_status\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5509\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_convolution_models\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mis_source\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5510\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5511\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_get_source\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36m_add_convolution_models\u001b[0;34m(self, id, data, model, is_source)\u001b[0m\n\u001b[1;32m   8394\u001b[0m         \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m\\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   8395\u001b[0m             sherpa.ui.utils.Session._add_convolution_models(self, id, data,\n\u001b[0;32m-> 8396\u001b[0;31m                                                             model, is_source)\n\u001b[0m\u001b[1;32m   8397\u001b[0m         \u001b[0mid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fix_id\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   8398\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msherpa\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mastro\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mDataPHA\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mis_source\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_add_convolution_models\u001b[0;34m(self, id, data, model, is_source)\u001b[0m\n\u001b[1;32m   5500\u001b[0m             \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_psf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5501\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5502\u001b[0;31m             \u001b[0;34m[\u001b[0m\u001b[0mpsf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_psf_models\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5503\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5504\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   5500\u001b[0m             \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_psf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5501\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5502\u001b[0;31m             \u001b[0;34m[\u001b[0m\u001b[0mpsf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_psf_models\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5503\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5504\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/instrument.py\u001b[0m in \u001b[0;36mfold\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m   1097\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1098\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1099\u001b[0;31m         \u001b[0m_PSFModel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1100\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1101\u001b[0m         \u001b[0;31m# Set WCS coordinates of kernel data set to match source data set.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/instrument.py\u001b[0m in \u001b[0;36mfold\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m    555\u001b[0m         \u001b[0;31m# FIXME how will we know the native dimensionality of the\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    556\u001b[0m         \u001b[0;31m# raveled model without the values?\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 557\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_check_pixel_size\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    558\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    559\u001b[0m         \u001b[0mkargs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/instrument.py\u001b[0m in \u001b[0;36m_check_pixel_size\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m    718\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mhasattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkernel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"sky\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    719\u001b[0m             \u001b[0;31m# This corresponds to the case when the kernel is actually a psf image, not just a model.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 720\u001b[0;31m             \u001b[0mpsf_pixel_size\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkernel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msky\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcdelt\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    721\u001b[0m             \u001b[0mdata_pixel_size\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msky\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcdelt\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    722\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mAttributeError\u001b[0m: 'NoneType' object has no attribute 'cdelt'"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "sh.fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Fit all parameters of this Gaussian component, fix them and re-compute the residuals map."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'NoneType' object has no attribute 'cdelt'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-13-d0c708c71933>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0msh\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mthaw\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mg0\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mxpos\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mg0\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mypos\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0msh\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0msh\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfreeze\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mg0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m<string>\u001b[0m in \u001b[0;36mfit\u001b[0;34m(id, *otherids, **kwargs)\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, id, *otherids, **kwargs)\u001b[0m\n\u001b[1;32m   9449\u001b[0m         \"\"\"\n\u001b[1;32m   9450\u001b[0m         \u001b[0mkwargs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'bkg_only'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 9451\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0motherids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   9452\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   9453\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mfit_bkg\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0motherids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36m_fit\u001b[0;34m(self, id, *otherids, **kwargs)\u001b[0m\n\u001b[1;32m   9546\u001b[0m             \u001b[0mids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_bkg_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   9547\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 9548\u001b[0;31m             \u001b[0mids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   9549\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   9550\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;34m'filter_nan'\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mkwargs\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mkwargs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'filter_nan'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_get_fit\u001b[0;34m(self, id, otherids, estmethod)\u001b[0m\n\u001b[1;32m   7467\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_get_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mestmethod\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7468\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 7469\u001b[0;31m         \u001b[0mfit_to_ids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdatasets\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodels\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_prepare_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   7470\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7471\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_extra_data_and_models\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfit_to_ids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdatasets\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodels\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_prepare_fit\u001b[0;34m(self, id, otherids)\u001b[0m\n\u001b[1;32m   7442\u001b[0m             \u001b[0mmod\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7443\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_models\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_sources\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 7444\u001b[0;31m                 \u001b[0mmod\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   7445\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7446\u001b[0m             \u001b[0;31m# The issue with putting a try/catch here is that if an exception\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_get_model\u001b[0;34m(self, id)\u001b[0m\n\u001b[1;32m   5507\u001b[0m         \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_data\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5508\u001b[0m         \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mis_source\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_model_status\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5509\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_convolution_models\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mis_source\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5510\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5511\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_get_source\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36m_add_convolution_models\u001b[0;34m(self, id, data, model, is_source)\u001b[0m\n\u001b[1;32m   8394\u001b[0m         \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m\\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   8395\u001b[0m             sherpa.ui.utils.Session._add_convolution_models(self, id, data,\n\u001b[0;32m-> 8396\u001b[0;31m                                                             model, is_source)\n\u001b[0m\u001b[1;32m   8397\u001b[0m         \u001b[0mid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fix_id\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   8398\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msherpa\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mastro\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mDataPHA\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mis_source\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_add_convolution_models\u001b[0;34m(self, id, data, model, is_source)\u001b[0m\n\u001b[1;32m   5500\u001b[0m             \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_psf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5501\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5502\u001b[0;31m             \u001b[0;34m[\u001b[0m\u001b[0mpsf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_psf_models\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5503\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5504\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   5500\u001b[0m             \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_psf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5501\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5502\u001b[0;31m             \u001b[0;34m[\u001b[0m\u001b[0mpsf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_psf_models\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5503\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5504\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/instrument.py\u001b[0m in \u001b[0;36mfold\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m   1097\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1098\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1099\u001b[0;31m         \u001b[0m_PSFModel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1100\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1101\u001b[0m         \u001b[0;31m# Set WCS coordinates of kernel data set to match source data set.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/instrument.py\u001b[0m in \u001b[0;36mfold\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m    555\u001b[0m         \u001b[0;31m# FIXME how will we know the native dimensionality of the\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    556\u001b[0m         \u001b[0;31m# raveled model without the values?\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 557\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_check_pixel_size\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    558\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    559\u001b[0m         \u001b[0mkargs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/instrument.py\u001b[0m in \u001b[0;36m_check_pixel_size\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m    718\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mhasattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkernel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"sky\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    719\u001b[0m             \u001b[0;31m# This corresponds to the case when the kernel is actually a psf image, not just a model.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 720\u001b[0;31m             \u001b[0mpsf_pixel_size\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkernel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msky\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcdelt\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    721\u001b[0m             \u001b[0mdata_pixel_size\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msky\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcdelt\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    722\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mAttributeError\u001b[0m: 'NoneType' object has no attribute 'cdelt'"
     ]
    }
   ],
   "source": [
    "sh.thaw(g0.xpos, g0.ypos)\n",
    "sh.fit()\n",
    "sh.freeze(g0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'NoneType' object has no attribute 'cdelt'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-14-8dacc4a753bc>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mresid\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0msh\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_data_image\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0my\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0msh\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_model_image\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0my\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mresid_smooth\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mresid\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msmooth\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mwidth\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mresid_smooth\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mplot\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m;\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m<string>\u001b[0m in \u001b[0;36mget_model_image\u001b[0;34m(id)\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36mget_model_image\u001b[0;34m(self, id)\u001b[0m\n\u001b[1;32m  14355\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m  14356\u001b[0m         \"\"\"\n\u001b[0;32m> 14357\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_prepare_imageobj\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_modelimage\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m  14358\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_modelimage\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m  14359\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_prepare_imageobj\u001b[0;34m(self, id, imageobj, model)\u001b[0m\n\u001b[1;32m  14264\u001b[0m             \u001b[0mimageobj\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mprepare_image\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_data\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_source\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m  14265\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m> 14266\u001b[0;31m             \u001b[0mimageobj\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mprepare_image\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_data\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m  14267\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mimageobj\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m  14268\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36mget_model\u001b[0;34m(self, id)\u001b[0m\n\u001b[1;32m   5611\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5612\u001b[0m         \"\"\"\n\u001b[0;32m-> 5613\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5614\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5615\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_runparamprompt\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpars\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_get_model\u001b[0;34m(self, id)\u001b[0m\n\u001b[1;32m   5507\u001b[0m         \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_data\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5508\u001b[0m         \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mis_source\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_model_status\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5509\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_convolution_models\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mis_source\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5510\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5511\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_get_source\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36m_add_convolution_models\u001b[0;34m(self, id, data, model, is_source)\u001b[0m\n\u001b[1;32m   8394\u001b[0m         \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m\\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   8395\u001b[0m             sherpa.ui.utils.Session._add_convolution_models(self, id, data,\n\u001b[0;32m-> 8396\u001b[0;31m                                                             model, is_source)\n\u001b[0m\u001b[1;32m   8397\u001b[0m         \u001b[0mid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fix_id\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   8398\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msherpa\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mastro\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mDataPHA\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mis_source\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_add_convolution_models\u001b[0;34m(self, id, data, model, is_source)\u001b[0m\n\u001b[1;32m   5500\u001b[0m             \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_psf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5501\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5502\u001b[0;31m             \u001b[0;34m[\u001b[0m\u001b[0mpsf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_psf_models\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5503\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5504\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   5500\u001b[0m             \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_psf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5501\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5502\u001b[0;31m             \u001b[0;34m[\u001b[0m\u001b[0mpsf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_psf_models\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5503\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5504\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/instrument.py\u001b[0m in \u001b[0;36mfold\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m   1097\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1098\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1099\u001b[0;31m         \u001b[0m_PSFModel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1100\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1101\u001b[0m         \u001b[0;31m# Set WCS coordinates of kernel data set to match source data set.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/instrument.py\u001b[0m in \u001b[0;36mfold\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m    555\u001b[0m         \u001b[0;31m# FIXME how will we know the native dimensionality of the\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    556\u001b[0m         \u001b[0;31m# raveled model without the values?\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 557\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_check_pixel_size\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    558\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    559\u001b[0m         \u001b[0mkargs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/instrument.py\u001b[0m in \u001b[0;36m_check_pixel_size\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m    718\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mhasattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkernel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"sky\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    719\u001b[0m             \u001b[0;31m# This corresponds to the case when the kernel is actually a psf image, not just a model.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 720\u001b[0;31m             \u001b[0mpsf_pixel_size\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkernel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msky\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcdelt\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    721\u001b[0m             \u001b[0mdata_pixel_size\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msky\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcdelt\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    722\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mAttributeError\u001b[0m: 'NoneType' object has no attribute 'cdelt'"
     ]
    }
   ],
   "source": [
    "resid.data = sh.get_data_image().y - sh.get_model_image().y\n",
    "resid_smooth = resid.smooth(width=3)\n",
    "resid_smooth.plot();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Iteratively find and fit additional sources\n",
    "Instantiate additional Gaussian components, and use them to iteratively fit sources, repeating the steps performed above for component g0. (The residuals map is shown after each additional source included in the model.) This takes some time..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "# initialize components with fixed, zero amplitude\n",
    "for i in range(1, 10):\n",
    "    model = sh.create_model_component(\"gauss2d\", \"g\" + str(i))\n",
    "    model.ampl = 0\n",
    "    sh.freeze(model)\n",
    "\n",
    "gs = [g0, g1, g2]\n",
    "sh.set_full_model(bkg + psf(g0 + g1 + g2) * expo)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'NoneType' object has no attribute 'cdelt'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "\u001b[0;32m<timed exec>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n",
      "\u001b[0;32m<string>\u001b[0m in \u001b[0;36mfit\u001b[0;34m(id, *otherids, **kwargs)\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, id, *otherids, **kwargs)\u001b[0m\n\u001b[1;32m   9449\u001b[0m         \"\"\"\n\u001b[1;32m   9450\u001b[0m         \u001b[0mkwargs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'bkg_only'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 9451\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0motherids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   9452\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   9453\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mfit_bkg\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0motherids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36m_fit\u001b[0;34m(self, id, *otherids, **kwargs)\u001b[0m\n\u001b[1;32m   9546\u001b[0m             \u001b[0mids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_bkg_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   9547\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 9548\u001b[0;31m             \u001b[0mids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   9549\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   9550\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;34m'filter_nan'\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mkwargs\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mkwargs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'filter_nan'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_get_fit\u001b[0;34m(self, id, otherids, estmethod)\u001b[0m\n\u001b[1;32m   7467\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_get_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mestmethod\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7468\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 7469\u001b[0;31m         \u001b[0mfit_to_ids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdatasets\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodels\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_prepare_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherids\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   7470\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7471\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_extra_data_and_models\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfit_to_ids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdatasets\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodels\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_prepare_fit\u001b[0;34m(self, id, otherids)\u001b[0m\n\u001b[1;32m   7442\u001b[0m             \u001b[0mmod\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7443\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_models\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_sources\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 7444\u001b[0;31m                 \u001b[0mmod\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   7445\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7446\u001b[0m             \u001b[0;31m# The issue with putting a try/catch here is that if an exception\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_get_model\u001b[0;34m(self, id)\u001b[0m\n\u001b[1;32m   5507\u001b[0m         \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_data\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5508\u001b[0m         \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mis_source\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_model_status\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5509\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_convolution_models\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mis_source\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5510\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5511\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_get_source\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36m_add_convolution_models\u001b[0;34m(self, id, data, model, is_source)\u001b[0m\n\u001b[1;32m   8394\u001b[0m         \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m\\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   8395\u001b[0m             sherpa.ui.utils.Session._add_convolution_models(self, id, data,\n\u001b[0;32m-> 8396\u001b[0;31m                                                             model, is_source)\n\u001b[0m\u001b[1;32m   8397\u001b[0m         \u001b[0mid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fix_id\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   8398\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msherpa\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mastro\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mDataPHA\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mis_source\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_add_convolution_models\u001b[0;34m(self, id, data, model, is_source)\u001b[0m\n\u001b[1;32m   5500\u001b[0m             \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_psf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5501\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5502\u001b[0;31m             \u001b[0;34m[\u001b[0m\u001b[0mpsf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_psf_models\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5503\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5504\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   5500\u001b[0m             \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_psf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5501\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5502\u001b[0;31m             \u001b[0;34m[\u001b[0m\u001b[0mpsf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_psf_models\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5503\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5504\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/instrument.py\u001b[0m in \u001b[0;36mfold\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m   1097\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1098\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1099\u001b[0;31m         \u001b[0m_PSFModel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1100\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1101\u001b[0m         \u001b[0;31m# Set WCS coordinates of kernel data set to match source data set.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/instrument.py\u001b[0m in \u001b[0;36mfold\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m    555\u001b[0m         \u001b[0;31m# FIXME how will we know the native dimensionality of the\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    556\u001b[0m         \u001b[0;31m# raveled model without the values?\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 557\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_check_pixel_size\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    558\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    559\u001b[0m         \u001b[0mkargs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/instrument.py\u001b[0m in \u001b[0;36m_check_pixel_size\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m    718\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mhasattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkernel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"sky\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    719\u001b[0m             \u001b[0;31m# This corresponds to the case when the kernel is actually a psf image, not just a model.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 720\u001b[0;31m             \u001b[0mpsf_pixel_size\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkernel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msky\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcdelt\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    721\u001b[0m             \u001b[0mdata_pixel_size\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msky\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcdelt\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    722\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mAttributeError\u001b[0m: 'NoneType' object has no attribute 'cdelt'"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "for i in range(1, len(gs)):\n",
    "    yp, xp = np.unravel_index(\n",
    "        np.nanargmax(resid_smooth.data), resid_smooth.data.shape\n",
    "    )\n",
    "    ampl = resid_smooth.get_by_pix((xp, yp))[0]\n",
    "    gs[i].xpos, gs[i].ypos = xp, yp\n",
    "    gs[i].fwhm = 10\n",
    "    gs[i].ampl = ampl\n",
    "\n",
    "    sh.thaw(gs[i].fwhm)\n",
    "    sh.thaw(gs[i].ampl)\n",
    "    sh.fit()\n",
    "\n",
    "    sh.thaw(gs[i].xpos)\n",
    "    sh.thaw(gs[i].ypos)\n",
    "    sh.fit()\n",
    "    sh.freeze(gs[i])\n",
    "\n",
    "    resid.data = sh.get_data_image().y - sh.get_model_image().y\n",
    "    resid_smooth = resid.smooth(width=6)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "resid_smooth.plot(add_cbar=True);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Generating output table and Test Statistics estimation\n",
    "When adding a new source, one needs to check the significance of this new source. A frequently used method is the Test Statistics (TS). This is done by comparing the change of statistics when the source is included compared to the null hypothesis (no source ; in practice here we fix the amplitude to zero).\n",
    "\n",
    "$TS = Cstat(source) - Cstat(no source)$\n",
    "\n",
    "The criterion for a significant source detection is typically that it should improve the test statistic by at least 25 or 30. We have added only 3 sources to save time, but you should keep doing this till del(stat) is less than the required number."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'NoneType' object has no attribute 'cdelt'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-18-bdd7ade33e59>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      6\u001b[0m     \u001b[0mampl\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mg\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mampl\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mval\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      7\u001b[0m     \u001b[0mg\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mampl\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 8\u001b[0;31m     \u001b[0mstati\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0msh\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_stat_info\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstatval\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      9\u001b[0m     \u001b[0mg\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mampl\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mampl\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     10\u001b[0m     \u001b[0mstatf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0msh\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_stat_info\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstatval\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m<string>\u001b[0m in \u001b[0;36mget_stat_info\u001b[0;34m()\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36mget_stat_info\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   7614\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7615\u001b[0m         \"\"\"\n\u001b[0;32m-> 7616\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_stat_info\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   7617\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7618\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mget_fit_results\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36m_get_stat_info\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   9560\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_get_stat_info\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   9561\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 9562\u001b[0;31m         \u001b[0mids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdatasets\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodels\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_prepare_fit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   9563\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   9564\u001b[0m         \u001b[0mextra_ids\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_prepare_fit\u001b[0;34m(self, id, otherids)\u001b[0m\n\u001b[1;32m   7442\u001b[0m             \u001b[0mmod\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7443\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_models\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_sources\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 7444\u001b[0;31m                 \u001b[0mmod\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   7445\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7446\u001b[0m             \u001b[0;31m# The issue with putting a try/catch here is that if an exception\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_get_model\u001b[0;34m(self, id)\u001b[0m\n\u001b[1;32m   5507\u001b[0m         \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_data\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5508\u001b[0m         \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mis_source\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_model_status\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5509\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_convolution_models\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mis_source\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5510\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5511\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_get_source\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mid\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/ui/utils.py\u001b[0m in \u001b[0;36m_add_convolution_models\u001b[0;34m(self, id, data, model, is_source)\u001b[0m\n\u001b[1;32m   8394\u001b[0m         \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m\\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   8395\u001b[0m             sherpa.ui.utils.Session._add_convolution_models(self, id, data,\n\u001b[0;32m-> 8396\u001b[0;31m                                                             model, is_source)\n\u001b[0m\u001b[1;32m   8397\u001b[0m         \u001b[0mid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fix_id\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   8398\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msherpa\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mastro\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mDataPHA\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mis_source\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m_add_convolution_models\u001b[0;34m(self, id, data, model, is_source)\u001b[0m\n\u001b[1;32m   5500\u001b[0m             \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_psf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5501\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5502\u001b[0;31m             \u001b[0;34m[\u001b[0m\u001b[0mpsf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_psf_models\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5503\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5504\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/ui/utils.py\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   5500\u001b[0m             \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_add_psf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mid\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5501\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5502\u001b[0;31m             \u001b[0;34m[\u001b[0m\u001b[0mpsf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_psf_models\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mpsf\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5503\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5504\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/astro/instrument.py\u001b[0m in \u001b[0;36mfold\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m   1097\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1098\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1099\u001b[0;31m         \u001b[0m_PSFModel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfold\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1100\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1101\u001b[0m         \u001b[0;31m# Set WCS coordinates of kernel data set to match source data set.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/instrument.py\u001b[0m in \u001b[0;36mfold\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m    555\u001b[0m         \u001b[0;31m# FIXME how will we know the native dimensionality of the\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    556\u001b[0m         \u001b[0;31m# raveled model without the values?\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 557\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_check_pixel_size\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    558\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    559\u001b[0m         \u001b[0mkargs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/sherpa/instrument.py\u001b[0m in \u001b[0;36m_check_pixel_size\u001b[0;34m(self, data)\u001b[0m\n\u001b[1;32m    718\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mhasattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkernel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"sky\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    719\u001b[0m             \u001b[0;31m# This corresponds to the case when the kernel is actually a psf image, not just a model.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 720\u001b[0;31m             \u001b[0mpsf_pixel_size\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkernel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msky\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcdelt\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    721\u001b[0m             \u001b[0mdata_pixel_size\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msky\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcdelt\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    722\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mAttributeError\u001b[0m: 'NoneType' object has no attribute 'cdelt'"
     ]
    }
   ],
   "source": [
    "from astropy.stats import gaussian_fwhm_to_sigma\n",
    "from astropy.table import Table\n",
    "\n",
    "rows = []\n",
    "for g in gs:\n",
    "    ampl = g.ampl.val\n",
    "    g.ampl = 0\n",
    "    stati = sh.get_stat_info()[0].statval\n",
    "    g.ampl = ampl\n",
    "    statf = sh.get_stat_info()[0].statval\n",
    "    delstat = stati - statf\n",
    "\n",
    "    geom = resid.geom\n",
    "    coord = geom.pix_to_coord((g.xpos.val, g.ypos.val))\n",
    "    pix_scale = geom.pixel_scales.mean().deg\n",
    "    sigma = g.fwhm.val * pix_scale * gaussian_fwhm_to_sigma\n",
    "    rows.append(\n",
    "        dict(delstat=delstat, glon=coord[0], glat=coord[1], sigma=sigma)\n",
    "    )\n",
    "\n",
    "table = Table(rows=rows, names=rows[0])\n",
    "for name in table.colnames:\n",
    "    table[name].format = \".5g\"\n",
    "table"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Exercises\n",
    "\n",
    "1. Keep adding sources till there are no more significat ones in the field. How many Gaussians do you need?\n",
    "2. Use other morphologies for the sources (eg: disk, shell) rather than only Gaussian.\n",
    "3. Compare the TS between different models"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### More about sherpa\n",
    "\n",
    "These are good resources to learn more about Sherpa:\n",
    "\n",
    "* https://python4astronomers.github.io/fitting/fitting.html\n",
    "* https://github.com/DougBurke/sherpa-standalone-notebooks\n",
    "\n",
    "You could read over the examples there, and try to apply a similar analysis to this dataset here to practice.\n",
    "\n",
    "If you want a deeper understanding of how Sherpa works, then these proceedings are good introductions:\n",
    "\n",
    "* http://conference.scipy.org/proceedings/scipy2009/paper_8/full_text.pdf\n",
    "* http://conference.scipy.org/proceedings/scipy2011/pdfs/brefsdal.pdf"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.6"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
