{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<script type=\"text/javascript\" src=\"../_static/linksdl.js\"></script>\n",
    "<div class='alert alert-info'>\n",
    "**This is a fixed-text formatted version of a Jupyter notebook.**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy/master?urlpath=lab/tree/spectrum_pipe.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[spectrum_pipe.ipynb](../_static/notebooks/spectrum_pipe.ipynb) |\n",
    "[spectrum_pipe.py](../_static/notebooks/spectrum_pipe.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Spectrum analysis with Gammapy (run pipeline)\n",
    "\n",
    "In this tutorial we will learn how to perform a 1d spectral analysis.\n",
    "\n",
    "We will use a \"pipeline\" or \"workflow\" class to run a standard analysis. If you're interested in implementation detail of the analysis in order to create a custom analysis class, you should read ([spectrum_analysis.ipynb](spectrum_analysis.ipynb)) that executes the analysis using lower-level classes and methods in Gammapy. \n",
    "\n",
    "In this tutorial we will use the folling Gammapy classes:\n",
    "\n",
    "- [gammapy.data.DataStore](..\/api/gammapy.data.DataStore.rst) to load the data to \n",
    "- [gammapy.scripts.SpectrumAnalysisIACT](..\/api/gammapy.scripts.SpectrumAnalysisIACT.rst) to run the analysis\n",
    "\n",
    "We use 4 Crab observations from H.E.S.S. for testing."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setup\n",
    "\n",
    "As usual, we'll start with some setup for the notebook, and import the functionality we need."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "import astropy.units as u\n",
    "from astropy.coordinates import SkyCoord\n",
    "from regions import CircleSkyRegion\n",
    "\n",
    "from gammapy.utils.energy import EnergyBounds\n",
    "from gammapy.data import DataStore\n",
    "from gammapy.scripts import SpectrumAnalysisIACT\n",
    "from gammapy.catalog import SourceCatalogGammaCat\n",
    "from gammapy.maps import Map\n",
    "from gammapy.spectrum.models import LogParabola\n",
    "from gammapy.spectrum import CrabSpectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Select data\n",
    "\n",
    "First, we select and load some H.E.S.S. data (simulated events for now). In real life you would do something fancy here, or just use the list of observations someone send you (and hope they have done something fancy before). We'll just use the standard gammapy 4 crab runs."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[23523 23526 23559 23592]\n"
     ]
    }
   ],
   "source": [
    "data_store = DataStore.from_dir(\"$GAMMAPY_DATA/hess-dl3-dr1/\")\n",
    "mask = data_store.obs_table[\"TARGET_NAME\"] == \"Crab\"\n",
    "obs_ids = data_store.obs_table[\"OBS_ID\"][mask].data\n",
    "observations = data_store.obs_list(obs_ids)\n",
    "print(obs_ids)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Configure the analysis\n",
    "\n",
    "Now we'll define the input for the spectrum analysis. It will be done the python way, i.e. by creating a config dict containing python objects. We plan to add also the convenience to configure the analysis using a plain text config file."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "crab_pos = SkyCoord.from_name(\"crab\")\n",
    "on_region = CircleSkyRegion(crab_pos, 0.15 * u.deg)\n",
    "\n",
    "model = LogParabola(\n",
    "    alpha=2.3,\n",
    "    beta=0.01,\n",
    "    amplitude=1e-11 * u.Unit(\"cm-2 s-1 TeV-1\"),\n",
    "    reference=1 * u.TeV,\n",
    ")\n",
    "\n",
    "flux_point_binning = EnergyBounds.equal_log_spacing(0.7, 30, 5, u.TeV)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "exclusion_mask = Map.create(skydir=crab_pos, width=(10, 10), binsz=0.02)\n",
    "\n",
    "gammacat = SourceCatalogGammaCat()\n",
    "\n",
    "regions = []\n",
    "for source in gammacat:\n",
    "    if not exclusion_mask.geom.contains(source.position):\n",
    "        continue\n",
    "    region = CircleSkyRegion(source.position, 0.15 * u.deg)\n",
    "    regions.append(region)\n",
    "\n",
    "exclusion_mask.data = exclusion_mask.geom.region_mask(regions, inside=False)\n",
    "exclusion_mask.plot();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "config = dict(\n",
    "    outdir=\".\",\n",
    "    background=dict(\n",
    "        on_region=on_region,\n",
    "        exclusion_mask=exclusion_mask,\n",
    "        min_distance=0.1 * u.rad,\n",
    "    ),\n",
    "    extraction=dict(containment_correction=False),\n",
    "    fit=dict(\n",
    "        model=model,\n",
    "        stat=\"wstat\",\n",
    "        forward_folded=True,\n",
    "        fit_range=flux_point_binning[[0, -1]],\n",
    "    ),\n",
    "    fp_binning=flux_point_binning,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Run the analysis\n",
    "\n",
    "TODO: Clean up the log (partly done, get rid of remaining useless warnings)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<hr>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <tr>\n",
       "        <td title=\"Minimum value of function\">FCN = 108.83548502896386</td>\n",
       "        <td title=\"Total number of call to FCN so far\">TOTAL NCALL = 118</td>\n",
       "        <td title=\"Number of call in last migrad\">NCALLS = 118</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td title=\"Estimated distance to minimum\">EDM = 2.6101091011340668e-06</td>\n",
       "        <td title=\"Maximum EDM definition of convergence\">GOAL EDM = 1e-05</td>\n",
       "        <td title=\"Error def. Amount of increase in FCN to be defined as 1 standard deviation\">\n",
       "        UP = 1.0</td>\n",
       "    </tr>\n",
       "</table>\n",
       "<table>\n",
       "    <tr>\n",
       "        <td align=\"center\" title=\"Validity of the migrad call\">Valid</td>\n",
       "        <td align=\"center\" title=\"Validity of parameters\">Valid Param</td>\n",
       "        <td align=\"center\" title=\"Is Covariance matrix accurate?\">Accurate Covar</td>\n",
       "        <td align=\"center\" title=\"Positive definiteness of covariance matrix\">PosDef</td>\n",
       "        <td align=\"center\" title=\"Was covariance matrix made posdef by adding diagonal element\">Made PosDef</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td align=\"center\" style=\"background-color:#92CCA6\">True</td>\n",
       "        <td align=\"center\" style=\"background-color:#92CCA6\">True</td>\n",
       "        <td align=\"center\" style=\"background-color:#92CCA6\">True</td>\n",
       "        <td align=\"center\" style=\"background-color:#92CCA6\">True</td>\n",
       "        <td align=\"center\" style=\"background-color:#92CCA6\">False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td align=\"center\" title=\"Was last hesse call fail?\">Hesse Fail</td>\n",
       "        <td align=\"center\" title=\"Validity of covariance\">HasCov</td>\n",
       "        <td align=\"center\" title=\"Is EDM above goal EDM?\">Above EDM</td>\n",
       "        <td align=\"center\"></td>\n",
       "        <td align=\"center\" title=\"Did last migrad call reach max call limit?\">Reach calllim</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td align=\"center\" style=\"background-color:#92CCA6\">False</td>\n",
       "        <td align=\"center\" style=\"background-color:#92CCA6\">True</td>\n",
       "        <td align=\"center\" style=\"background-color:#92CCA6\">False</td>\n",
       "        <td align=\"center\"></td>\n",
       "        <td align=\"center\" style=\"background-color:#92CCA6\">False</td>\n",
       "    </tr>\n",
       "</table>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <tr>\n",
       "        <td><a href=\"#\" onclick=\"$('#REyJxpsndg').toggle()\">+</a></td>\n",
       "        <td title=\"Variable name\">Name</td>\n",
       "        <td title=\"Value of parameter\">Value</td>\n",
       "        <td title=\"Hesse error\">Hesse Error</td>\n",
       "        <td title=\"Minos lower error\">Minos Error-</td>\n",
       "        <td title=\"Minos upper error\">Minos Error+</td>\n",
       "        <td title=\"Lower limit of the parameter\">Limit-</td>\n",
       "        <td title=\"Upper limit of the parameter\">Limit+</td>\n",
       "        <td title=\"Is the parameter fixed in the fit\">Fixed?</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>0</td>\n",
       "        <td>par_000_amplitude</td>\n",
       "        <td>3.32931</td>\n",
       "        <td>0.222011</td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>1</td>\n",
       "        <td>par_001_reference</td>\n",
       "        <td>1</td>\n",
       "        <td>1</td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>2</td>\n",
       "        <td>par_002_alpha</td>\n",
       "        <td>2.32327</td>\n",
       "        <td>0.193054</td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>3</td>\n",
       "        <td>par_003_beta</td>\n",
       "        <td>18.6602</td>\n",
       "        <td>9.95332</td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td></td>\n",
       "        <td>No</td>\n",
       "    </tr>\n",
       "</table>\n",
       "<pre id=\"REyJxpsndg\" style=\"display:none;\">\n",
       "<textarea rows=\"14\" cols=\"50\" onclick=\"this.select()\" readonly>\n",
       "\\begin{tabular}{|c|r|r|r|r|r|r|r|c|}\n",
       "\\hline\n",
       " & Name & Value & Hesse Error & Minos Error- & Minos Error+ & Limit- & Limit+ & Fixed?\\\\\n",
       "\\hline\n",
       "0 & par $000_{amplitude}$ & 3.32931 & 0.222011 &  &  &  &  & No\\\\\n",
       "\\hline\n",
       "1 & par $001_{reference}$ & 1 & 1 &  &  &  &  & Yes\\\\\n",
       "\\hline\n",
       "2 & par $002_{\\alpha}$ & 2.32327 & 0.193054 &  &  &  &  & No\\\\\n",
       "\\hline\n",
       "3 & par $003_{\\beta}$ & 18.6602 & 9.95332 &  &  &  &  & No\\\\\n",
       "\\hline\n",
       "\\end{tabular}\n",
       "</textarea>\n",
       "</pre>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<hr>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "analysis = SpectrumAnalysisIACT(observations=observations, config=config)\n",
    "analysis.run(optimize_opts={\"print_level\": 1})"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Results\n",
    "\n",
    "Let's look at the results, and also compare with a previously published Crab nebula spectrum for reference."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Fit result info \n",
      "--------------- \n",
      "Model: LogParabola\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t   name     value     error         unit      min max\n",
      "\t--------- --------- --------- --------------- --- ---\n",
      "\tamplitude 3.329e-11 2.220e-12 1 / (cm2 s TeV) nan nan\n",
      "\treference 1.000e+00 0.000e+00             TeV nan nan\n",
      "\t    alpha 2.323e+00 1.931e-01                 nan nan\n",
      "\t     beta 1.866e-01 9.953e-02                 nan nan\n",
      "\n",
      "Covariance: \n",
      "\n",
      "\t   name   amplitude  reference   alpha       beta   \n",
      "\t--------- ---------- --------- ---------- ----------\n",
      "\tamplitude  4.929e-24 0.000e+00  2.248e-13 -6.322e-14\n",
      "\treference  0.000e+00 0.000e+00  0.000e+00  0.000e+00\n",
      "\t    alpha  2.248e-13 0.000e+00  3.727e-02 -1.744e-02\n",
      "\t     beta -6.322e-14 0.000e+00 -1.744e-02  9.907e-03 \n",
      "\n",
      "Statistic: 39.258 (wstat)\n",
      "Fit Range: [ 0.87992254 27.82559402] TeV\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(analysis.fit.result[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0xb1dc5ae10>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "opts = {\n",
    "    \"energy_range\": analysis.fit.fit_range,\n",
    "    \"energy_power\": 2,\n",
    "    \"flux_unit\": \"erg-1 cm-2 s-1\",\n",
    "}\n",
    "axes = analysis.spectrum_result.plot(**opts)\n",
    "CrabSpectrum().model.plot(ax=axes[0], **opts)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "Rerun the analysis, changing some aspects of the analysis as you like:\n",
    "\n",
    "* only use one or two observations\n",
    "* a different spectral model\n",
    "* different config options for the spectral analysis\n",
    "* different energy binning for the spectral point computation\n",
    "\n",
    "Observe how the measured spectrum changes."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
