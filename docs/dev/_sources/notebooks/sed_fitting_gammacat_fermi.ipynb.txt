{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/sed_fitting_gammacat_fermi.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[sed_fitting_gammacat_fermi.ipynb](../_static/notebooks/sed_fitting_gammacat_fermi.ipynb) |\n",
    "[sed_fitting_gammacat_fermi.py](../_static/notebooks/sed_fitting_gammacat_fermi.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Flux point fitting in Gammapy\n",
    "\n",
    "\n",
    "## Introduction\n",
    "\n",
    "In this tutorial we're going to learn how to fit spectral models to combined Fermi-LAT and IACT flux points.\n",
    "\n",
    "The central class we're going to use for this example analysis is:  \n",
    "\n",
    "- `~gammapy.spectrum.FluxPointsDataset`\n",
    "\n",
    "In addition we will work with the following data classes:\n",
    "\n",
    "- `~gammapy.spectrum.FluxPoints`\n",
    "- `~gammapy.catalog.SourceCatalogGammaCat`\n",
    "- `~gammapy.catalog.SourceCatalog3FHL`\n",
    "- `~gammapy.catalog.SourceCatalog3FGL`\n",
    "\n",
    "And the following spectral model classes:\n",
    "\n",
    "- `~gammapy.modeling.models.PowerLawSpectralModel`\n",
    "- `~gammapy.modeling.models.ExpCutoffPowerLawSpectralModel`\n",
    "- `~gammapy.modeling.models.LogParabolaSpectralModel`"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setup\n",
    "\n",
    "Let us start with the usual IPython notebook and Python imports:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "from astropy import units as u\n",
    "from gammapy.modeling.models import (\n",
    "    PowerLawSpectralModel,\n",
    "    ExpCutoffPowerLawSpectralModel,\n",
    "    LogParabolaSpectralModel,\n",
    "    SkyModel,\n",
    ")\n",
    "from gammapy.spectrum import FluxPointsDataset, FluxPoints\n",
    "from gammapy.catalog import (\n",
    "    SourceCatalog3FGL,\n",
    "    SourceCatalogGammaCat,\n",
    "    SourceCatalog3FHL,\n",
    ")\n",
    "from gammapy.modeling import Fit"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load spectral points\n",
    "\n",
    "For this analysis we choose to work with the source 'HESS J1507-622' and the associated Fermi-LAT sources '3FGL J1506.6-6219' and '3FHL J1507.9-6228e'. We load the source catalogs, and then access source of interest by name:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "fermi_3fgl = SourceCatalog3FGL()\n",
    "fermi_3fhl = SourceCatalog3FHL()\n",
    "gammacat = SourceCatalogGammaCat(\n",
    "    \"$GAMMAPY_DATA/catalogs/gammacat/gammacat.fits.gz\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "source_gammacat = gammacat[\"HESS J1507-622\"]\n",
    "source_fermi_3fgl = fermi_3fgl[\"3FGL J1506.6-6219\"]\n",
    "source_fermi_3fhl = fermi_3fhl[\"3FHL J1507.9-6228e\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The corresponding flux points data can be accessed with `.flux_points` attribute:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<i>Table length=6</i>\n",
       "<table id=\"table4713212056\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>e_ref</th><th>dnde</th><th>dnde_errn</th><th>dnde_errp</th></tr></thead>\n",
       "<thead><tr><th>TeV</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th></tr></thead>\n",
       "<thead><tr><th>float32</th><th>float32</th><th>float32</th><th>float32</th></tr></thead>\n",
       "<tr><td>0.8609</td><td>2.29119e-12</td><td>8.70543e-13</td><td>8.95502e-13</td></tr>\n",
       "<tr><td>1.56151</td><td>6.98172e-13</td><td>2.20354e-13</td><td>2.30407e-13</td></tr>\n",
       "<tr><td>2.76375</td><td>1.69062e-13</td><td>6.7587e-14</td><td>7.18838e-14</td></tr>\n",
       "<tr><td>4.8916</td><td>7.72925e-14</td><td>2.40132e-14</td><td>2.60749e-14</td></tr>\n",
       "<tr><td>9.98858</td><td>1.03253e-14</td><td>5.06315e-15</td><td>5.64195e-15</td></tr>\n",
       "<tr><td>27.0403</td><td>7.44987e-16</td><td>5.72089e-16</td><td>7.25999e-16</td></tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<Table length=6>\n",
       " e_ref        dnde         dnde_errn       dnde_errp   \n",
       "  TeV   1 / (cm2 s TeV) 1 / (cm2 s TeV) 1 / (cm2 s TeV)\n",
       "float32     float32         float32         float32    \n",
       "------- --------------- --------------- ---------------\n",
       " 0.8609     2.29119e-12     8.70543e-13     8.95502e-13\n",
       "1.56151     6.98172e-13     2.20354e-13     2.30407e-13\n",
       "2.76375     1.69062e-13      6.7587e-14     7.18838e-14\n",
       " 4.8916     7.72925e-14     2.40132e-14     2.60749e-14\n",
       "9.98858     1.03253e-14     5.06315e-15     5.64195e-15\n",
       "27.0403     7.44987e-16     5.72089e-16     7.25999e-16"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flux_points_gammacat = source_gammacat.flux_points\n",
    "flux_points_gammacat.table"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the Fermi-LAT catalogs, integral flux points are given. Currently the flux point fitter only works with differential flux points, so we apply the conversion here."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "flux_points_3fgl = source_fermi_3fgl.flux_points.to_sed_type(\n",
    "    sed_type=\"dnde\", model=source_fermi_3fgl.spectral_model()\n",
    ")\n",
    "flux_points_3fhl = source_fermi_3fhl.flux_points.to_sed_type(\n",
    "    sed_type=\"dnde\", model=source_fermi_3fhl.spectral_model()\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally we stack the flux points into a single `~gammapy.spectrum.FluxPoints` object and drop the upper limit values, because currently we can't handle them in the fit:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "# stack flux point tables\n",
    "flux_points = FluxPoints.stack(\n",
    "    [flux_points_gammacat, flux_points_3fhl, flux_points_3fgl]\n",
    ")\n",
    "\n",
    "# drop the flux upper limit values\n",
    "flux_points = flux_points.drop_ul()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Power Law Fit\n",
    "\n",
    "First we start with fitting a simple `~gammapy.modeling.models.PowerLawSpectralModel`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "pwl = PowerLawSpectralModel(\n",
    "    index=2, amplitude=\"1e-12 cm-2 s-1 TeV-1\", reference=\"1 TeV\"\n",
    ")\n",
    "model = SkyModel(spectral_model=pwl)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "After creating the model we run the fit by passing the `'flux_points'` and `'model'` objects:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "dataset_pwl = FluxPointsDataset(model, flux_points, likelihood=\"chi2assym\")\n",
    "fitter = Fit([dataset_pwl])\n",
    "result_pwl = fitter.run()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "And print the result:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : minuit\n",
      "\tsuccess    : True\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\tnfev       : 40\n",
      "\ttotal stat : 33.68\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(result_pwl)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PowerLawSpectralModel\n",
      "\n",
      "   name     value   error      unit      min max frozen\n",
      "--------- --------- ----- -------------- --- --- ------\n",
      "    index 1.966e+00   nan                nan nan  False\n",
      "amplitude 1.345e-12   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "reference 1.000e+00   nan            TeV nan nan   True\n"
     ]
    }
   ],
   "source": [
    "print(pwl)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally we plot the data points and the best fit model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = flux_points.plot(energy_power=2)\n",
    "pwl.plot(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "\n",
    "# assign covariance for plotting\n",
    "pwl.parameters.covariance = result_pwl.parameters.covariance\n",
    "\n",
    "pwl.plot_error(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "ax.set_ylim(1e-13, 1e-11);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exponential Cut-Off Powerlaw Fit\n",
    "\n",
    "Next we fit an `~gammapy.modeling.models.ExpCutoffPowerLawSpectralModel` law to the data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "ecpl = ExpCutoffPowerLawSpectralModel(\n",
    "    index=1.8,\n",
    "    amplitude=\"2e-12 cm-2 s-1 TeV-1\",\n",
    "    reference=\"1 TeV\",\n",
    "    lambda_=\"0.1 TeV-1\",\n",
    ")\n",
    "model = SkyModel(spectral_model=ecpl)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We run the fitter again by passing the flux points and the model instance:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ExpCutoffPowerLawSpectralModel\n",
      "\n",
      "   name     value   error      unit      min max frozen\n",
      "--------- --------- ----- -------------- --- --- ------\n",
      "    index 1.869e+00   nan                nan nan  False\n",
      "amplitude 2.126e-12   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "reference 1.000e+00   nan            TeV nan nan   True\n",
      "  lambda_ 1.000e-01   nan          TeV-1 nan nan  False\n",
      "    alpha 1.000e+00   nan                nan nan   True\n"
     ]
    }
   ],
   "source": [
    "dataset_ecpl = FluxPointsDataset(model, flux_points, likelihood=\"chi2assym\")\n",
    "fitter = Fit([dataset_ecpl])\n",
    "result_ecpl = fitter.run()\n",
    "print(ecpl)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We plot the data and best fit model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1e-13, 1e-11)"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = flux_points.plot(energy_power=2)\n",
    "ecpl.plot(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "\n",
    "# assign covariance for plotting\n",
    "ecpl.parameters.covariance = result_ecpl.parameters.covariance\n",
    "\n",
    "ecpl.plot_error(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "ax.set_ylim(1e-13, 1e-11)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Log-Parabola Fit\n",
    "\n",
    "Finally we try to fit a `~gammapy.modeling.models.LogParabolaSpectralModel` model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "log_parabola = LogParabolaSpectralModel(\n",
    "    alpha=2, amplitude=\"1e-12 cm-2 s-1 TeV-1\", reference=\"1 TeV\", beta=0.1\n",
    ")\n",
    "model = SkyModel(spectral_model=log_parabola)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value   error      unit      min max frozen\n",
      "--------- --------- ----- -------------- --- --- ------\n",
      "amplitude 1.930e-12   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "reference 1.000e+00   nan            TeV nan nan   True\n",
      "    alpha 2.151e+00   nan                nan nan  False\n",
      "     beta 5.259e-02   nan                nan nan  False\n"
     ]
    }
   ],
   "source": [
    "dataset_log_parabola = FluxPointsDataset(\n",
    "    model, flux_points, likelihood=\"chi2assym\"\n",
    ")\n",
    "fitter = Fit([dataset_log_parabola])\n",
    "result_log_parabola = fitter.run()\n",
    "print(log_parabola)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = flux_points.plot(energy_power=2)\n",
    "log_parabola.plot(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "\n",
    "# assign covariance for plotting\n",
    "log_parabola.parameters.covariance = result_log_parabola.parameters.covariance\n",
    "\n",
    "log_parabola.plot_error(\n",
    "    energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2\n",
    ")\n",
    "ax.set_ylim(1e-13, 1e-11);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "- Fit a `~gammapy.modeling.models.PowerLaw2SpectralModel` and `~gammapy.modeling.models.ExpCutoffPowerLaw3FGLSpectralModel` to the same data.\n",
    "- Fit a `~gammapy.modeling.models.ExpCutoffPowerLawSpectralModel` model to Vela X ('HESS J0835-455') only and check if the best fit values correspond to the values given in the Gammacat catalog"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## What next?\n",
    "\n",
    "This was an introduction to SED fitting in Gammapy.\n",
    "\n",
    "* If you would like to learn how to perform a full Poisson maximum likelihood spectral fit, please check out the [spectrum analysis](spectrum_analysis.ipynb) tutorial.\n",
    "* To learn more about other parts of Gammapy (e.g. Fermi-LAT and TeV data analysis), check out the other tutorial notebooks.\n",
    "* To see what's available in Gammapy, browse the Gammapy docs or use the full-text search.\n",
    "* If you have any questions, ask on the mailing list ."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
