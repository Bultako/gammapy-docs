{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy/master?urlpath=lab/tree/sed_fitting_gammacat_fermi.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[sed_fitting_gammacat_fermi.ipynb](../_static/notebooks/sed_fitting_gammacat_fermi.ipynb) |\n",
    "[sed_fitting_gammacat_fermi.py](../_static/notebooks/sed_fitting_gammacat_fermi.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Flux point fitting in Gammapy\n",
    "\n",
    "\n",
    "## Introduction\n",
    "\n",
    "In this tutorial we're going to learn how to fit spectral models to combined Fermi-LAT and IACT flux points.\n",
    "\n",
    "The central class we're going to use for this example analysis is:  \n",
    "\n",
    "- [gammapy.spectrum.FluxPointsDataset](..\/spectrum/index.rst#reference-api)\n",
    "\n",
    "In addition we will work with the following data classes:\n",
    "\n",
    "- [gammapy.spectrum.FluxPoints](..\/api/gammapy.spectrum.FluxPoints.rst)\n",
    "- [gammapy.catalog.SourceCatalogGammaCat](..\/api/gammapy.catalog.SourceCatalogGammaCat.rst)\n",
    "- [gammapy.catalog.SourceCatalog3FHL](..\/api/gammapy.catalog.SourceCatalog3FHL.rst)\n",
    "- [gammapy.catalog.SourceCatalog3FGL](..\/api/gammapy.catalog.SourceCatalog3FGL.rst)\n",
    "\n",
    "And the following spectral model classes:\n",
    "\n",
    "- [PowerLaw](..\/api/gammapy.spectrum.models.PowerLaw.rst)\n",
    "- [ExponentialCutoffPowerLaw](..\/api/gammapy.spectrum.models.ExponentialCutoffPowerLaw.rst)\n",
    "- [LogParabola](..\/api/gammapy.spectrum.models.LogParabola.rst)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setup\n",
    "\n",
    "Let us start with the usual IPython notebook and Python imports:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "from astropy import units as u\n",
    "from gammapy.spectrum.models import (\n",
    "    PowerLaw,\n",
    "    ExponentialCutoffPowerLaw,\n",
    "    LogParabola,\n",
    ")\n",
    "from gammapy.spectrum import FluxPointsDataset, FluxPoints\n",
    "from gammapy.catalog import (\n",
    "    SourceCatalog3FGL,\n",
    "    SourceCatalogGammaCat,\n",
    "    SourceCatalog3FHL,\n",
    ")\n",
    "from gammapy.utils.fitting import Fit"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load spectral points\n",
    "\n",
    "For this analysis we choose to work with the source 'HESS J1507-622' and the associated Fermi-LAT sources '3FGL J1506.6-6219' and '3FHL J1507.9-6228e'. We load the source catalogs, and then access source of interest by name:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "fermi_3fgl = SourceCatalog3FGL()\n",
    "fermi_3fhl = SourceCatalog3FHL()\n",
    "gammacat = SourceCatalogGammaCat(\"$GAMMAPY_DATA/gamma-cat/gammacat.fits.gz\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "source_gammacat = gammacat[\"HESS J1507-622\"]\n",
    "source_fermi_3fgl = fermi_3fgl[\"3FGL J1506.6-6219\"]\n",
    "source_fermi_3fhl = fermi_3fhl[\"3FHL J1507.9-6228e\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The corresponding flux points data can be accessed with `.flux_points` attribute:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<i>Table length=6</i>\n",
       "<table id=\"table4459678576\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>e_ref</th><th>dnde</th><th>dnde_errn</th><th>dnde_errp</th></tr></thead>\n",
       "<thead><tr><th>TeV</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th></tr></thead>\n",
       "<thead><tr><th>float32</th><th>float32</th><th>float32</th><th>float32</th></tr></thead>\n",
       "<tr><td>0.8609004</td><td>2.29119e-12</td><td>8.705427e-13</td><td>8.955021e-13</td></tr>\n",
       "<tr><td>1.561512</td><td>6.981717e-13</td><td>2.203541e-13</td><td>2.304066e-13</td></tr>\n",
       "<tr><td>2.763753</td><td>1.690615e-13</td><td>6.758698e-14</td><td>7.188384e-14</td></tr>\n",
       "<tr><td>4.891597</td><td>7.729249e-14</td><td>2.401318e-14</td><td>2.607487e-14</td></tr>\n",
       "<tr><td>9.988584</td><td>1.032534e-14</td><td>5.063147e-15</td><td>5.641954e-15</td></tr>\n",
       "<tr><td>27.04035</td><td>7.449867e-16</td><td>5.72089e-16</td><td>7.259987e-16</td></tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<Table length=6>\n",
       "  e_ref         dnde         dnde_errn       dnde_errp   \n",
       "   TeV    1 / (cm2 s TeV) 1 / (cm2 s TeV) 1 / (cm2 s TeV)\n",
       " float32      float32         float32         float32    \n",
       "--------- --------------- --------------- ---------------\n",
       "0.8609004     2.29119e-12    8.705427e-13    8.955021e-13\n",
       " 1.561512    6.981717e-13    2.203541e-13    2.304066e-13\n",
       " 2.763753    1.690615e-13    6.758698e-14    7.188384e-14\n",
       " 4.891597    7.729249e-14    2.401318e-14    2.607487e-14\n",
       " 9.988584    1.032534e-14    5.063147e-15    5.641954e-15\n",
       " 27.04035    7.449867e-16     5.72089e-16    7.259987e-16"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flux_points_gammacat = source_gammacat.flux_points\n",
    "flux_points_gammacat.table"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the Fermi-LAT catalogs, integral flux points are given. Currently the flux point fitter only works with differential flux points, so we apply the conversion here."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "flux_points_3fgl = source_fermi_3fgl.flux_points.to_sed_type(\n",
    "    sed_type=\"dnde\", model=source_fermi_3fgl.spectral_model\n",
    ")\n",
    "flux_points_3fhl = source_fermi_3fhl.flux_points.to_sed_type(\n",
    "    sed_type=\"dnde\", model=source_fermi_3fhl.spectral_model\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally we stack the flux points into a single `FluxPoints` object and drop the upper limit values, because currently we can't handle them in the fit:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "# stack flux point tables\n",
    "flux_points = FluxPoints.stack(\n",
    "    [flux_points_gammacat, flux_points_3fhl, flux_points_3fgl]\n",
    ")\n",
    "\n",
    "# drop the flux upper limit values\n",
    "flux_points = flux_points.drop_ul()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Power Law Fit\n",
    "\n",
    "First we start with fitting a simple [power law](..\/api/gammapy.spectrum.models.PowerLaw.rst#gammapy.spectrum.models.PowerLaw)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "pwl = PowerLaw(index=2, amplitude=\"1e-12 cm-2 s-1 TeV-1\", reference=\"1 TeV\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "After creating the model we run the fit by passing the `'flux_points'` and `'pwl'` objects:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "dataset_pwl = FluxPointsDataset(pwl, flux_points, likelihood=\"chi2assym\")\n",
    "fitter = Fit(dataset_pwl)\n",
    "result_pwl = fitter.run()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "And print the result:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : minuit\n",
      "\tsuccess    : True\n",
      "\tnfev       : 40\n",
      "\ttotal stat : 33.68\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(result_pwl)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PowerLaw\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t   name     value   error      unit      min max frozen\n",
      "\t--------- --------- ----- -------------- --- --- ------\n",
      "\t    index 1.966e+00   nan                nan nan  False\n",
      "\tamplitude 1.345e-12   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "\treference 1.000e+00   nan            TeV nan nan   True\n"
     ]
    }
   ],
   "source": [
    "print(pwl)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally we plot the data points and the best fit model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = flux_points.plot(energy_power=2)\n",
    "pwl.plot(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "\n",
    "# assign covariance for plotting\n",
    "pwl.parameters.covariance = result_pwl.parameters.covariance\n",
    "\n",
    "pwl.plot_error(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "ax.set_ylim(1e-13, 1e-11);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exponential Cut-Off Powerlaw Fit\n",
    "\n",
    "Next we fit an [exponential cut-off power](..\/api/gammapy.spectrum.models.ExponentialCutoffPowerLaw.rst#gammapy.spectrum.models.ExponentialCutoffPowerLaw) law to the data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "ecpl = ExponentialCutoffPowerLaw(\n",
    "    index=1.8,\n",
    "    amplitude=\"2e-12 cm-2 s-1 TeV-1\",\n",
    "    reference=\"1 TeV\",\n",
    "    lambda_=\"0.1 TeV-1\",\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We run the fitter again by passing the flux points and the `ecpl` model instance:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ExponentialCutoffPowerLaw\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t   name     value   error      unit      min max frozen\n",
      "\t--------- --------- ----- -------------- --- --- ------\n",
      "\t    index 1.869e+00   nan                nan nan  False\n",
      "\tamplitude 2.126e-12   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "\treference 1.000e+00   nan            TeV nan nan   True\n",
      "\t  lambda_ 1.000e-01   nan          TeV-1 nan nan  False\n"
     ]
    }
   ],
   "source": [
    "dataset_ecpl = FluxPointsDataset(ecpl, flux_points, likelihood=\"chi2assym\")\n",
    "fitter = Fit(dataset_ecpl)\n",
    "result_ecpl = fitter.run()\n",
    "print(ecpl)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We plot the data and best fit model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1e-13, 1e-11)"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = flux_points.plot(energy_power=2)\n",
    "ecpl.plot(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "\n",
    "# assign covariance for plotting\n",
    "ecpl.parameters.covariance = result_ecpl.parameters.covariance\n",
    "\n",
    "ecpl.plot_error(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "ax.set_ylim(1e-13, 1e-11)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Log-Parabola Fit\n",
    "\n",
    "Finally we try to fit a [log-parabola](..\/api/gammapy.spectrum.models.LogParabola.rst#gammapy.spectrum.models.LogParabola) model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "log_parabola = LogParabola(\n",
    "    alpha=2, amplitude=\"1e-12 cm-2 s-1 TeV-1\", reference=\"1 TeV\", beta=0.1\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabola\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t   name     value   error      unit      min max frozen\n",
      "\t--------- --------- ----- -------------- --- --- ------\n",
      "\tamplitude 1.930e-12   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "\treference 1.000e+00   nan            TeV nan nan   True\n",
      "\t    alpha 2.151e+00   nan                nan nan  False\n",
      "\t     beta 5.259e-02   nan                nan nan  False\n"
     ]
    }
   ],
   "source": [
    "dataset_log_parabola = FluxPointsDataset(\n",
    "    log_parabola, flux_points, likelihood=\"chi2assym\"\n",
    ")\n",
    "fitter = Fit(dataset_log_parabola)\n",
    "result_log_parabola = fitter.run()\n",
    "print(log_parabola)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = flux_points.plot(energy_power=2)\n",
    "log_parabola.plot(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "\n",
    "# assign covariance for plotting\n",
    "log_parabola.parameters.covariance = result_log_parabola.parameters.covariance\n",
    "\n",
    "log_parabola.plot_error(\n",
    "    energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2\n",
    ")\n",
    "ax.set_ylim(1e-13, 1e-11);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "- Fit a `PowerLaw2` and `ExponentialCutoffPowerLaw3FGL` to the same data.\n",
    "- Fit a `ExponentialCutoffPowerLaw` model to Vela X ('HESS J0835-455') only and check if the best fit values correspond to the values given in the Gammacat catalog"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## What next?\n",
    "\n",
    "This was an introduction to SED fitting in Gammapy.\n",
    "\n",
    "* If you would like to learn how to perform a full Poisson maximum likelihood spectral fit, please check out the [spectrum pipe](spectrum_pipe.ipynb) tutorial.\n",
    "* If you are interested in simulation of spectral data in the context of CTA, please check out the [spectrum simulation cta](spectrum_simulation_cta.ipynb) notebook.\n",
    "* To learn more about other parts of Gammapy (e.g. Fermi-LAT and TeV data analysis), check out the other tutorial notebooks.\n",
    "* To see what's available in Gammapy, browse the [Gammapy docs](https://docs.gammapy.org/) or use the full-text search.\n",
    "* If you have any questions, ask on the mailing list ."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
