{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/sed_fitting_gammacat_fermi.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[sed_fitting_gammacat_fermi.ipynb](../_static/notebooks/sed_fitting_gammacat_fermi.ipynb) |\n",
    "[sed_fitting_gammacat_fermi.py](../_static/notebooks/sed_fitting_gammacat_fermi.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Flux point fitting in Gammapy\n",
    "\n",
    "\n",
    "## Introduction\n",
    "\n",
    "In this tutorial we're going to learn how to fit spectral models to combined Fermi-LAT and IACT flux points.\n",
    "\n",
    "The central class we're going to use for this example analysis is:  \n",
    "\n",
    "- `~gammapy.spectrum.FluxPointsDataset`\n",
    "\n",
    "In addition we will work with the following data classes:\n",
    "\n",
    "- `~gammapy.spectrum.FluxPoints`\n",
    "- `~gammapy.catalog.SourceCatalogGammaCat`\n",
    "- `~gammapy.catalog.SourceCatalog3FHL`\n",
    "- `~gammapy.catalog.SourceCatalog3FGL`\n",
    "\n",
    "And the following spectral model classes:\n",
    "\n",
    "- `~gammapy.modeling.models.PowerLawSpectralModel`\n",
    "- `~gammapy.modeling.models.ExpCutoffPowerLawSpectralModel`\n",
    "- `~gammapy.modeling.models.LogParabolaSpectralModel`"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setup\n",
    "\n",
    "Let us start with the usual IPython notebook and Python imports:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "from astropy import units as u\n",
    "from gammapy.modeling.models import (\n",
    "    PowerLawSpectralModel,\n",
    "    ExpCutoffPowerLawSpectralModel,\n",
    "    LogParabolaSpectralModel,\n",
    ")\n",
    "from gammapy.spectrum import FluxPointsDataset, FluxPoints\n",
    "from gammapy.catalog import (\n",
    "    SourceCatalog3FGL,\n",
    "    SourceCatalogGammaCat,\n",
    "    SourceCatalog3FHL,\n",
    ")\n",
    "from gammapy.modeling import Fit"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load spectral points\n",
    "\n",
    "For this analysis we choose to work with the source 'HESS J1507-622' and the associated Fermi-LAT sources '3FGL J1506.6-6219' and '3FHL J1507.9-6228e'. We load the source catalogs, and then access source of interest by name:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "fermi_3fgl = SourceCatalog3FGL()\n",
    "fermi_3fhl = SourceCatalog3FHL()\n",
    "gammacat = SourceCatalogGammaCat(\"$GAMMAPY_DATA/gamma-cat/gammacat.fits.gz\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "source_gammacat = gammacat[\"HESS J1507-622\"]\n",
    "source_fermi_3fgl = fermi_3fgl[\"3FGL J1506.6-6219\"]\n",
    "source_fermi_3fhl = fermi_3fhl[\"3FHL J1507.9-6228e\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The corresponding flux points data can be accessed with `.flux_points` attribute:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<i>Table length=6</i>\n",
       "<table id=\"table4699523056\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>e_ref</th><th>dnde</th><th>dnde_errn</th><th>dnde_errp</th></tr></thead>\n",
       "<thead><tr><th>TeV</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th></tr></thead>\n",
       "<thead><tr><th>float32</th><th>float32</th><th>float32</th><th>float32</th></tr></thead>\n",
       "<tr><td>0.8609004</td><td>2.29119e-12</td><td>8.705427e-13</td><td>8.955021e-13</td></tr>\n",
       "<tr><td>1.561512</td><td>6.981717e-13</td><td>2.203541e-13</td><td>2.304066e-13</td></tr>\n",
       "<tr><td>2.763753</td><td>1.690615e-13</td><td>6.758698e-14</td><td>7.188384e-14</td></tr>\n",
       "<tr><td>4.891597</td><td>7.729249e-14</td><td>2.401318e-14</td><td>2.607487e-14</td></tr>\n",
       "<tr><td>9.988584</td><td>1.032534e-14</td><td>5.063147e-15</td><td>5.641954e-15</td></tr>\n",
       "<tr><td>27.04035</td><td>7.449867e-16</td><td>5.72089e-16</td><td>7.259987e-16</td></tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<Table length=6>\n",
       "  e_ref         dnde         dnde_errn       dnde_errp   \n",
       "   TeV    1 / (cm2 s TeV) 1 / (cm2 s TeV) 1 / (cm2 s TeV)\n",
       " float32      float32         float32         float32    \n",
       "--------- --------------- --------------- ---------------\n",
       "0.8609004     2.29119e-12    8.705427e-13    8.955021e-13\n",
       " 1.561512    6.981717e-13    2.203541e-13    2.304066e-13\n",
       " 2.763753    1.690615e-13    6.758698e-14    7.188384e-14\n",
       " 4.891597    7.729249e-14    2.401318e-14    2.607487e-14\n",
       " 9.988584    1.032534e-14    5.063147e-15    5.641954e-15\n",
       " 27.04035    7.449867e-16     5.72089e-16    7.259987e-16"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flux_points_gammacat = source_gammacat.flux_points\n",
    "flux_points_gammacat.table"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the Fermi-LAT catalogs, integral flux points are given. Currently the flux point fitter only works with differential flux points, so we apply the conversion here."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "flux_points_3fgl = source_fermi_3fgl.flux_points.to_sed_type(\n",
    "    sed_type=\"dnde\", model=source_fermi_3fgl.spectral_model()\n",
    ")\n",
    "flux_points_3fhl = source_fermi_3fhl.flux_points.to_sed_type(\n",
    "    sed_type=\"dnde\", model=source_fermi_3fhl.spectral_model()\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally we stack the flux points into a single `~gammapy.spectrum.FluxPoints` object and drop the upper limit values, because currently we can't handle them in the fit:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "# stack flux point tables\n",
    "flux_points = FluxPoints.stack(\n",
    "    [flux_points_gammacat, flux_points_3fhl, flux_points_3fgl]\n",
    ")\n",
    "\n",
    "# drop the flux upper limit values\n",
    "flux_points = flux_points.drop_ul()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Power Law Fit\n",
    "\n",
    "First we start with fitting a simple `~gammapy.modeling.models.PowerLawSpectralModel`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "pwl = PowerLawSpectralModel(\n",
    "    index=2, amplitude=\"1e-12 cm-2 s-1 TeV-1\", reference=\"1 TeV\"\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "After creating the model we run the fit by passing the `'flux_points'` and `'pwl'` objects:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "dataset_pwl = FluxPointsDataset(pwl, flux_points, likelihood=\"chi2assym\")\n",
    "fitter = Fit([dataset_pwl])\n",
    "result_pwl = fitter.run()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "And print the result:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : minuit\n",
      "\tsuccess    : True\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\tnfev       : 40\n",
      "\ttotal stat : 33.68\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(result_pwl)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PowerLawSpectralModel\n",
      "\n",
      "   name     value   error      unit      min max frozen\n",
      "--------- --------- ----- -------------- --- --- ------\n",
      "    index 1.966e+00   nan                nan nan  False\n",
      "amplitude 1.345e-12   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "reference 1.000e+00   nan            TeV nan nan   True\n"
     ]
    }
   ],
   "source": [
    "print(pwl)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally we plot the data points and the best fit model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = flux_points.plot(energy_power=2)\n",
    "pwl.plot(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "\n",
    "# assign covariance for plotting\n",
    "pwl.parameters.covariance = result_pwl.parameters.covariance\n",
    "\n",
    "pwl.plot_error(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "ax.set_ylim(1e-13, 1e-11);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exponential Cut-Off Powerlaw Fit\n",
    "\n",
    "Next we fit an `~gammapy.modeling.models.ExpCutoffPowerLawSpectralModel` law to the data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "ecpl = ExpCutoffPowerLawSpectralModel(\n",
    "    index=1.8,\n",
    "    amplitude=\"2e-12 cm-2 s-1 TeV-1\",\n",
    "    reference=\"1 TeV\",\n",
    "    lambda_=\"0.1 TeV-1\",\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We run the fitter again by passing the flux points and the `ecpl` model instance:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ExpCutoffPowerLawSpectralModel\n",
      "\n",
      "   name     value   error      unit      min max frozen\n",
      "--------- --------- ----- -------------- --- --- ------\n",
      "    index 1.869e+00   nan                nan nan  False\n",
      "amplitude 2.126e-12   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "reference 1.000e+00   nan            TeV nan nan   True\n",
      "  lambda_ 1.000e-01   nan          TeV-1 nan nan  False\n"
     ]
    }
   ],
   "source": [
    "dataset_ecpl = FluxPointsDataset(ecpl, flux_points, likelihood=\"chi2assym\")\n",
    "fitter = Fit([dataset_ecpl])\n",
    "result_ecpl = fitter.run()\n",
    "print(ecpl)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We plot the data and best fit model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1e-13, 1e-11)"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = flux_points.plot(energy_power=2)\n",
    "ecpl.plot(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "\n",
    "# assign covariance for plotting\n",
    "ecpl.parameters.covariance = result_ecpl.parameters.covariance\n",
    "\n",
    "ecpl.plot_error(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "ax.set_ylim(1e-13, 1e-11)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Log-Parabola Fit\n",
    "\n",
    "Finally we try to fit a `~gammapy.modeling.models.LogParabolaSpectralModel` model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "log_parabola = LogParabolaSpectralModel(\n",
    "    alpha=2, amplitude=\"1e-12 cm-2 s-1 TeV-1\", reference=\"1 TeV\", beta=0.1\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value   error      unit      min max frozen\n",
      "--------- --------- ----- -------------- --- --- ------\n",
      "amplitude 1.930e-12   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "reference 1.000e+00   nan            TeV nan nan   True\n",
      "    alpha 2.151e+00   nan                nan nan  False\n",
      "     beta 5.259e-02   nan                nan nan  False\n"
     ]
    }
   ],
   "source": [
    "dataset_log_parabola = FluxPointsDataset(\n",
    "    log_parabola, flux_points, likelihood=\"chi2assym\"\n",
    ")\n",
    "fitter = Fit([dataset_log_parabola])\n",
    "result_log_parabola = fitter.run()\n",
    "print(log_parabola)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAY8AAAEQCAYAAABIqvhxAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAgAElEQVR4nO3dd3ikZdX48e+Zycxk0nvPpuwmu8suvSyI8oNX8UUFLIhgwYZiw4IVBbEggoKgIC8gKlaQYkUpdlFBZJe2NZtNTza9l8kkmbl/f0yyhJDJ9Mxk9nyua67NlOd5zrOTyZnnLucWYwxKKaVUKCzxDkAppdTao8lDKaVUyDR5KKWUCpkmD6WUUiHT5KGUUipkmjyUUkqFTJOHUkqpkGnyUEopFbKETx4iUisiPxCRB1Z6TCml1OqJafIQkR+KSJ+I7Fry+Fki0iAiB0Tk8pX2YYxpNsZcHOgxpZRSqyclxvv/EfBd4CcLD4iIFbgVOBPoBJ4Skd8BVuDaJdu/1xjTF+MYlVJKhSimycMY85iIVC95+CTggDGmGUBEfgG83hhzLXB2LONRSikVHbG+8lhOOdCx6H4nsM3fi0UkH7gGOFZEPm+MuXa5x5bZ7hLgEoD09PTjN23aFM1zUEqppLdjx44BY0zhcs/FI3nIMo/5Le1rjBkEPhjosWW2+x7wPYATTjjBbN++PfRIlVLqMCYibf6ei8doq06gctH9CuBgHOJQSikVpngkj6eAOhGpERE7cCHwuzjEoZRSKkyxHqp7D/AEsFFEOkXkYmPMHHAp8CiwF7jPGLM7lnEopZSKrliPtnqrn8cfAh6K5bEBROQc4JwNGzbE+lBKKXVYSfgZ5pEwxjxojLkkOzs73qEopVRSSerkoZRSKjY0eSillAqZJg+llFIhS+rkISLniMj3RkdH4x2KUkollaROHtphrpRSsZHUyUMppVRsaPJQSikVMk0eSimlQqbJQymlVMiSOnnEY7TVBXc8wQV3PLFqx1NKqXhI6uSho62UUio2kjp5KHW40itgFWuaPJRSSoVMk4dSSqmQafJQSikVMk0eSimlQqbJQymlVMiSOnloVV2llIqNpE4eOs9DKaViI6mTR7x0Dk/FOwSllIopTR4x0DUyHe8QlFIqpjR5KKWUCllKvANIFjf9aT/f+UvjofvVl/8BgI+/so7LzqyPV1hKKRUTmjyi5LIz67nszHouuOMJnmwZovW618U7JKWUihlttlIqSenADRVLSZ084jXPozwndVWPp9RydOCGiqWkTh7xmudRkZu2qsdTSqnVpn0eSiURHbihVosmD6WSiA7cUKslqZutlFJKxYYmD6WSlA7cULGkyUOpJKUDN1QsafJQSikVMk0eSimlQqbJQymlVMg0eSilInbBHU9wwR1PxDsMtYqSOnnoMrRKKRUbSZ08dBlapZSKjaROHkoppWJDk4dSSqmQaW2rKLv3A6fEOwSllIo5vfJQSikVshWvPETkqCD2MWuM2RuleJRSSq0BgZqt/g08A8gKr6kEqqMVkFKJYGHOgjZDKrW8QMnjGWPMaSu9QEQei2I8Siml1oAV+zwCJY5gX6OUUiq5BDXaSkQE2AqUAS5gtzFmMJaBKaXCp81tKtYCdZhXA58FzgJagH4gFagTkRHgduBnxhgT2zCVUkolkkBXHt8EbgMuNcZ4Fz8hIqXA24F3AT+KSXRKKaUS0orJwxjzlhWe6wZuiHpEUSQi5wDnbNiwId6hKKVUUglqkqCIvElEMud/vlxE7hORY2IbWuS0MKKKROfwVLxDUCphBTvD/MvGmHEReRlwDnAvvv4OpZJW18h0vENQKmEFmzw88/+eDfyfMeaXgCM2ISmllEp0wRZG7BaRW/GNujpBROxoXSyVhG76036+85fGQ/erL/8DAB9/ZR2XnVkfr7CUSjjBJo+3AK8FbjHGDItIGXB57MJSKj4uO7Oey86s54I7nuDJliFar3tdvENSKiEFlTyMMRPAfYvuHwQOxioopZRSiU2bnpTyozwnNd4hKJWwdDEopfyoyE2LyX5jUbF3cZEHXzUhpWJLk4dSCWh2dha3283MzAxut5vZ2dlDN4/Hc+hmjGG56kAWiwWLxYLVaiUlJeXQzW63H7o5HA7sdrsmGxWWQLWtyoFvAOXAw8CNxpi5+ed+aYw5L/YhKpW8jDG4XC6mpqaYmprC5XIxPT3N3NxcRPv1er14vV7m5uZwu91+XyciOBwOnE4nTqeTtLQ00tLSsNlsER0/nnQtltUR6Mrjh8CDwH+Ai4G/ici5xphhoDbWwSmVbLxe76Grhv379zM5OYnX6w28YYwYY5ienmZ6eprh4eFDj9vtdtLT08nIyCAzMxOn0xm3GFViCpQ8iowx353/ebuIvAt4TETOBbSSrkpIifbN0+12MzIywtjYGBMTE7hcvrIn4+PjcY7Mv5mZGWZmZg4llJSUFDIzM8nKyiI7OxubzZZw/89qdQVKHg4RcRhj3ADGmB+LSC/wJyA2vYlKJYGpqSmGh4cZGRlhenrtlzmZm5tjeHj4UDJxOp3MzMyQkqLdpoerQO/8XcApwN8XHjDGPCIiFwLXxzAupdYct9vN4OAgQ0NDK/YzJAOXy8XMjJuZGTc7d+7E7XZjswVOJHq1kjwClWRfNkEYY7YDZ8QkIqXWEK/Xy9DQEIODg0xMTMTgAHPYpwdIcQ9jmxkhxT2CdXYC69wk1rkpLB434p1FvHP4WpIFxILXkoLXmorX6sCbksacLROPPYtZezazqfnMphbgTYlO48HMzAyzs77brl27yMvLIy8vj9RUnSeTzIJdhnYdcClQvXgbY8ybYhOWUonN5XLR39/P0NAQHo8n8AYrMV4cU904x5pInejEMdlB6kQXdlcPtukhhOU71D1WJ15rKsaS4ruJBTFeMF7EO4fFM43VM42Y5eObS0lnJq0Ud3oZ7rQyXJlVTGdWMZ1RhTclvA5yt9tNd3c33d3dpKenk5+fT15eHlarNaz9qcQVbIPl74Cf4OvriN/QEKVWib9mldHRUXp7e8Pv7DaGMu9BNnoaqdzVRdpIA86xZqyeF/pFZhz5uNPLGSs8npnUImadhcykFjDnyGHOnsOcLdP3x12CKxAhHjcps+NYZ8axzQxjmx7CNj2A3dWLY6qH1PFWsnsex+IbhY9BcKdXMJVTx2R2PZO5W5jKrsNY7SGd6uTkJJOTk3R2dpKbm0tBQUFI26vEFmzymDHG3BjTSJRKUMYYBgYG6O3tDb0vwxhSJ9rJ7N9B5tDzZAzu5M4ZX6ezpz2Vqex6Bta9FldWLa7MGqYzq6LWnHQoBKuDWauD2dQCpqlZ/kVeD46pLlLH20kbb8Y52kj60C7yuv7qe9piYyq7nvGCYxgvOJaJ3C1BH9/r9TI4OMjg4CBTU1PYbDY8Ho9ejaxxwSaPW0TkSuBR4NCnxxjzfEyiUioBeL1e+vr66OvrY3Z2NujtLHMusvq3k937H7L6t2Of7gfA7SxmrOgEft5fyz5rPRf/z1EgCfIH1GLFnbEOd8Y6RktffujhlOkh0of3kDG8m4zB5yk5cA+ljT/Ha7HzFTmC7SnHYZ88Awiuf8Pr9eB2e9i5cyd5eXkUFRVp38gaFWzyqAfeB7yGF5qtDHBaLIKKFl3D/PAVyRKyHo+H/v5+ent7g57pbZ0ZI6fn3+R2P0bmwNNYvLPM2TIYLziO7sKLGCs8gZm0EgAe/fugb6NESRwrmEvNY7T05YcSimV2koyhnWT1b6ek9Qk+6P4h/PWHfNeyjsdTtuEcezWuzFoIUPJk4f+4v7+frKwsiouLycrKilrcuoRw7IWynkf1wnyPtcIY8yDw4AknnPD+eMeiVlc4S8guXGkEmzQscy5yev5NXtefyerfgRgP7rRS+qtfz0jxy5jI2wqW5JoH4bWlM1Z8MmPFJ3PVwFsp8fbw5eq9TOz7GxfOPID1H/fjyqhiqPx/GC7/H9zp5QH3OTY2xtjYGE6nk6KiIvLz8yOut6VLCMdesL/ZzwOZLGqyUipZLPRpdHd3B26eMoaMoZ3kdzxM7sHHsHpcuJ3F9Naez3DZ6Uxl1wX81p1Meiwl9NVu4ar2M8j2jnJtra+fpLzhLsob7mI870gGK89iuOz0gCO4XC4XbW1tHDx4kKKiIgoLC7VfJIEFmzzygX0i8iQv7vPQoboqYYSzhOzw8DBdXV0BO8KtM2PkdzxKQfsfcE6040lJY7j8DAYrzmQi78igRz4t6JuMcHhvAhq1ZDNQfS4D1edic/WR1/lnCjoeofq566ncdQtDFWdS4zmNFmv1ivuZnZ2lq6uLnp4eCgsLuezBNkQk4MRCXUJ4dQWbPK6JaRRKRUEoS8hOTEzQ2dnJ5OTkivtMHWumqOXX5Hf+GYvXzUTuEbQe/ZmgvkmvpH8qtBHvi0urW61WrFbrobLrFosFEXlRU89CqXZjzKEKux6P51Cl3YXbcuXcQ+EvCc46i+itexu9G95K+vBuCtr/QH7Ho3zX+yBf8FxCzsESRkpeARb/VxYej4eenh4mJyex2WzMzMxgt/sfLqxLCK+uYJNHI9BnjJkGEBEnoIO21Zrjdrvp6up6UQXZlzCGzIEdlBy4l6yBHXgtdgYrXkV/9RtxZa+Pekwigt1uJzU19UXrbNjtdmw2GzabLWZrbixeJ8Ttdh+6TU9PBzUsOWASFGEybyuTeVvpPOJDPPX3X3H36Ol8fcfbcDuL6at5EwNVrwswPNkcmr2en59PSUkJDocjtBNVURds8vgV8LJF973AL4GToh6RUlGwdAlZr9dLd3c3vb29/r9tGw+53f+kpPFu0sYOMOvIo3PT+xioeh0ee3bEMd27e5z79rxwpXPe/T0AfPyVG7jszI0R7z8cC8lpOV6vl+np6UPrjExOTjI1NRX21YrHnsVv7OcAsxw48WqKmx+gcs9tlDb+lL7qN9JX8yY8Dv//zwt9U4ODg+Tl5VFaWuo3iegSwrEXbPJIMcbMLNwxxrhFRFO/SliLl5AdGhqis7PTf2e48ZDX9TdKGn+Oc6KN6fRKvp36If6W8gquqisJOwaLxUJ6evqhdTGuOSqNb86XMl8LzSoWi+XQ4lALjDFc//Bu/u+xtkOPLSTBwjT//T5LE+er/rke+Bxvr53m0967KGv8KcXN99NffS696y9kzpHjd1/GmEMFKPPz8yktLX1Jc1aslhBWLwg2eQyKyGuNMQ8BiMjZwFDswlIqci6Xi/b2dv8FC42XnO5/UtZwF86JdlyZNTQf90WGy07jT/8YCfl4InJo8aTMzEzS09OTbolXEeGzr93KZ1+79VAS3HXl/+Oiu7YzN+d/EMAFWzK5YEsmV/19kN39s/zy/BeScjNfIXW8jZLGn1Pc9ACFrb+jv+YN9Ky/YMUrvsVXIgUFBZSWlq7pFRDXmmCTxweBe0TkVnyTAweAt8csKqUiYnC7Z9i7d6/fJpbMvqco3/d90kcbcWVU0XT8lxgpfUXIo6bsdjvZ2dlkZ2eTmZmJxRLc9snUrJKRkYHd7sBuh61btx5a92NqKviJetOZVbQe9wW6699B6f6fUnzgXgpaH6R3w1txmNNxr9DQYYyhv7+fwcFBCgsLMcYkXdJOREElD2NMI3CCiOTM3w/9a5lSq2B4eJjJySmM8S6bOJyjTVTsuZ2sgR2400ppOeZyhipeGdJsb4fDQW5uLrm5uS9q0glFsjSrLE2CDoeDkpISSkpKDq1vMjg4yMzMoVbvFZu33BnraD3uCno2vI3yfd+nfN/3uVN+yc/sF4A5b8X3yev10tvby+TkJHa7Ha/XG3QyX0zXHAnOisljftGne838p3Bp0hCRaqDMGPN4rAJUKhhut5uOjg5GR0cx5qUjgFLcw5Tv+wH57Q/jsWXQseXD9FedG3SlWJvNdmidinATRjJaKQk6HA7KysooKytjbGyMvr4+YJCi9MCJejqrhqaTriF9cCfmP7fycfftTD32Zzq2fJiJgmMCbG2YmXGza9cuysrKojJjXb1UoCuPcuAZEfkvsAPox1cBbQNwOjAGfC6WASq1EmMMvb29dHd34/UuM2zUO0dRy68p2/8TLJ5p+mrfTHfdO/DYM4PYu5Cbm0t+fj5ZWVn6BygCWVlZZGVlkZ7ey8zMLFarNah1UCbzj+SqtK9x2tzjfGL2bjY+8UmGS0+jY8uHmXUWrbjt7OwsbW1t9PX1UV5eTnZ25CPm1AsCrST4LRH5DnAmcCq+obkuYC9wsTGmJfYhKrW8yclJ2tracLlcyz6fMfgc657/Ns6JNkYLT6Jj64dxZ6wLuF/fHAsHNpuN2traaId9WBOx4HA4OPLIIw9VLA5YR0yEx2yncuYr/pfipvsobbybrL7/0l33DvrWn4+xrNxJ7nK5OHDgAFlZWVRUVOB0hj+5U70gYJ+HMWYOeHj+plTceb1eurq65ptBXirLO8p73T9j4+N/x+0s5sCJX2O0+JSANafS09MpLi4mJycH++P/iUHkaoHVaqW0tJTi4mL6+vro6ekJeCVirA566i9iqOJMKnbfSsW+75Pf+Sfajvokk/lHBjzm2NgYe/fupaCggLKyMlJSkqto5WrT/z21poyNjdHW1vaiDthDjCGv6y/cPnUL6WaK7g1vpbvuIkzKyiObsrOzKSkpISMjI0ZRK38sFgslJSUUFhbS09NDX1/f8s2Pi8ykldB84tVk9f6HdTu/w6bHP07/urPpOuISPLaV38OFkVlDQ0OUl5dTUFCgzZFh0uSh1oS5uTk6OjoYGlp+epFtqpeqnTeR3fdf9lnquNn5QS7efOyK+8zOzqasrEw7wBOA1WqlvLycwsJCOjs7Vy4fM2+s+GT25B9NacOPKG7+Jdm9T9B+1GVA4Nn6Ho+H9vZ2BgYGqKys1C8OYQg02upEY8xTqxWMUssZHh6mvb19+bZxY8jveITK3beC8dKx5SNM1ryBi1cY0pmZmUl5eTnp6ekxjFqFw263U1tby8TEBO3t7Yf6s/wVYPSmOOna8iGGy19J1bPfZMNTV/KplFdwR+p78BUDX9nU1BQNDQ3k5+dTUVGhTVkhCPQ/9QER+R6wG3gEeNQY0x/7sJTyjZbp6Ojw+y00ZXqQque+RU7ffxjPP5rWYz7LTFqp3/2lpqZSUVER9KgbXY0ufjIyMti8eTO9vb3AUMACjFM59ew77TZKGn/Oaft/ztGTuxjq+xxjRcGV3xscHGR0dJTy8sCLVymfQKOt3gcgIlvxLUF7j4ikAn/Fl0z+Y5YbVK9UhIaGhujo6PA7Eien+zGqnrsRi8dN+5ZL6a95g9/Z4VarlbKyMgoLC0Nq39bV6OJLRCgpKSE9vQn6l+njWsJYbHRvfDfXdm7lU9O3UPfk5fRVv56uzZcEVT5/bm5ufvTeFA5H8lQAiJVgZ5jvAnYB14tIOvBK4CLgu8BxsQtPHW4WPsAjI8sXMbDMuajc9V0KOh5mMrueluO+sOLwW22OWLuWLu60UIDxLUekc8EW//N0mq01fCLtOu4o+g1FzQ+Q1f80zcdfiSu7LqjjejwepqamOHjwIKWlpdqh7kfInyhjzCTwu/mbUlGzYt8G4BxtpHbH1Tgmu+je8Da6N77L7xh/h8NBVVUVmZnBTAZ8ga5GlziWW9zJ5XLR3NzM9LT/q8Kvnu7r6+jkQ4wWb6P6mWvZ9K9L6dr8fvpqzgtymWBDd3c3w8PDVFdXa//YMvTrmIq7hZEv/kZSYQyFrb+hYs/tzNmz2H/KjUwUHO13f8XFxZSVlYVV10hXo0tsTqeTzZs3097ezuDgYMDXjxccx57Tvu9bCnf3/5HZ/zStx34u6PVZpqen2bdvX0S/U8lK/ydUXI2NjbF7926/icMyO0Ht9i+zbtctjBUcz57Tvu83cdjtdurr66moqNAPeZJZXIDRYrFQXV1NdXV1UO+zx5FN04lX0771o2QN7OCIf3yA9KHdIR2/t7eXvXv3Bly2+HCy4v+8iHxbRHS1QBV1Xq+Xjo4OGhsb/S7S5BxrYvM/P0RO77/pPOIDNJ30Nb8rzeXl5XHEEUeE3Ey1kmQqm77WLVeAMT8/n40bN664rvkhIvTXvJGGU2/BWKxsfPwTFDXdDyGsijg9PU1DQwNdXV0Rr/2eDAKl7Q7gVhFpEpFr5kddKRWRqakp9u7d67e8CEBexx/Z9M9LscxN03DKTfSuv2DZ0VQWi4WqqipqamqwWoMvqx6MZCmbnszS0tLYvHlz0F8apnLq2XvaHYwUn0zlntuoefprWOaWr422HGMMPT097N27129NtcNFwMKIwLdEZD1wIb6hugLcDfzCGNO8CjGqJNLb27vyNzfvHJW7/4+i1t8wln8MLcdfyZwjb9mXpqamUltbq4Xu1pBYrJGRkpJCXV0dHR0d9PcHnobmsWXQfMJXKW76BeV7f4BzvIWmE76KO6Mi6GO6XC727dtHeXk5RUUrV/dNVkE1DBtjmowx1xhjjgTeBZwPNAbYTKlDZmdnaWxspLOz02/iSHEPU//Epylq/Q29tefTePL1fhNHdnY2mzZt0sShAN+ckHXr1lFREWQCEKF3w1tpPPk6bNNDbPrnh8jq+29Ixwym6TWZBZU8RMQqIq8RkR8DfwCagQtiGplKGqOjo+zZs4exsTG/r3GOHmDzYx8ifWQfzcdeQeeWD4Fl+Wao0tJSNmzYEPVmKrX2FRcXs379+qAHTIwXnsDe025nJq2YDU9+gaKm+8AYv+VQlrNQrXel3+9kFKjD/Iz58iRdwMfwzSyvM8acZ4x5YDUCFJFaEfmBiDyw6LE3iMidIvJbEXn1asRxuLngjicOLccZLmMMnZ2dHDhwwO/cjav+PsjDf3qIjf/+GGDYd+rNDFe8ctnXWiwWamtrKSsriyguldxycnKoq6sL+svFTFoJDafewkjpy6ncczuXTd8asBzKUgtX1is1yUbjM5VIAqXnrwLPAEcaY15jjPmxMWY82J2LyA9FpE9Edi15/CwRaRCRAyJy+Ur7MMY0G2MuXvLYb4wx7wfejV4BJaSZmRkaGhrmaxP5YQxvcf+KK6dvwJVZw95X3IYrZ/mJeAvt2rm5uTGKWCWTjIwM6uvrsdlWXihqgTfFSfPxV3Fw47t51dw/ALC6R0M+bk9PD/v3719+yYAkE6jD/BULP4vIyUC9MeYnIpIPpBtj2gPs/0f4Spj8ZNF+rMCt+FYn7ASeEpHfAVbg2iXbv9cY439IDlw5vy+VQEZGRmhtbV1xcR/xzrLu+Rs5fuZR/pbycrJfdqXf9cQdDgd1dXU4HI5YhazCEIvO72hKS0tj48aNQf8xv3fPJPfteTXga8x4w+9cgCtgOZSlJiYm2Lt3LzU1NWRlZYUZfeILts/jSuBL+P5Yg28d87sDbWeMeQxYOvvrJODA/BXFDPAL4PXGmJ3GmLOX3JZNHOLzDeBhY8zTfl5ziYhsF5HtwYzAUJFbaKZqampaMXFYZyfY8OTlFHQ8ys/t53ND6sf8Jo60tDQ2bdqkiUOFxeFwsHHjxqB+fy7Ykskvzy9hS6HvaqUx6yMcyLyEi0tCH1Q6NzdHY2MjBw8eDHnbtSLYabhvBl4LTAIYY7qAcFNqOb75Iws65x9blojki8jtwLEi8vn5hz8KvAp4s4h8cLntjDHfM8acYIw5obCwMMxQVbBmZ2fZv3//ys1UgM3Vx8Z/f4yMwZ20HPM57na8xW+toczMTOrr67WooYrIQuWBUL+A7HvFrcw68qj7z2fJ7fpbWMfu7u5esc9vLQv2U+k2xhgRMQAiEsnsqeX+UvidrmmMGQQ+uOSxm4GbI4hBRdH4+DgtLS0BhyumjjVT9+TlWOdcHDj5OsYLjoOm5esTZWdnU1tbm5RlRhK9uScZ2e12Nm7cSENDA263O+DrC9MszKQV0XDqzax/6ovUPn01ndN9vsmqIRodHWXfvn14vd6k+n0O9kx+JSK3Atki8h7gj8APwzxmJ1C56H4FkLzXdkmur68vqHHuGQPPsfHfHwcMDad+25c4/MjJyQlpuKVSwbDZbNTX1wdVzqQo3TdSy2PPovHk6xkqO52KPXdQvvs2CGMJI7fbzdTUVFJdgQS7nsc3ROQ1wAxwNHCNMebhMI/5FFAnIjX4hgBfCLwtzH2pOPF6vbS1tfmvhLtIdve/qH36atxppTRu+wazacV+X5ubm0tNTY2uoaBiYqEJq6GhIeiJfcZqp+W4K5mz51DSfD+2mRFaj/4MWEJtTjVMT7vo6upKihULA61h/kdjzKsB5pNFSAlDRO4BTgcKRKQT+JIx5gcicinwKL4RVj80xoRW4jL4458DnLNhw4ZY7P6wNTMzQ1NTE1NTgZdpzW9/mKrnvsVkzkYObPv6iqWwNXGo1eBwOA4lkKCvBMRCx9aPMuvIpbzhLlJmxmg6/kuYlNCLZ/b09DA9PU1NTc2avroOFHlEPc3GmLcaY0qNMTZjTIUx5gfzjz9kjKk3xqw3xlwTyTECHP9BY8wlwa5ZrQJbGIYYTOIoarqf6ueuZ7zgWBpPuWHFxJGdna2JQ62a1NTUkCYSAiBCT/1FtB31SbL6/kvdk5djmQ2vRPvIyAj79u1b0/NBAl13ZYvIm/w9aYz5VZTjUQlsYGCA9vb2wOWojaF0/48p2/8ThktPo+XYL/gdigtgtaawfv16TRxqVaWlpbF+/XoaGxtDKrE+UHU2npR0ap75OvVPfJrGbdf5XSpgJS6Xi71797Jhw4Y1uVJhwOQBnI3/EVKaPA4DC/M3ViqhvujFlO+9g5Km+xio/F/ajv40iP9vd1arlcFpk3CJQ0dEHR4yMzOpqamhuTm0uRzD5WfgSXGyfvuX2fj4J9h/yg3MpeaHfPy5uTn2799PdXX1mqueECh5tBlj3rsqkaiE5PF4aGlpYXQ0iFINxkvlrlsoav0tfdWvp2PrR5ddg2OB0+nE6XTT1TMcxYiVCk1ubi4VFRV0dnaGtN1Y8ck0bruODf/9Ahsfv4z9p3yLWWfoLf1er5fm5mbKy8spKSkJeft4CdTnkVhfB9Wq6hiaoqGhIejEse75Gylq/S096y+gY+vHVkwcdruduro69FdMJYLi4mLCmUw8UXAMjSd/E5t7iI2Pf1vFZnsAAB69SURBVAL7VE/YMXR1ddHeHqjiU+IIlDwuWpUoYkREzhGR7wX1x0+9iNfr5eDodHCrpRkvVc/dQGH7Q3TXvYOuzZf4nTUOviKHj3RaqfviH3myxTfUt/ryP1B9+R+46U/7o3UKSoWksrKScAbXTOZtZf/J12OdHaf+8cuwT3WHHUN/fz9NTU14vaHPJVltgZLHdYF2ICK/j1IsUaejrcIzMjIS1GgqAIyHqueup6DjEQ7Wv5ODG9+zYuIQEdavX89nXnMErde9jm01vsWeWq97Ha3XvY7Lzly+qq5SsSYi81UNQl8nZip3M/tPvgHr3BT1j38yoiuQkZER9u/fn/ATCgP1ebx8vuKtPwIcEcV4VJxd89tnuPOJFyb8n3e/70OwbGXR+SuOgo5HObjx3XTXvzPg/qurq8nIyIhqzEpFi8Viwel0MjUV+hBcV049+0++nvr/fIb6xy9j/8tuYiYtvD6MyclJGhoaqKurC2pGfDwESh6vD2Ifa3egsnqRrq4uzqrwctb5JVz190F298/yy/P9/PIbL+uev8mXOOrfGVTiKCsrIy/vpcvKlueEPtFKHT5We+SbiJCa6kREQhrCC4sTyKepf/yTNLzsphUrKqxkenr6UAJJTU28z0ig9Tz+sVqBqPgxxtDW1sbg4PJFCpfZgMpdt1DY/ge6N7yd7vp3BdwkPz+f0tLSZZ+ryI2kzqZS0We1WqmsrAyrA9uVU0/jyTdQ98SnqP/Pp9n/spuYTS0IK46FRdXq6upIS0usz8nanRuvosLr9dLU1LRs4ihMW+bXwxgq9tx+aFTVwU3vXbGPAyA9PZ2qqqpohazUqigsLKSgILw/+lM59Rw4+RvYpoeoe+LTpLjDH46+MBdkYmIi7H3EQlInDx1ttTKPx8P+/fv9DsVdqCy6WOn+H1PcfD991W8IOKoKfENydfa4WqvWrVsX9uzvydwjOLDt6zimeql74jNkBL+C90t4PB4aGxuDGza/SoJdSbBomcc2Rj+c6NLRVv7Nzs7S0NDA5GTwHYPFTfdStv8nDFSeRcfWSwMmDovFwvr164NeR1qpRLMwAivcBckm8o/mwElXkzrZwVemriXVBDH03Y+FVoKRkZGw9xFNwV55/FNE3rJwR0Q+Bfw6NiGpWHO73TQ0NAQ3h2NeQdvvqdhzB0Nlp9N29KdWnAC4YN26dQnXTqtUqOx2OzU1NWFvP154As3HfZE6bxNfdF2PeMIfY2SMobm5OailEGIt2ORxOnCRiNwvIo8B9fjWIldrzMIIjmBWU1uQc/AfrHv+JkaLTqL12M+vWKtqQWFhIfn5odf6USoRZWVlUVZWFvb2o6Uv56bUD3OMZye1O64GryfsfRljaGlpCX6AS4wElTyMMd3AI8ApQDXwE2NMYvXeqICmpqZCWgQHILN/OzVPX8Nk7haajv8yxhK4CSo9PZ3KysqAr1NqLSktLSUzMzPwC/34m+3/cZvjveT0/puq578FIQ4DXqq1tTWuCSTYPo8/AduArcBrgZtE5IZYBqaia3JyMuRZq/WeRtY/dRXTmes4sO3rQS18k5KSQm1trXaQq6RUU1MTdv8HwO/tr+Fg/Tsp6HiE8n13RhxPa2srAwMDEe8nHME2W91qjHmnMWbEGLMLeBmQON3+akUTExM0Njbi8QR/qVzmPciXXdcy58ilcds38NiCmxVeU1OTsDNilYqUzWaLqP8DoLv+XfRXnUPJgV9Q1HR/xDG1tbXFJYEE22z1myX354wxV8cmpOjRobowPj4ecuJImR7i6qmvYRAat30j6HUKSktLycrKCjdUpdaErKwsiovDmzUOgAjtR36M4dLTqNxzG7mdf4k4ppAm+UZJsM1W4yIyNn+bFhGPiCT8X+TDfaju+Pg4Bw4cCKlCp2V2kronLyfbjPFl5+dxZ1QEtV1GRobfGeRKJZvy8nKcTmf4OxArLcd+gfH8o6l+9htkDjwdcUxtbW2rOgor2CuPTGNM1vwtFTgPuDW2oalIhJM48M6xfvuXcY63cK3zUzRaNwS1mfZzqMPNCxV4Q5tn3Tf5QguAsdppOvFq3BkVrH/qSzjHmiKKyRhDa2vrqs0DCWuG+Xwz1v9EORYVpAvueIIL7njC7/NhJQ5jqHr+RrIGdtB21CfZkXJs0JtWV1frREB12ElNTaW8vDykbfqnXvyZ9NgyfGugp6Sy4cnPY3MFsdTzCowxdHeHv55IKIJttnrTotubReQ6fGuYqwQzMTEReuIASht/emhNjsF1rwl6u8LCwrAW0FEqGRQVFUXczzfrLOLAtuuwzrnY8N8vYJkNvRx8PAR75XHOotv/AuMEV65draKFUVWhJo68jj9S1vAjBiteHVSF3AWpqalUVATXJ6JUsqqqqsJq9T9x9t7d45x3fw+7+33zq867v4fz7u/h3t0v1LpyZa2n6fircI63RjyJcLUENWDZGPOeWAeiIjM1NRXWFUfG4HNUPXcDY/nHzJcdCa7fQkSoqakJuc13qdVeq0GpaLPb7VRWVtLa2rrs8xdsyeSCLZkB18gZLzqR9iM/QdXzN7Ju1820H/mJoD+P8bBi8hCRW1ihecoY87GoR6RC5nK5Qh6OC+CY7GL9U19iJq2U5hO+EtTs8QVlZWVat0qpefn5+QwPD0dc9Xag6mwcUwcpOfALptMr6Ft/fpQijL5AVx7bVyUKFTa3201jY2PI6x1bZ8bY8OTnAWjc9nU89uDLLmRkZFBSEt7ymkolq6qqKvbs2bPiZ3HZNXKW6Nr0PhyTB6nYczvTGZWMFZ8czTCjJlDy+LkxJrFXYV+BiJwDnLNhQ3BDTteamZkZ9u/fH1KtKgC8c9Tu+Ap2Vy/7T76BmfTgR4xYLBaqq6tDO55ShwGbzUZFRYXf5itYfo2clxALLcdczsapHmp3XM2+l9/CdFZt9AKNkkBp8L8LP8w3Ya0pyTxJ0BhDY2MjMzOhl3eu3H0rWQPP0HbUJ5nMPzKkbSsqKnA4HCEfU6nDQX5+flSqLJiUVJpOvBqPLY0N/72CFHf8S7AvFSh5LO6tOTWWgahQGFwuF9PT0yFvWdj620NLyA5V/m9I22ZlZVFYWBjyMZU6nFRVVUU8kARg1llI04nXYHOPsP6pLyPeEFsYYizQGepcjgTj9XpxuVx4wxjKlznwNJW7bmGk6GS6Nr8vpG0tFouuQ64OC/d+4JSIRgHa7faI1v5YbCqnntZjPkvG8C4qd34n4jLu0RSoz2OTiDyP7wpk/fzPzN83xpijYhqdepGFRWBCHVUFYJ/qpnb7V5lOr6TluCuCWtBpsfLycq2Wq1SQiouLGR4eDmmZZ3+Gy8+ge6yZ0gM/x5W1nv6aN0YhwsgFSh6bVyUKFZT29vaw6tZY5lysf+qLgJemE6/Ga0sPafuMjAyKil6yjL1SagXr1q1j3759mChcLRzc9B6c481U7r6V6cwqxguOi0KEkVkxeRhj2lYrELWygwcPhlez3xiqnv0mzrFWDmz7etBVcr96uq8MuzZXKRWetLQ0CgsL6euLrF4V4BuBddwVbPrnR6jd/lX2nnY7M2nxHS4fea+OirmBgYGwi50VH7iHvO5/0LX5fYwVhb7sfGlpKampgVcQVEq9VFlZWdSKhnpT0mg68WowHtY/dRXicUdlv+HS5JHgRkdHaW9vD2vbzP7tlO/7IUNlZ9C7/oKQt3c6nZEteqPUYc5qtVJZWRm1/bkzKmg57gqcY01UPRf5OuiRCJg8ROSo+X9DmxCgIjY5OUlzc3NYbab2qR5qd3yN6cwq2o7+dFg1cqqqqnSNDqUilJubG9UVNseKT+bgxneT3/VnClt+HbX9hiqYK4/3ikgdcHGsg1EvcLvdYRU6BBCPm9rtXwLjoenEr+JNCX3Fs8LCQtLTQ+tYV0otz3f1Eb0vYj11b2ek+GVU7rmN9KFdUdtvKFZMHiLypfnX/AewiMhVqxJVlKzVNcw9Hg8HDhwIuV7VgnU7v0P6aCOtx30BdwilRxbYbLaQF7lRSvmXmpoa3QXTxELrsZfjdhZTu+MrcZmBvmLyMMZ8BfgzcC/wZ2PMV1clqihZi+VJjDE0NTWFNXscIL/9Id+iTnUXMVoc3kSnysrKFdcnUEqFzuGwIxK9bmaPLYPmE79CysxEXNYACeZMthljPgycGOtglG8R+/Hx8cAvXIZztJF1O7/DWMHxdG98Z1j7yMzMJDc3N6xtlVIrERyO6E60dWWtp+3oT5I5+Bzl+74f1X0HEjB5GGOumP/3i7EP5/DW09PD4OBgWNtaZydYv/3LzNlzwppBDr4FntatWxfW8ZVSgaWk2KLelzhUcSb9VedQ0nQv2T3/juq+V6JDdRPEyMgIXV1d4W1sDFXPfgO7q4/m469izpET1m6Kiop0TodSMRbNobsLOrZ8hMnsOqqf/Qa2iYNR3/9yNHkkgKmpKVpaWsLevqjll+T2/JvOIz7AZN6WsPZhs9miVsxNKeVfenp61JuGjdVO8/FfAmMof/wKmIv9BEJNHnE2OztLU1NTWENyAdKG91Kx5w6GS06lr+a8sOOoqKiIShlppVRg5eXlUZ9DNZNeRusxn8M5vBcevSKq+15OoKG6VhH5gIhcLSKnLnnuytiGlvwWRlaFs6AT+JaSrd3xVWZSC2k7+rNhTQQEX+HDvLy8sLZVSoXO4XDEpNjoaOnLGay/EJ66E/b8Lur7XyzQV807gP8HDAI3i8iNi557U8yiOky0tbWFX7LZGKqfvR7b9CDNx38xpDXIl4pFG6xSamWlpaWkpAQqbB66vqM+AmXHwm8vheHWqO9/QaDkcZIx5m3GmG8D24AMEfmViDiI5nTJw1Bvb2/YI6sAzp59hJzef9O1+f1M5YZfOT8/P5+0tLSwt1dKhcdqtVJaWhqDHdvgzXcBBh54L8yF17IRSKDkcWhQsjFmzhhzCfAs8FcgIyYRHQbGxsbCH1kF1HpaeJ/7J4wUn0xf7ZvD3o/VatWZ5ErFUWFhYWwWWcurgXNvhq4d8JevRH//BE4e20XkrMUPzM8yvwuojklESc7tdtPS0hL2AjGWORefc93EqGTSevTnwu7nACgpKYluyQSlVEhEJHajHLe8EV7xKag9PSa7D1Se5B3GmEeWefz7xhj9qxMir9dLU1NT2DWrACp33kyZ6eGG1I/jcYRfdsVut2u5daUSQH5+Pk5n6MVLg/LKq6DuzJjsOtBoq88u+vn8Jc99PSYRRVGiFUZsa2vD5XKFvX1u118p6HyUe+1vYmdKePM5FsRiqKBSKjxrcY5VoGarCxf9/Pklz51Fgkukwoi9vb0MDYVf+dI+1cO6529iIvcI7rafH3iDFaSlpenQXKUSSE5ODhkZa6sbOVDyED8/L3df+TExMRFRBzleDzVPfx3B0HLcFXjDqFu1WEVFcOuYK6VWz1q7+giUPIyfn5e7r5YxOzsb9mqAC0obf0bG8C7aj/wEM2mRDe3Lzs4mMzP8OSFKqdjIzMxcU5/NQDNUjhaRMXxXGc75n5m/rxX0AjDG0NzczOzsbNj7SB/eQ2njTxksfxVDFa+KOCYdmqtU4iorK6OhoSHeYQRlxeRhjNEVgSLQ1dXFxMRE2Ntb5lxUP/11ZlILaD/yYxHHE9NRHUqpiGVkZJCZmRn2mj6rSSvhxcjIyAi9vb0R7aNi9604prppPfbzeG2RdabFdDy5Uipq1srnVJNHDLjdblpbWyPaR3b3vyhsf4ieDRcykX90xDHFbCarUiqqMjIyyMrKincYAWnyiDKv10tzczMeT/jrCae4h6h6/ltMZW2ge+O7I47JYrHEpoaOUiom1sLVhyaPKOvs7GRqair8HRhD1XM3YZ2bouW4L2AskU/kLy4ujkn1TqVUbKSnpyf8yCtNHlE0PDxMf39/RPvI73zUVy130/uYzqyOOCar1aplSJRagxK9tUCTR5S43W7a2toi2od9qofKXd9lPP9o+mrDXxVwseLiYqxWHTSn1FqTmZlJenp6vMPwS5NHFCzM54iknwPjperZb4IxtB7zOZDI35qUlJSYrFamlFodiXz1ockjCiLu5wAKW39L1uCzdGz5MDNpJVGJS686lFrbsrOzE3ZuliaPCI2OjtLX1xfRPuyTXZTvvZPRopMYXPfaqMSlVx1KJYdEvfrQ5BGB2dnZiOdzYLxUP/tNjFhpO+pTES3utFhxcTEWi769Sq11OTk5OByOeIfxEvrXJQItLS0RLewEUNTyazKHdtKx9aPMOgujEpdedSiVPEQkIT/PmjzC1NPTE3H9GcdkF+V7v89I8SkMVURvta+ioiK96lAqiRQUFCTcXC39CxOGyclJDh48GNlOjJeqZ6/Ha7XRftRlUWuuslqtCfktRSkVPovFQmFhdFomoiWpk0cslqH1er20tLREtD4H+EZXZQ49T+eWDzObWhCl6HxXHTrCSqnkU1hYmFBLRyd18ojFMrQdHR243e6I9mGf6vaNrio8icGK/41SZL5vJ3rVoVRystls5OfnxzuMQ5I6eUTbyMgIAwMDke3EGKqeuwHEQtvRn4xacxX4vpkkWruoUip6EqnUkCaPIM3OzkZcfgQgv/0hsgaeoXPzB5h1Ru8qQUQS6hdLKRV9qampCVOuXZNHkNra2iIelmubHqBiz+2M5x3FQNXrohSZT35+PjZb5BV4lVKJLVGapjV5BKG/v59odLpX7rwZi3eWtqM/FZXaVYuVlESnpIlSKrFlZ2cnxKRBTR4BuN1uOjs7I95PzsHHyO35Fwc3vgt3RmUUIntBbm5uQvwyKaVWRyJcfWjyCGBwcBCv1xvRPqwz46zbdTNTWRvorX1LlCJ7gfZ1KHV4yc/Pj/uQfE0eq6B8752kuEdoPfrTYInuG57oNf+VUtFntVrjPmxXk0eMZQw+T2H77+mtPQ9XTn3U969XHUodnuLddKXJI4bEM8O652/E7Syme+O7o75/p9NJNCdAKqXWDofDEddhu5o8YqjkwD04J9ppP/ITeFOiv6BLvL95KKXiq6AgeqWNQqXJI0Yc4+2UHLibobIzGCveFvX9iwh5eXlR369Sau3IycmJ2/wuTR6xYAxVO7+N1+qgY+tHYnIIm82uZdeVOsyJSNyuPvSvTwzkdf6JzMFn6dr0fuYcsbg6EJ1NrpQCfE1X8ai2q8kjyqwzo1TsuY2J3COiXoJkQUpKSkKVZlZKxY/dbo9Lx7kmjyir2HsnKbPj8ws8xea/1263x2S/Sqm1KR4LRWnyiKL0oV0UtD9Eb+35uLLWx+QYGRkZ2tehlHqRrKysVW/K1r9C0eL1sO75bzOTWkR3/TtjdhgdnquUWkpEVn3GuSaPKClq+RVp4810bP1ITOZ0gG8lsZycnJjsWym1tq32qCtNHlFgc/VT1vAjRou2MVLy8pgdJ9HWMFZKJQ6Hw0FGRsaqHU+TRxRU7LkdMR7at340qsvKLhbP8dxKqbVhNf9GaPKIUGb/0+Qd/Bs9dW9jJr0sZsfJzc3VuR1KqRXl5uau2oAaTR4REO8slbtuZjqtjJ71F8b0WPEYiqeUWlssFgu5ubmrc6xVOUqSKmr+Jc6Jdjq2Xoqxxm7uhdPpXNW2TKXU2rVaNe80eYTJ5uqndP9PGCk+hbHik2N6LO3rUEoFKyUlZVWOo8kjTAud5B1bYlP4cIHFYon7imFKKbWUJo8wZAw86+sk3/DWmHaSg68DLN5rFSul1FKaPELl9VC567u4ncX0bHhrzA+nTVZKqUSU8MlDRGpF5Aci8sCixzaLyO0i8oCIfGg14ylse5C08WY6j/gQxuqI6bG0o1wplahimjxE5Ici0iciu5Y8fpaINIjIARG5fKV9GGOajTEXL3lsrzHmg8BbgBOiH/nyrO5RyhruYqzgOEZKXxHz4+lVh1IqUcX6yuNHwFmLHxARK3Ar8BrgCOCtInKEiBwpIr9fcvNbBVBEzgX+BfwlduG/WHnDD7HOTfpWB4xxmRDtKFdKJbKYjukyxjwmItVLHj4JOGCMaQYQkV8ArzfGXAucHcK+fwf8TkT+ANwdnYj9c44eoKDt9/TVvJHpzJpYH46cnBztKFdKJSwxxsT2AL7k8XtjzNb5+28GzjLGvG/+/kXANmPMpX62zweuAc4Evm+MuVZETgfeBDiA540xty6z3SXAJfN3NwINi57OBkb93F/4eeHfAmAgpJN+saXHCuU1yz0eTOz+fo7kXCI5D3/PrcVzCfU8lt5f+vsFa/Ncov2erBRnMK9Jlt8vf8/F61yqjDHLl7cwxsT0BlQDuxbdPx9fEli4fxFwS6zjWBLT9/zdX/h50b/bo3msUF6z3OPBxL7COYV9LpGcRzKdS6jnEej3a62eS7Tfk9U+l0T9/Uq0c1npFo/RVp1A5aL7FcDBVY7hwRXuP+jnNdE6ViivWe7xYGJf6edwRXIe/p5bi+cS6nksvb+Wf78W34/2exLsfvSz8tL7sTwXv+LRbJUC7AdeCXQBTwFvM8bsjmkgYRKR7caYVRvRFUt6LokpWc4lWc4D9FyCEeuhuvcATwAbRaRTRC42xswBlwKPAnuB+xI1ccz7XrwDiCI9l8SULOeSLOcBei4BxfzKQymlVPJJ+BnmSimlEo8mD6WUUiHT5KGUUipkmjwiJCLpIrJDRIKeHZ+I4llsMtpE5A0icqeI/FZEXh3veMK1XFHQtWT+s/Hj+ffi7fGOJxJr/b1YLFqfj8M2eUSjaOO8zwH3xSbK4ESpAGVcik0uFaVz+Y0x5v3Au4ELYhiuX7EqChpvIZ7Xm4AH5t+Lc1c92ABCOZdEfC8WC/FcovP5iMXMw7VwA04DjuPFs9+tQBNQC9iB5/AVbzwS+P2SWxHwKuDC+Tfh7LV8LvPbnAs8jm/ezZo+l/ntvgUclwTn8UC83o8Iz+vzwDHzr7k73rFHci6J+F5E4Vwi+nyszmK3CchEoWijiJwBpOP7oLhE5CFjjDemgS8jGucyv59VLTbpJ4ZovC8CXAc8bIx5OrYRLy9a70miCeW88FWTqACeJQFbOUI8lz2rG11oQjkXEdlLFD4fCfeGxlk50LHofuf8Y8syxlxhjPkEvj+0d8YjcawgpHMRkdNF5GYRuQN4KNbBhSikcwE+iu+q8M0i8sFYBhaiUN+TfBG5HThWRD4f6+Ai4O+8fgWcJyK3EeNSGVG07LmsofdiMX/vS1Q+H4ftlYcfyy3SEXAWpTHmR9EPJWIhnYsx5u/A32MVTIRCPZebgZtjF07YQj2PQSCRkp8/y56XMWYSeM9qBxMhf+eyVt6LxfydS1Q+H3rl8WKJULQxWvRcEk+ynMdSyXReei5B0uTxYk8BdSJSIyJ2fJ3hv4tzTOHSc0k8yXIeSyXTeem5BCveowTiODrhHqAbmMWXoS+ef/y1+Kr+NgFXxDtOPZe1eS7Jch7JfF56LpHdtDCiUkqpkGmzlVJKqZBp8lBKKRUyTR5KKaVCpslDKaVUyDR5KKWUCpkmD6WUUiHT5KEOeyLiEZFnF92CKcUfcyLSKiI7ReQEEfn1fGwHRGR0Uawv87Pt+0Tkp0seK54v220TkXtFZEhE3rA6Z6OSjc7zUIc9EZkwxmREeZ8pxpi5CPfRCpxgjBlY9NjpwKeNMStW4RWRXKARqDDGTM8/dilwpDHmA/P3f4avxPhvIolTHZ70ykMpP+a/+X9FRJ6evwLYNP94+vziO0+JyDMi8vr5x98tIveLyIPAH0XEIiL/JyK7ReT3IvKQiLxZRF4pIr9edJwzReRXEcR5ooj8Q3wrWj4sIsXGmGF8a7O8btFLL8Q3E1mpiGnyUAqcS5qtFq+uNmCMOQ64Dfj0/GNXAH81xpwInAFcLyLp88+dArzLGPM/+FbSq8a32NP75p8D+CuwWUQK5++/B7grnMBFxAF8BzjPGHM88DPg6vmn78GXMBCRyvlYHgvnOEotpSXZlQKXMeYYP88tXBHswJcMAF4NnCsiC8kkFVg3//OfjDFD8z+/HLjf+NZ56RGRv4GvJvZ8f8Q7ROQufEnlnWHGvhnYAvzZtwYWVny1jcBXBO9mEcnAt9zofSax1pxRa5gmD6VW5p7/18MLnxfB902/YfELRWQbMLn4oRX2exe+BZKm8SWYcPtHBHjeGPOKpU8YYyZF5M/4VsK7EPhQmMdQ6iW02Uqp0D0KfHR+uVtE5Fg/r/sXvpX0LCJSDJy+8IQx5iC+tRWuBH4UQSx78K10d9J8LHYR2bLo+XuAzwA5xpinIjiOUi+iyUOpl/Z5XBfg9VcDNuB5EdnFC30MS/0SXxPSLuAO4ElgdNHzPwc6jDFhr49tjHEDbwZuFJHngGeAbYte8gi+JrVfhHsMpZajQ3WViiERyTDGTIhIPvBf4FRjTM/8c98FnjHG/MDPtq0sGaob5dh0qK4Km155KBVbvxeRZ4F/AlcvShw7gKPwjY7ypx/4i4icEO2gRORe4FR8fS5KhUyvPJRSSoVMrzyUUkqFTJOHUkqpkGnyUEopFTJNHkoppUKmyUMppVTINHkopZQK2f8HCG+jRM+N9awAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = flux_points.plot(energy_power=2)\n",
    "log_parabola.plot(energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2)\n",
    "\n",
    "# assign covariance for plotting\n",
    "log_parabola.parameters.covariance = result_log_parabola.parameters.covariance\n",
    "\n",
    "log_parabola.plot_error(\n",
    "    energy_range=[1e-4, 1e2] * u.TeV, ax=ax, energy_power=2\n",
    ")\n",
    "ax.set_ylim(1e-13, 1e-11);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "- Fit a `~gammapy.modeling.models.PowerLaw2SpectralModel` and `~gammapy.modeling.models.ExpCutoffPowerLaw3FGLSpectralModel` to the same data.\n",
    "- Fit a `~gammapy.modeling.models.ExpCutoffPowerLawSpectralModel` model to Vela X ('HESS J0835-455') only and check if the best fit values correspond to the values given in the Gammacat catalog"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## What next?\n",
    "\n",
    "This was an introduction to SED fitting in Gammapy.\n",
    "\n",
    "* If you would like to learn how to perform a full Poisson maximum likelihood spectral fit, please check out the [spectrum analysis](spectrum_analysis.ipynb) tutorial.\n",
    "* To learn more about other parts of Gammapy (e.g. Fermi-LAT and TeV data analysis), check out the other tutorial notebooks.\n",
    "* To see what's available in Gammapy, browse the Gammapy docs or use the full-text search.\n",
    "* If you have any questions, ask on the mailing list ."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
