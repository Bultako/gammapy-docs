{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<script type=\"text/javascript\" src=\"../_static/linksdl.js\"></script>\n",
    "<div class='alert alert-info'>\n",
    "**This is a fixed-text formatted version of a Jupyter notebook.**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy/master?urlpath=lab/tree/simulate_3d.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[simulate_3d.ipynb](../_static/notebooks/simulate_3d.ipynb) |\n",
    "[simulate_3d.py](../_static/notebooks/simulate_3d.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 3D simulation and fitting\n",
    "\n",
    "This tutorial shows how to do a 3D map-based simulation and fit.\n",
    "\n",
    "For a tutorial on how to do a 3D map analyse of existing data, see the `analysis_3d` tutorial.\n",
    "\n",
    "This can be useful to do a performance / sensitivity study, or to evaluate the capabilities of Gammapy or a given analysis method. Note that is is a binned simulation as is e.g. done also in Sherpa for Chandra, not an event sampling and anbinned analysis as is done e.g. in the Fermi ST or ctools."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Imports and versions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import astropy.units as u\n",
    "from astropy.coordinates import SkyCoord, Angle\n",
    "from gammapy.irf import (\n",
    "    EffectiveAreaTable2D,\n",
    "    EnergyDispersion2D,\n",
    "    EnergyDependentMultiGaussPSF,\n",
    "    Background3D,\n",
    ")\n",
    "from gammapy.maps import WcsGeom, MapAxis, WcsNDMap, Map\n",
    "from gammapy.spectrum.models import PowerLaw\n",
    "from gammapy.image.models import SkyGaussian\n",
    "from gammapy.cube.models import SkyModel, SkyModels\n",
    "from gammapy.cube import MapFit, MapEvaluator, PSFKernel\n",
    "from gammapy.cube import make_map_exposure_true_energy, make_map_background_irf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\r\n",
      "Gammapy package:\r\n",
      "\r\n",
      "\tpath                   : /Users/deil/work/code/gammapy-docs/build/dev/gammapy/gammapy \r\n",
      "\tversion                : 0.9.dev7598 \r\n",
      "\tgithash                : db9275d6c336c3f76c6fcee6c465f640056ad321 \r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!gammapy info --no-envvar --no-dependencies --no-system"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Simulate"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_irfs():\n",
    "    \"\"\"Load CTA IRFs\"\"\"\n",
    "    filename = \"$GAMMAPY_DATA/cta-1dc/caldb/data/cta/1dc/bcf/South_z20_50h/irf_file.fits\"\n",
    "    psf = EnergyDependentMultiGaussPSF.read(\n",
    "        filename, hdu=\"POINT SPREAD FUNCTION\"\n",
    "    )\n",
    "    aeff = EffectiveAreaTable2D.read(filename, hdu=\"EFFECTIVE AREA\")\n",
    "    edisp = EnergyDispersion2D.read(filename, hdu=\"ENERGY DISPERSION\")\n",
    "    bkg = Background3D.read(filename, hdu=\"BACKGROUND\")\n",
    "    return dict(psf=psf, aeff=aeff, edisp=edisp, bkg=bkg)\n",
    "\n",
    "\n",
    "irfs = get_irfs()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SkyModel\n",
      "\n",
      "spatial_model = SkyGaussian\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t name   value   error unit min max\n",
      "\t----- --------- ----- ---- --- ---\n",
      "\tlon_0 2.000e-01   nan  deg nan nan\n",
      "\tlat_0 1.000e-01   nan  deg nan nan\n",
      "\tsigma 3.000e-01   nan  deg nan nan\n",
      "\n",
      "spectral_model = PowerLaw\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t   name     value   error       unit         min    max\n",
      "\t--------- --------- ----- --------------- --------- ---\n",
      "\t    index 3.000e+00   nan                       nan nan\n",
      "\tamplitude 1.000e-11   nan 1 / (cm2 s TeV)       nan nan\n",
      "\treference 1.000e+00   nan             TeV 0.000e+00 nan\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Define sky model to simulate the data\n",
    "spatial_model = SkyGaussian(lon_0=\"0.2 deg\", lat_0=\"0.1 deg\", sigma=\"0.3 deg\")\n",
    "spectral_model = PowerLaw(\n",
    "    index=3, amplitude=\"1e-11 cm-2 s-1 TeV-1\", reference=\"1 TeV\"\n",
    ")\n",
    "sky_model = SkyModel(\n",
    "    spatial_model=spatial_model, spectral_model=spectral_model\n",
    ")\n",
    "print(sky_model)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define map geometry\n",
    "axis = MapAxis.from_edges(\n",
    "    np.logspace(-1., 1., 10), unit=\"TeV\", name=\"energy\", interp=\"log\"\n",
    ")\n",
    "geom = WcsGeom.create(\n",
    "    skydir=(0, 0), binsz=0.02, width=(5, 4), coordsys=\"GAL\", axes=[axis]\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define some observation parameters\n",
    "# Here we just have a single observation,\n",
    "# we are not simulating many pointings / observations\n",
    "pointing = SkyCoord(1, 0.5, unit=\"deg\", frame=\"galactic\")\n",
    "livetime = 1 * u.hour\n",
    "offset_max = 2 * u.deg\n",
    "offset = Angle(\"2 deg\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "exposure = make_map_exposure_true_energy(\n",
    "    pointing=pointing, livetime=livetime, aeff=irfs[\"aeff\"], geom=geom\n",
    ")\n",
    "exposure.slice_by_idx({\"energy\": 3}).plot(add_cbar=True);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "make_map_background_irf() got an unexpected keyword argument 'livetime'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-9-087660614c4c>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m background = make_map_background_irf(\n\u001b[0;32m----> 2\u001b[0;31m     \u001b[0mpointing\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mpointing\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlivetime\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mlivetime\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbkg\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mirfs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"bkg\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgeom\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mgeom\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m )\n\u001b[1;32m      4\u001b[0m \u001b[0mbackground\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mslice_by_idx\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m{\u001b[0m\u001b[0;34m\"energy\"\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;36m3\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mplot\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0madd_cbar\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m;\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mTypeError\u001b[0m: make_map_background_irf() got an unexpected keyword argument 'livetime'"
     ]
    }
   ],
   "source": [
    "background = make_map_background_irf(\n",
    "    pointing=pointing, livetime=livetime, bkg=irfs[\"bkg\"], geom=geom\n",
    ")\n",
    "background.slice_by_idx({\"energy\": 3}).plot(add_cbar=True);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "psf = irfs[\"psf\"].to_energy_dependent_table_psf(theta=offset)\n",
    "psf_kernel = PSFKernel.from_table_psf(psf, geom, max_radius=0.3 * u.deg)\n",
    "psf_kernel.psf_kernel_map.sum_over_axes().plot(stretch=\"log\");"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "edisp = irfs[\"edisp\"].to_energy_dispersion(offset=offset)\n",
    "edisp.plot_matrix();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'background' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<timed exec>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n",
      "\u001b[0;31mNameError\u001b[0m: name 'background' is not defined"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "# The idea is that we have this class that can compute `npred`\n",
    "# maps, i.e. \"predicted counts per pixel\" given the model and\n",
    "# the observation infos: exposure, background, PSF and EDISP\n",
    "evaluator = MapEvaluator(\n",
    "    model=sky_model, exposure=exposure, background=background, psf=psf_kernel\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'evaluator' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-13-416f6732d83d>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0;31m# dnde = evaluator.compute_dnde()\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;31m# flux = evaluator.compute_flux()\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 5\u001b[0;31m \u001b[0mnpred\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mevaluator\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcompute_npred\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      6\u001b[0m \u001b[0mnpred_map\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mWcsNDMap\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mgeom\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnpred\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mNameError\u001b[0m: name 'evaluator' is not defined"
     ]
    }
   ],
   "source": [
    "# Accessing and saving a lot of the following maps is for debugging.\n",
    "# Just for a simulation one doesn't need to store all these things.\n",
    "# dnde = evaluator.compute_dnde()\n",
    "# flux = evaluator.compute_flux()\n",
    "npred = evaluator.compute_npred()\n",
    "npred_map = WcsNDMap(geom, npred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'npred_map' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-14-e355d317816e>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mnpred_map\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msum_over_axes\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mplot\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0madd_cbar\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m;\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m: name 'npred_map' is not defined"
     ]
    }
   ],
   "source": [
    "npred_map.sum_over_axes().plot(add_cbar=True);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'npred' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-15-61738ded498a>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;31m# Compute counts as a Poisson fluctuation\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mrng\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrandom\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mRandomState\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mseed\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m42\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 6\u001b[0;31m \u001b[0mcounts\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mrng\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpoisson\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnpred\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      7\u001b[0m \u001b[0mcounts_map\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mWcsNDMap\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mgeom\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcounts\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mNameError\u001b[0m: name 'npred' is not defined"
     ]
    }
   ],
   "source": [
    "# This one line is the core of how to simulate data when\n",
    "# using binned simulation / analysis: you Poisson fluctuate\n",
    "# npred to obtain simulated observed counts.\n",
    "# Compute counts as a Poisson fluctuation\n",
    "rng = np.random.RandomState(seed=42)\n",
    "counts = rng.poisson(npred)\n",
    "counts_map = WcsNDMap(geom, counts)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'counts_map' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-16-f7f32552c16d>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mcounts_map\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msum_over_axes\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mplot\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m;\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m: name 'counts_map' is not defined"
     ]
    }
   ],
   "source": [
    "counts_map.sum_over_axes().plot();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Fit\n",
    "\n",
    "Now let's analyse the simulated data.\n",
    "Here we just fit it again with the same model we had before, but you could do any analysis you like here, e.g. fit a different model, or do a region-based analysis, ..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SkyModel\n",
      "\n",
      "spatial_model = SkyGaussian\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t name   value   error unit min max\n",
      "\t----- --------- ----- ---- --- ---\n",
      "\tlon_0 0.000e+00   nan  deg nan nan\n",
      "\tlat_0 0.000e+00   nan  deg nan nan\n",
      "\tsigma 1.000e+00   nan  deg nan nan\n",
      "\n",
      "spectral_model = PowerLaw\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t   name     value   error       unit         min    max\n",
      "\t--------- --------- ----- --------------- --------- ---\n",
      "\t    index 2.000e+00   nan                       nan nan\n",
      "\tamplitude 1.000e-11   nan 1 / (cm2 s TeV)       nan nan\n",
      "\treference 1.000e+00   nan             TeV 0.000e+00 nan\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Define sky model to fit the data\n",
    "spatial_model = SkyGaussian(lon_0=\"0 deg\", lat_0=\"0 deg\", sigma=\"1 deg\")\n",
    "spectral_model = PowerLaw(\n",
    "    index=2, amplitude=\"1e-11 cm-2 s-1 TeV-1\", reference=\"1 TeV\"\n",
    ")\n",
    "model = SkyModel(spatial_model=spatial_model, spectral_model=spectral_model)\n",
    "print(model)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'counts_map' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<timed exec>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n",
      "\u001b[0;31mNameError\u001b[0m: name 'counts_map' is not defined"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "fit = MapFit(\n",
    "    model=model,\n",
    "    counts=counts_map,\n",
    "    exposure=exposure,\n",
    "    background=background,\n",
    "    psf=psf_kernel,\n",
    ")\n",
    "\n",
    "result = fit.run(optimize_opts={\"print_level\": 1})"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "True model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SkyModel\n",
      "\n",
      "spatial_model = SkyGaussian\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t name   value   error unit min max\n",
      "\t----- --------- ----- ---- --- ---\n",
      "\tlon_0 2.000e-01   nan  deg nan nan\n",
      "\tlat_0 1.000e-01   nan  deg nan nan\n",
      "\tsigma 3.000e-01   nan  deg nan nan\n",
      "\n",
      "spectral_model = PowerLaw\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t   name     value   error       unit         min    max\n",
      "\t--------- --------- ----- --------------- --------- ---\n",
      "\t    index 3.000e+00   nan                       nan nan\n",
      "\tamplitude 1.000e-11   nan 1 / (cm2 s TeV)       nan nan\n",
      "\treference 1.000e+00   nan             TeV 0.000e+00 nan\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(sky_model)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Best-fit model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'result' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-20-bf3b956cb7b1>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mresult\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m: name 'result' is not defined"
     ]
    }
   ],
   "source": [
    "print(result.model)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "# TODO: show e.g. how to make a residual image"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## iminuit\n",
    "\n",
    "What we have done for now is to write a very thin wrapper for http://iminuit.readthedocs.io/\n",
    "as a fitting backend. This is just a prototype, we will improve this interface and\n",
    "add other fitting backends (e.g. Sherpa or scipy.optimize or emcee or ...)\n",
    "\n",
    "As a power-user, you can access ``fit._iminuit`` and get the full power of what is developed there already.\n",
    "E.g. the ``fit.fit()`` call ran ``Minuit.migrad()`` and ``Minuit.hesse()`` in the background, and you have\n",
    "access to e.g. the covariance matrix, or can check a likelihood profile, or can run ``Minuit.minos()``\n",
    "to compute asymmetric errors or ..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'fit' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-22-6e9d06617e9e>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0;31m# spatial parameters are uncorrelated,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;31m# but the spectral model amplitude and index are correlated as always\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 5\u001b[0;31m \u001b[0mfit\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mminuit\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mprint_matrix\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m: name 'fit' is not defined"
     ]
    }
   ],
   "source": [
    "# Check correlation between model parameters\n",
    "# As expected in this simple case,\n",
    "# spatial parameters are uncorrelated,\n",
    "# but the spectral model amplitude and index are correlated as always\n",
    "fit.minuit.print_matrix()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'fit' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-23-2ee549cc799b>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;31m# You can use likelihood profiles to check if your model is\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;31m# well constrained or not, and if the fit really converged\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0mfit\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mminuit\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdraw_profile\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"par_002_sigma\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m;\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m: name 'fit' is not defined"
     ]
    }
   ],
   "source": [
    "# You can use likelihood profiles to check if your model is\n",
    "# well constrained or not, and if the fit really converged\n",
    "fit.minuit.draw_profile(\"par_002_sigma\");"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
