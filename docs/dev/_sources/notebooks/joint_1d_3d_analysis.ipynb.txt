{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/joint_1d_3d_analysis.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[joint_1d_3d_analysis.ipynb](../_static/notebooks/joint_1d_3d_analysis.ipynb) |\n",
    "[joint_1d_3d_analysis.py](../_static/notebooks/joint_1d_3d_analysis.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Joint Crab analysis with 1D and 3D datasets\n",
    "\n",
    "**TODO: move references on how to create the datasets at the beginning. Change title and scope to discuss joint modeling and fitting of the Crab nebula.\n",
    "Discuss at the beginning the 2 types of datasets to be used. Explain better\n",
    "what the Fermi model is.**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This tutorial illustrates how to run a joint analysis with different datasets.\n",
    "We look at the gamma-ray emission from the Crab nebula between 10 GeV and 100 TeV.\n",
    "The spectral parameters are optimized by combining a 3D analysis of Fermi-LAT data, a ON/OFF spectral analysis of HESS data, and flux points from HAWC.  \n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import numpy as np\n",
    "from astropy import units as u\n",
    "import matplotlib.pyplot as plt\n",
    "from gammapy.modeling import Fit, Datasets\n",
    "from gammapy.spectrum import (\n",
    "    FluxPoints,\n",
    "    FluxPointsEstimator,\n",
    "    FluxPointsDataset,\n",
    "    SpectrumDatasetOnOff,\n",
    ")\n",
    "from pathlib import Path"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data and models files\n",
    "\n",
    "We are going to use pre-made datasets. Links toward other tutorials detailing on how to prepare datasets are given at the end.\n",
    "The datasets serialization produce YAML files listing the datasets and models. In the following cells we show an example containning only the Fermi-LAT dataset and the Crab model.\n",
    "\n",
    "Fermi-LAT-3FHL_datasets.yaml:"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "datasets:\n",
    "- name: Fermi-LAT\n",
    "  type: MapDataset\n",
    "  likelihood: cash\n",
    "  models:\n",
    "- Crab Nebula\n",
    "  background: background\n",
    "  filename: $GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL_data_Fermi-LAT.fits"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Fermi-LAT-3FHL_models.yaml:"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "components:\n",
    "- name: Crab Nebula\n",
    "  type: SkyModel\n",
    "  spatial:\n",
    "    type: PointSpatialModel\n",
    "    frame: icrs\n",
    "    parameters:\n",
    "    - name: lon_0\n",
    "      value: 83.63310241699219\n",
    "      unit: deg\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: true\n",
    "    - name: lat_0\n",
    "      value: 22.019899368286133\n",
    "      unit: deg\n",
    "      min: -90.0\n",
    "      max: 90.0\n",
    "      frozen: true\n",
    "  spectral:\n",
    "    type: LogParabolaSpectralModel\n",
    "    parameters:\n",
    "    - name: amplitude\n",
    "      value: 0.3415498620816483\n",
    "      unit: cm-2 s-1 TeV-1\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "    - name: reference\n",
    "      value: 5.054833602905273e-05\n",
    "      unit: TeV\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: true\n",
    "    - name: alpha\n",
    "      value: 2.510798031388936\n",
    "      unit: ''\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "    - name: beta\n",
    "      value: -0.022476498188855533\n",
    "      unit: ''\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "- name: background\n",
    "  type: BackgroundModel\n",
    "  parameters:\n",
    "  - name: norm\n",
    "    value: 0.9544383244743555\n",
    "    unit: ''\n",
    "    min: 0.0\n",
    "    max: .nan\n",
    "    frozen: false\n",
    "  - name: tilt\n",
    "    value: 0.0\n",
    "    unit: ''\n",
    "    min: .nan\n",
    "    max: .nan\n",
    "    frozen: true\n",
    "  - name: reference\n",
    "    value: 1.0\n",
    "    unit: TeV\n",
    "    min: .nan\n",
    "    max: .nan\n",
    "    frozen: true\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Reading  different datasets\n",
    "\n",
    "\n",
    "### Fermi-LAT 3FHL: map dataset for 3D analysis\n",
    "For now we let's use the datasets serialization only to read the 3D `MapDataset` associated to Fermi-LAT 3FHL data and models."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "path = \"$GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL\"\n",
    "filedata = Path(path + \"_datasets.yaml\")\n",
    "filemodel = Path(path + \"_models.yaml\")\n",
    "datasets = Datasets.from_yaml(filedata=filedata, filemodel=filemodel)\n",
    "dataset_fermi = datasets[0]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We get the Crab spectral model in order to share it with the other datasets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value    error      unit      min max frozen\n",
      "--------- ---------- ----- -------------- --- --- ------\n",
      "amplitude  3.415e-01   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "reference  5.055e-05   nan            TeV nan nan   True\n",
      "    alpha  2.511e+00   nan                nan nan  False\n",
      "     beta -2.248e-02   nan                nan nan  False\n"
     ]
    }
   ],
   "source": [
    "crab_spec = [\n",
    "    model.spectral_model\n",
    "    for model in dataset_fermi.model\n",
    "    if model.name == \"Crab Nebula\"\n",
    "][0]\n",
    "\n",
    "print(crab_spec)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HESS-DL3: 1D ON/OFF dataset for spectral fitting\n",
    "\n",
    "The ON/OFF datasets can be read from PHA files following the [OGIP standards](https://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/node5.html).\n",
    "We read the PHA files from each observation, and compute a stacked dataset for simplicity.\n",
    "Then the Crab spectral model previously defined is added to the dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "obs_ids = [23523, 23526]\n",
    "datasets = []\n",
    "for obs_id in obs_ids:\n",
    "    dataset = SpectrumDatasetOnOff.from_ogip_files(\n",
    "        f\"$GAMMAPY_DATA/joint-crab/spectra/hess/pha_obs{obs_id}.fits\"\n",
    "    )\n",
    "    datasets.append(dataset)\n",
    "dataset_hess = Datasets(datasets).stack_reduce()\n",
    "dataset_hess.name = \"HESS\"\n",
    "dataset_hess.model = crab_spec"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HAWC: 1D dataset for flux point fitting\n",
    "\n",
    "The HAWC flux point are taken from https://arxiv.org/pdf/1905.12518.pdf. Then these flux points are read from a pre-made FITS file and passed to a `FluxPointsDataset` together with the source spectral model.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "# read flux points from https://arxiv.org/pdf/1905.12518.pdf\n",
    "filename = \"$GAMMAPY_DATA/hawc_crab/HAWC19_flux_points.fits\"\n",
    "flux_points_hawc = FluxPoints.read(filename)\n",
    "dataset_hawc = FluxPointsDataset(crab_spec, flux_points_hawc, name=\"HAWC\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Datasets serialization\n",
    "\n",
    "The `datasets` object contains each dataset previously defined. \n",
    "It can be saved on disk as datasets.yaml, models.yaml, and several data files specific to each dataset. Then the `datasets` can be rebuild later from these files."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "datasets = Datasets([dataset_fermi, dataset_hess, dataset_hawc])\n",
    "path = Path(\"crab-3datasets\")\n",
    "# datasets.to_yaml(path=path, prefix=\"crab_10GeV_100TeV\", overwrite=True)\n",
    "path.mkdir(exist_ok=True)\n",
    "filedata = path / \"crab_10GeV_100TeV_datasets.yaml\"\n",
    "filemodel = path / \"crab_10GeV_100TeV_models.yaml\"\n",
    "# datasets.from_yaml(filedata=filedata, filemodel=filemodel)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Joint analysis\n",
    "\n",
    "We run the fit on the `Datasets` object that include a dataset for each instrument\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : minuit\n",
      "\tsuccess    : True\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\tnfev       : 783\n",
      "\ttotal stat : -14820.65\n",
      "\n",
      "   name     value     error        unit         min        max    frozen\n",
      "--------- --------- --------- -------------- ---------- --------- ------\n",
      "    lon_0 8.363e+01 0.000e+00            deg        nan       nan   True\n",
      "    lat_0 2.202e+01 0.000e+00            deg -9.000e+01 9.000e+01   True\n",
      "amplitude 3.721e-03 6.119e-04 cm-2 s-1 TeV-1        nan       nan  False\n",
      "reference 5.055e-05 0.000e+00            TeV        nan       nan   True\n",
      "    alpha 1.246e+00 3.784e-02                       nan       nan  False\n",
      "     beta 6.247e-02 2.092e-03                       nan       nan  False\n",
      "     norm 9.825e-01 2.822e-01                 0.000e+00       nan  False\n",
      "     tilt 0.000e+00 0.000e+00                       nan       nan   True\n",
      "reference 1.000e+00 0.000e+00            TeV        nan       nan   True\n",
      "CPU times: user 9.88 s, sys: 82.7 ms, total: 9.96 s\n",
      "Wall time: 9.99 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "fit_joint = Fit(datasets)\n",
    "results_joint = fit_joint.run()\n",
    "print(results_joint)\n",
    "print(results_joint.parameters.to_table())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's display only the parameters of the Crab spectral model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value     error        unit      min max frozen\n",
      "--------- --------- --------- -------------- --- --- ------\n",
      "amplitude 3.721e-03 6.119e-04 cm-2 s-1 TeV-1 nan nan  False\n",
      "reference 5.055e-05 0.000e+00            TeV nan nan   True\n",
      "    alpha 1.246e+00 3.784e-02                nan nan  False\n",
      "     beta 6.247e-02 2.092e-03                nan nan  False\n"
     ]
    }
   ],
   "source": [
    "crab_spec.parameters.covariance = results_joint.parameters.get_subcovariance(\n",
    "    crab_spec.parameters\n",
    ")\n",
    "print(crab_spec)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can compute flux points for Fermi-LAT and HESS datasets in order plot them together with the HAWC flux point."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "# compute Fermi-LAT and HESS flux points\n",
    "e_min, e_max = 0.01, 2.0\n",
    "El_fermi = np.logspace(np.log10(e_min), np.log10(e_max), 6) * u.TeV\n",
    "flux_points_fermi = FluxPointsEstimator(\n",
    "    datasets=[dataset_fermi], e_edges=El_fermi, source=\"Crab Nebula\"\n",
    ").run()\n",
    "\n",
    "e_min, e_max = 1.0, 15.0\n",
    "El_hess = np.logspace(np.log10(e_min), np.log10(e_max), 6) * u.TeV\n",
    "flux_points_hess = FluxPointsEstimator(\n",
    "    datasets=[dataset_hess], e_edges=El_hess\n",
    ").run()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, Let's plot the Crab spectrum fitted and the flux points of each instrument.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# display spectrum and flux points\n",
    "energy_range = [0.01, 120] * u.TeV\n",
    "plt.figure(figsize=(8, 6))\n",
    "ax = crab_spec.plot(energy_range=energy_range, energy_power=2, label=\"Model\")\n",
    "crab_spec.plot_error(ax=ax, energy_range=energy_range, energy_power=2)\n",
    "flux_points_fermi.plot(ax=ax, energy_power=2, label=\"Fermi-LAT\")\n",
    "flux_points_hess.plot(ax=ax, energy_power=2, label=\"HESS\")\n",
    "flux_points_hawc.plot(ax=ax, energy_power=2, label=\"HAWC\")\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## To go further\n",
    "\n",
    "More details on how to prepare datasets with the high and low level interfaces are available in these tutorials: \n",
    "- https://docs.gammapy.org/0.14/notebooks/fermi_lat.html\n",
    "- https://docs.gammapy.org/dev/notebooks/hess.html\n",
    "- https://docs.gammapy.org/dev/notebooks/spectrum_analysis.html\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
