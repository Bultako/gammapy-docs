{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/joint_1d_3d_analysis.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[joint_1d_3d_analysis.ipynb](../_static/notebooks/joint_1d_3d_analysis.ipynb) |\n",
    "[joint_1d_3d_analysis.py](../_static/notebooks/joint_1d_3d_analysis.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Joint Crab analysis with 1D and 3D datasets\n",
    "\n",
    "**TODO: move references on how to create the datasets at the beginning. Change title and scope to discuss joint modeling and fitting of the Crab nebula.\n",
    "Discuss at the beginning the 2 types of datasets to be used. Explain better\n",
    "what the Fermi model is.**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This tutorial illustrates how to run a joint analysis with different datasets.\n",
    "We look at the gamma-ray emission from the Crab nebula between 10 GeV and 100 TeV.\n",
    "The spectral parameters are optimized by combining a 3D analysis of Fermi-LAT data, a ON/OFF spectral analysis of HESS data, and flux points from HAWC.  \n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import numpy as np\n",
    "from astropy import units as u\n",
    "import matplotlib.pyplot as plt\n",
    "from gammapy.modeling import Fit, Datasets\n",
    "from gammapy.spectrum import (\n",
    "    FluxPoints,\n",
    "    FluxPointsEstimator,\n",
    "    FluxPointsDataset,\n",
    "    SpectrumDatasetOnOff,\n",
    ")\n",
    "from pathlib import Path"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data and models files\n",
    "\n",
    "We are going to use pre-made datasets. Links toward other tutorials detailing on how to prepare datasets are given at the end.\n",
    "The datasets serialization produce YAML files listing the datasets and models. In the following cells we show an example containning only the Fermi-LAT dataset and the Crab model.\n",
    "\n",
    "Fermi-LAT-3FHL_datasets.yaml:\n",
    "\n",
    "```yaml\n",
    "datasets:\n",
    "- name: Fermi-LAT\n",
    "  type: MapDataset\n",
    "  likelihood: cash\n",
    "  models:\n",
    "- Crab Nebula\n",
    "  background: background\n",
    "  filename: $GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL_data_Fermi-LAT.fits\n",
    "```\n",
    "\n",
    "Fermi-LAT-3FHL_models.yaml:\n",
    "\n",
    "```yaml\n",
    "components:\n",
    "- name: Crab Nebula\n",
    "  type: SkyModel\n",
    "  spatial:\n",
    "    type: PointSpatialModel\n",
    "    frame: icrs\n",
    "    parameters:\n",
    "    - name: lon_0\n",
    "      value: 83.63310241699219\n",
    "      unit: deg\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: true\n",
    "    - name: lat_0\n",
    "      value: 22.019899368286133\n",
    "      unit: deg\n",
    "      min: -90.0\n",
    "      max: 90.0\n",
    "      frozen: true\n",
    "  spectral:\n",
    "    type: LogParabolaSpectralModel\n",
    "    parameters:\n",
    "    - name: amplitude\n",
    "      value: 0.3415498620816483\n",
    "      unit: cm-2 s-1 TeV-1\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "    - name: reference\n",
    "      value: 5.054833602905273e-05\n",
    "      unit: TeV\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: true\n",
    "    - name: alpha\n",
    "      value: 2.510798031388936\n",
    "      unit: ''\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "    - name: beta\n",
    "      value: -0.022476498188855533\n",
    "      unit: ''\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "- name: background\n",
    "  type: BackgroundModel\n",
    "  parameters:\n",
    "  - name: norm\n",
    "    value: 0.9544383244743555\n",
    "    unit: ''\n",
    "    min: 0.0\n",
    "    max: .nan\n",
    "    frozen: false\n",
    "  - name: tilt\n",
    "    value: 0.0\n",
    "    unit: ''\n",
    "    min: .nan\n",
    "    max: .nan\n",
    "    frozen: true\n",
    "  - name: reference\n",
    "    value: 1.0\n",
    "    unit: TeV\n",
    "    min: .nan\n",
    "    max: .nan\n",
    "    frozen: true\n",
    "\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Reading  different datasets\n",
    "\n",
    "\n",
    "### Fermi-LAT 3FHL: map dataset for 3D analysis\n",
    "For now we let's use the datasets serialization only to read the 3D `MapDataset` associated to Fermi-LAT 3FHL data and models."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "path = \"$GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL\"\n",
    "filedata = Path(path + \"_datasets.yaml\")\n",
    "filemodel = Path(path + \"_models.yaml\")\n",
    "datasets = Datasets.from_yaml(filedata=filedata, filemodel=filemodel)\n",
    "dataset_fermi = datasets[0]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We get the Crab model in order to share it with the other datasets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value    error      unit      min max frozen\n",
      "--------- ---------- ----- -------------- --- --- ------\n",
      "amplitude  3.415e-01   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "reference  5.055e-05   nan            TeV nan nan   True\n",
      "    alpha  2.511e+00   nan                nan nan  False\n",
      "     beta -2.248e-02   nan                nan nan  False\n"
     ]
    }
   ],
   "source": [
    "crab_model = [\n",
    "    model for model in dataset_fermi.model if model.name == \"Crab Nebula\"\n",
    "][0]\n",
    "crab_spec = crab_model.spectral_model\n",
    "print(crab_spec)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HESS-DL3: 1D ON/OFF dataset for spectral fitting\n",
    "\n",
    "The ON/OFF datasets can be read from PHA files following the [OGIP standards](https://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/node5.html).\n",
    "We read the PHA files from each observation, and compute a stacked dataset for simplicity.\n",
    "Then the Crab spectral model previously defined is added to the dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "obs_ids = [23523, 23526]\n",
    "datasets = []\n",
    "for obs_id in obs_ids:\n",
    "    dataset = SpectrumDatasetOnOff.from_ogip_files(\n",
    "        f\"$GAMMAPY_DATA/joint-crab/spectra/hess/pha_obs{obs_id}.fits\"\n",
    "    )\n",
    "    datasets.append(dataset)\n",
    "dataset_hess = Datasets(datasets).stack_reduce()\n",
    "dataset_hess.name = \"HESS\"\n",
    "dataset_hess.model = crab_model"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HAWC: 1D dataset for flux point fitting\n",
    "\n",
    "The HAWC flux point are taken from https://arxiv.org/pdf/1905.12518.pdf. Then these flux points are read from a pre-made FITS file and passed to a `FluxPointsDataset` together with the source spectral model.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "# read flux points from https://arxiv.org/pdf/1905.12518.pdf\n",
    "filename = \"$GAMMAPY_DATA/hawc_crab/HAWC19_flux_points.fits\"\n",
    "flux_points_hawc = FluxPoints.read(filename)\n",
    "dataset_hawc = FluxPointsDataset(crab_model, flux_points_hawc, name=\"HAWC\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Datasets serialization\n",
    "\n",
    "The `datasets` object contains each dataset previously defined. \n",
    "It can be saved on disk as datasets.yaml, models.yaml, and several data files specific to each dataset. Then the `datasets` can be rebuild later from these files."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "datasets = Datasets([dataset_fermi, dataset_hess, dataset_hawc])\n",
    "path = Path(\"crab-3datasets\")\n",
    "path.mkdir(exist_ok=True)\n",
    "\n",
    "datasets.to_yaml(path=path, prefix=\"crab_10GeV_100TeV\", overwrite=True)\n",
    "filedata = path / \"crab_10GeV_100TeV_datasets.yaml\"\n",
    "filemodel = path / \"crab_10GeV_100TeV_models.yaml\"\n",
    "datasets = Datasets.from_yaml(filedata=filedata, filemodel=filemodel)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Joint analysis\n",
    "\n",
    "We run the fit on the `Datasets` object that include a dataset for each instrument\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : minuit\n",
      "\tsuccess    : True\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\tnfev       : 866\n",
      "\ttotal stat : -14820.65\n",
      "\n",
      "   name     value     error        unit         min        max    frozen\n",
      "--------- --------- --------- -------------- ---------- --------- ------\n",
      "    lon_0 8.363e+01 0.000e+00            deg        nan       nan   True\n",
      "    lat_0 2.202e+01 0.000e+00            deg -9.000e+01 9.000e+01   True\n",
      "amplitude 3.721e-03 6.347e-04 cm-2 s-1 TeV-1        nan       nan  False\n",
      "reference 5.055e-05 0.000e+00            TeV        nan       nan   True\n",
      "    alpha 1.246e+00 3.935e-02                       nan       nan  False\n",
      "     beta 6.247e-02 2.178e-03                       nan       nan  False\n",
      "     norm 9.826e-01 3.029e-01                 0.000e+00       nan  False\n",
      "     tilt 0.000e+00 0.000e+00                       nan       nan   True\n",
      "reference 1.000e+00 0.000e+00            TeV        nan       nan   True\n",
      "CPU times: user 11.4 s, sys: 89.7 ms, total: 11.5 s\n",
      "Wall time: 11.5 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "fit_joint = Fit(datasets)\n",
    "results_joint = fit_joint.run()\n",
    "print(results_joint)\n",
    "print(results_joint.parameters.to_table())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's display only the parameters of the Crab spectral model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value     error        unit      min max frozen\n",
      "--------- --------- --------- -------------- --- --- ------\n",
      "amplitude 3.721e-03 6.347e-04 cm-2 s-1 TeV-1 nan nan  False\n",
      "reference 5.055e-05 0.000e+00            TeV nan nan   True\n",
      "    alpha 1.246e+00 3.935e-02                nan nan  False\n",
      "     beta 6.247e-02 2.178e-03                nan nan  False\n"
     ]
    }
   ],
   "source": [
    "crab_spec = datasets[0].model[\"Crab Nebula\"].spectral_model\n",
    "crab_spec.parameters.covariance = results_joint.parameters.get_subcovariance(\n",
    "    crab_spec.parameters\n",
    ")\n",
    "print(crab_spec)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can compute flux points for Fermi-LAT and HESS datasets in order plot them together with the HAWC flux point."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "# compute Fermi-LAT and HESS flux points\n",
    "e_min, e_max = 0.01, 2.0\n",
    "El_fermi = np.logspace(np.log10(e_min), np.log10(e_max), 6) * u.TeV\n",
    "flux_points_fermi = FluxPointsEstimator(\n",
    "    datasets=[dataset_fermi], e_edges=El_fermi, source=\"Crab Nebula\"\n",
    ").run()\n",
    "\n",
    "e_min, e_max = 1.0, 15.0\n",
    "El_hess = np.logspace(np.log10(e_min), np.log10(e_max), 6) * u.TeV\n",
    "flux_points_hess = FluxPointsEstimator(\n",
    "    datasets=[dataset_hess], e_edges=El_hess\n",
    ").run()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, Let's plot the Crab spectrum fitted and the flux points of each instrument.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# display spectrum and flux points\n",
    "energy_range = [0.01, 120] * u.TeV\n",
    "plt.figure(figsize=(8, 6))\n",
    "ax = crab_spec.plot(energy_range=energy_range, energy_power=2, label=\"Model\")\n",
    "crab_spec.plot_error(ax=ax, energy_range=energy_range, energy_power=2)\n",
    "flux_points_fermi.plot(ax=ax, energy_power=2, label=\"Fermi-LAT\")\n",
    "flux_points_hess.plot(ax=ax, energy_power=2, label=\"HESS\")\n",
    "flux_points_hawc.plot(ax=ax, energy_power=2, label=\"HAWC\")\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## To go further\n",
    "\n",
    "More details on how to prepare datasets with the high and low level interfaces are available in these tutorials: \n",
    "- https://docs.gammapy.org/0.14/notebooks/fermi_lat.html\n",
    "- https://docs.gammapy.org/dev/notebooks/hess.html\n",
    "- https://docs.gammapy.org/dev/notebooks/spectrum_analysis.html\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
