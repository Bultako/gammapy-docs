{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy/master?urlpath=lab/tree/background_model.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[background_model.ipynb](../_static/notebooks/background_model.ipynb) |\n",
    "[background_model.py](../_static/notebooks/background_model.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Make template background model\n",
    "\n",
    "## Introduction \n",
    "\n",
    "In this tutorial, we will create a template background model from scratch. Often, background models are pre-computed and provided for analysis, but it's educational to see how the sausage is made.\n",
    "\n",
    "We will use the \"off observations\", i.e. those without significant gamma-ray emission sources in the field of view from the [H.E.S.S. first public test data release](https://www.mpi-hd.mpg.de/hfm/HESS/pages/dl3-dr1/). This model could then be used in the analysis of sources from that dataset (not done here).\n",
    "\n",
    "We will make a background model that is radially symmetric in the field of view, i.e. only depends on field of view offset angle and energy. At the end, we will save the model in the `BKG_2D` as defined in the [spec](https://gamma-astro-data-formats.readthedocs.io/en/latest/irfs/full_enclosure/bkg/index.html).\n",
    "\n",
    "Note that this is just a quick and dirty example. Actual background model production is done with more sophistication usually using 100s or 1000s of off runs, e.g. concerning non-radial symmetries, binning and smoothing of the distributions, and treating other dependencies such as zenith angle, telescope configuration or optical efficiency. Another aspect not shown here is how to use AGN observations to make background models, by cutting out the part of the field of view that contains gamma-rays from the AGN.\n",
    "\n",
    "We will mainly be using the following classes:\n",
    "        \n",
    "* [gammapy.data.DataStore](..\/api/gammapy.data.DataStore.rst) to load the runs to use to build the bkg model.\n",
    "* [gammapy.irf.Background2D](..\/api/gammapy.irf.Background2D.rst) to represent and write the background model."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setup\n",
    "\n",
    "As always, we start the notebook with some setup and imports."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib.colors import LogNorm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "from copy import deepcopy\n",
    "import numpy as np\n",
    "import astropy.units as u\n",
    "from astropy.io import fits\n",
    "from astropy.table import Table, vstack"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pathlib import Path\n",
    "from gammapy.utils.nddata import sqrt_space\n",
    "from gammapy.data import DataStore\n",
    "from gammapy.irf import Background2D"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Select off data\n",
    "\n",
    "We start by selecting the observations used to estimate the background model.\n",
    "\n",
    "In this case, we just take all \"off runs\" as defined in the observation table."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of observations: 45\n"
     ]
    }
   ],
   "source": [
    "data_store = DataStore.from_dir(\"$GAMMAPY_DATA/hess-dl3-dr1\")\n",
    "# Select just the off data runs\n",
    "obs_table = data_store.obs_table\n",
    "obs_table = obs_table[obs_table[\"TARGET_NAME\"] == \"Off data\"]\n",
    "observations = data_store.get_observations(obs_table[\"OBS_ID\"])\n",
    "print(\"Number of observations:\", len(observations))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Background model\n",
    "\n",
    "The background model we will estimate is a differential background rate model in unit `s-1 MeV-1 sr-1` as a function of reconstructed energy and field of fiew offset.\n",
    "\n",
    "We estimate it by histogramming off data events and then smoothing a bit (not using a good method) to get a less noisy estimate. To get the differential rate, we divide by observation time and also take bin sizes into account to get the rate per energy and solid angle. So overall we fill two arrays called `counts` and `exposure` with `exposure` filled so that `background_rate = counts / exposure` will give the final background rate we're interested in.\n",
    "\n",
    "The processing can be done either one observation at a time, or first for counts and then for exposure. Either way is fine. Here we do one observation at a time, starting with empty histograms and then accumulating counts and exposure. Since this is a multi-step algorithm, we put the code to do this computation in a `BackgroundModelEstimator` class.\n",
    "\n",
    "This functionality was already in Gammapy previously, and will be added back again soon, after `gammapy.irf` has been restructured and improved."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "class BackgroundModelEstimator:\n",
    "    def __init__(self, ebounds, offset):\n",
    "        self.counts = self._make_bkg2d(ebounds, offset, unit=\"\")\n",
    "        self.exposure = self._make_bkg2d(ebounds, offset, unit=\"s MeV sr\")\n",
    "\n",
    "    @staticmethod\n",
    "    def _make_bkg2d(ebounds, offset, unit):\n",
    "        ebounds = ebounds.to(\"MeV\")\n",
    "        offset = offset.to(\"deg\")\n",
    "        shape = len(ebounds) - 1, len(offset) - 1\n",
    "        return Background2D(\n",
    "            energy_lo=ebounds[:-1],\n",
    "            energy_hi=ebounds[1:],\n",
    "            offset_lo=offset[:-1],\n",
    "            offset_hi=offset[1:],\n",
    "            data=np.zeros(shape) * u.Unit(unit),\n",
    "        )\n",
    "\n",
    "    def run(self, observations):\n",
    "        for obs in observations:\n",
    "            self.fill_counts(obs)\n",
    "            self.fill_exposure(obs)\n",
    "\n",
    "    def fill_counts(self, obs):\n",
    "        events = obs.events\n",
    "        data = self.counts.data\n",
    "        counts = np.histogram2d(\n",
    "            x=events.energy.to(\"MeV\"),\n",
    "            y=events.offset.to(\"deg\"),\n",
    "            bins=(data.axes[0].bins, data.axes[1].bins),\n",
    "        )[0]\n",
    "        data.data += counts\n",
    "\n",
    "    def fill_exposure(self, obs):\n",
    "        data = self.exposure.data\n",
    "        energy_width = data.axes[0].bin_width\n",
    "        offset = data.axes[1].nodes\n",
    "        offset_width = data.axes[1].bin_width\n",
    "        solid_angle = 2 * np.pi * offset * offset_width\n",
    "        time = obs.observation_time_duration\n",
    "        exposure = time * energy_width[:, None] * solid_angle[None, :]\n",
    "        data.data += exposure\n",
    "\n",
    "    @property\n",
    "    def background_rate(self):\n",
    "        rate = deepcopy(self.counts)\n",
    "        rate.data.data /= self.exposure.data.data\n",
    "        return rate\n",
    "\n",
    "\n",
    "def background2d_peek(bkg):\n",
    "    data = bkg.data\n",
    "    x = data.axes[0].bins\n",
    "    y = data.axes[1].bins\n",
    "    c = data.data.T.value\n",
    "    plt.pcolormesh(x, y, c, norm=LogNorm())\n",
    "    plt.semilogx()\n",
    "    plt.colorbar()\n",
    "    plt.xlabel(\"Energy (TeV)\")\n",
    "    plt.ylabel(\"Offset (deg)\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 2.1 s, sys: 92.2 ms, total: 2.19 s\n",
      "Wall time: 2.24 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "ebounds = np.logspace(-1, 2, 20) * u.TeV\n",
    "offset = sqrt_space(start=0, stop=3, num=10) * u.deg\n",
    "estimator = BackgroundModelEstimator(ebounds, offset)\n",
    "estimator.run(observations)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's have a quick look at what we did ..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "background2d_peek(estimator.background_rate)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "# You could save the background model to a file like this\n",
    "# estimator.background_rate.to_fits().writeto('background_model.fits', overwrite=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Zenith dependence\n",
    "\n",
    "The background models used in H.E.S.S. usually depend on the zenith angle of the observation. That kinda makes sense because the energy threshold increases with zenith angle, and since the background is related to (but not given by) the charged cosmic ray spectrum that is a power-law and falls steeply, we also expect the background rate to change.\n",
    "\n",
    "Let's have a look at the dependence we get for this configuration used here (Hillas reconstruction, standard cuts, see H.E.S.S. release notes for more information)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYUAAAEKCAYAAAD9xUlFAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvnQurowAAHcdJREFUeJzt3X2UXXV97/H3x2G4TEAZhGjNQEysIQoNEJ2Kq9AWUAmISAziMiJV1KasKyreOpK0+AQq9EZ65VaUi4oPVaEqcQREI4IUK2JJCBgQYlk8ZkJNEAcERphMvvePvefk5OQ87JmcPeecPZ/XWrMy++Hs/d3Jynxn/x6+P0UEZmZmAM9pdQBmZtY+nBTMzKzEScHMzEqcFMzMrMRJwczMSpwUzMysxEnBzMxKnBTMzKzEScHMzEp2a3UAE7XffvvFnDlzWh2GmVlHWbt27aMRMbPReR2XFObMmcOaNWtaHYaZWUeR9GCW89x8ZGZmJU4KZmZW4qRgZmYlTgpmZlbipGBmZiUdN/rIzGy6GVw3xMrVG9g0PMKs3h4GFs1n8cK+XO7lpGBm1sYG1w2xYtV6RkbHABgaHmHFqvUAuSQGNx+ZmbWxlas3lBLCuJHRMVau3pDL/ZwUzMza2KbhkQnt31VOCmZmbWxWb8+E9u8qJwUzszY2sGg+Pd1dO+zr6e5iYNH8XO7njmYzszY23pns0UdmZgYkiSGvJFDJzUdmZlbipGBmZiVOCmZmVuKkYGZmJU4KZmZW4qRgZmYlTgpmZlbipGBmZiVOCmZmVuKkYGZmJU4KZmZW4qRgZmYlTgpmZlaSW1KQdJmkzZLurHH8VEm/Sr9ulnRoXrGYmVk2eb4pfBU4rs7x+4G/johDgPOAS3OMxczMMshtPYWIuEnSnDrHby7bvAXYP69YzMwsm3bpU3g38MNWB2FmNt21fOU1SUeTJIUj65yzDFgGMHv27CmKzMxs+mnpm4KkQ4AvASdFxO9qnRcRl0ZEf0T0z5w5c+oCNDObZlqWFCTNBlYBp0XEb1oVh5mZbZdb85Gky4GjgP0kbQQ+BnQDRMQlwEeBfYHPSwLYGhH9ecVjZmaN5Tn6aGmD4+8B3pPX/c3MbOLaZfSRmZm1AScFMzMrafmQVDMz29nguiFWrt7ApuERZvX2MLBoPosX9uV+XycFM7M2M7huiBWr1jMyOgbA0PAIK1atB8g9Mbj5yMyszaxcvaGUEMaNjI6xcvWG3O/tpGBm1mY2DY9MaH8zOSmYmbWZWb09E9rfTE4KZmZtZmDRfHq6u3bY19PdxcCi+bnf2x3NZmZtZrwz2aOPzMwMSBLDVCSBSm4+MjOzEicFMzMrcVIwM7MSJwUzMytxUjAzsxInBTMzK6k7JFXS7sDrgb8EZgEjwJ3AtRFxT/7hmZkVR6sqn05EzaQg6RzgZOAmYC1wHbAHcCDwf5SsofmhiLhzKgI1M+tkrax8OhH13hTWR8Qnaxz735JeBByQQ0xmZoVTr/JppyQFSeqOiNFqByPiEeCRfMIyMyuWVlY+nYh6Hc3vBjZKukzS6yS5U9rMbJJaWfl0Imr+oI+IE4H5wM+BDwMPS/oXSX8xVcGZmRVFKyufTkTd3/4jYjgivhwRrwMWAvcAl0i6f0qiMzMriMUL+zh/yQL6ensQ0Nfbw/lLFrRVfwJkrJIqaW/gBOAkYF/ge3kGZWZWRK2qfDoR9YakziBJAkuBw4EfAJ8BfhIR26YmPDMzm0r13hQeAq4HvgK8OSKenZqQzMysVeolhTkR8SQkM5slvTQi7p2iuMzMrAXqjT4aTwgnAOtJZjQj6TBJ7lMwMyugLHMPziXpUxgGiIjbgZfmGZSZmbVGltFHoxExnJQ6KolGH5J0GfAGYHNE/FmV4wIuIim49zTwzoi4LVPUZmZtqrLo3dEvm8lP79nS1kXwymV5U7hb0luA50iaK+mzwC0ZPvdV4Lg6x48H5qVfy4AvZLimmVnbGi96NzQ8QpAUvfvGLQ/tsL1i1XoG1w21OtSasiSFM4FXAtuAVcAfgbMafSgibgIeq3PKScDXI3EL0JsW2TMz60jVit5VGi+C165qJgVJnwaIiKci4uyIWJh+LY+Ip5tw7z7g4bLtjem+arEsk7RG0potW7Y04dZmZs2XtbhduxXBK1fvTaFe008zqMq+qn0VEXFpRPRHRP/MmTNzDsvMbHKyFrdrtyJ45eolhS5J+0h6frWvJtx7Izuux7A/sKkJ1zUza4lqRe8qtWMRvHL1Rh+9jGTFtVq/0b9kF+99FXCmpCtIhrw+nq7RYGbWkcZHFXXy6KN6SeHXEbFwsheWdDlwFLCfpI3Ax4BugIi4BLiWZDjqvSRDUk+f7L3MzNpFJxS9qydTldTJiIilDY4H8N687m9mZhNXr0/hoimLwszM2kK9pHCEpAXVDkjaU9K7JJ2aU1xmZtYC9ZqPLgY+kiaGO4EtwB4kM5CfB1wGfDP3CM3MbMrUTApp4bu3SNoL6AdeBIwAd0dE+07HMzOzSWvY0ZyW0L4x/1DMzKzVstQ+MjOzacJJwczMSpwUzMyspGafgqSrqbOYTkS8MZeIzMysZep1NH8m/XMJ8CfAN9LtpcADOcZkZmYtUm9I6r8DSDovIv6q7NDVkm7KPTIzM5tyWfoUZkoqVUSVNBfwogZmZgWUpSDeB4EbJd2Xbs8B/i63iMzMrGWyTF77kaR5JOsrANwTEc/kG5aZmbVCvdFHS2oc+lNJRMSqnGIyM7MWqfemcGKdYwE4KZiZFUy90UdeCc3MbJppOPpI0t6S/lnSmvTrQkl7T0VwZmY2tbIMSb0M+APwlvTrCeAreQZlZmatkWVI6p9GxMll25+QdHteAZmZWetkeVMYkXTk+IakI0gW2zEzs4LJ8qZwBvD1tB9BwGPAO/MMyszMWiPL5LU7gEMlPS/dfiL3qMzMrCUaJgVJ/wM4maS8xW6SAIiIc3ONzMzMplyW5qPvA48DawGXtzAzK7AsSWH/iDgu90jMzKzlsiSFmyUtiIj1uUdjZtYGBtcNsXL1BjYNjzCrt4eBRfNZvLCv1WFNiXoF8daT1DjaDTg9LZ39DMkIpIiIQ6YmRDOzqTO4bogVq9YzMjoGwNDwCCtWJb8TT4fEUO9N4Q27enFJxwEXAV3AlyLigorje5Ms8zk7jeUzEeHZ0mbWMitXbyglhHEjo2OsXL1hWiSFmpPXIuLBiHiQ5If1f6ffzwVOIul4rktSF3AxcDxwELBU0kEVp70X+HVEHAocBVwoaffJPIiZWTNsGq4+N7fW/qLJMqP5SmBM0kuBL5Mkhm9l+NyrgHsj4r6IeBa4giShlAvguUrGue5FMjFua9bgzcyabVZvz4T2F02WpLAtIrYCS4DPRsQHgRdl+Fwf8HDZ9sZ0X7nPAS8HNgHrgQ9ExLbKC0laNl6ldcuWLRlubWY2OQOL5tPT3bXDvp7uLgYWzW9RRFMrS1IYlbQU+BvgmnRfd4bPqcq+qNheBNwOzAIOAz43PnN6hw9FXBoR/RHRP3PmzAy3NjObnMUL+zh/yQL6ensQ0Nfbw/lLFkyL/gTINiT1dJL6R5+KiPslzSXpHG5kI3BA2fb+JG8Elde+ICICuFfS/SRrQf9nhuubmeVi8cK+aZMEKjV8U4iIXwNnA7el2/dXjiKq4VZgnqS5aefxW4GrKs55CHgNgKQXAvOB+7KHb2ZmzZRl5bUTSZp4fpRuHyap8of7TtJ+iDOB1cDdwLcj4i5JZ0g6Iz3tPOAv0jkR1wNnR8Sjk3sUMzPbVVmajz5OMpLoRoCIuD1tQmooIq4Frq3Yd0nZ95uAYzPGamZmOcvS0bw1IirnJVR2GJuZWQFkeVO4U9LbgC5J84D3AzfnG5aZmbVCljeF9wEHk9Q9+hbJbOaz8gzKzMxao+6bQlqq4hMRMQD849SEZGZmrVL3TSEixoBXTlEsZmbWYln6FNalQ1C/Azw1vjMiVuUWlZmZtUSWpPB84HfAMWX7AnBSMDMrmIZJISJOn4pAzMys9RomBUkzgb8F5pSfHxHvyi8sMzNrhSzNR98Hfgb8BBhrcK6ZmXWwLElhRkScnXskZmbWclkmr10j6fW5R2JmZi1X801B0h9IRhkJ+AdJzwCj6XZExE6L4ZiZWWermRQi4rlTGYiZmbVelvUUrs+yz8zMOl+95qM9gD2B/STtw/Y1l59HsqaymZkVTL3RR39HUg11FrCW7UnhCeDinOMyM7MWqNencBFwkaT3RcS/TGFMZmYNDa4bYuXqDWwaHmFWbw8Di+azeGFfq8PqeFnKXDghmFlbGVw3xIpV6xkZTebTDg2PsGLVegAnhl2UZZ6CmVlbWbl6QykhjBsZHWPl6g0tiqg4nBTMrONsGh6Z0H7LLsuQ1CslnSDJCcTM2sKs3p4J7bfssvyg/wLwNuC/JF0g6WU5x2RmVtfAovn0dHftsK+nu4uBRfNbFFFxNEwKEfGTiDgVeAXwAHCdpJslnS6pO+8AzcwqLV7Yx/lLFtDX24OAvt4ezl+ywJ3MTZClSiqS9gXeDpwGrAO+CRwJvAM4Kq/gzMxqWbywz0kgB1kW2VkFvAz4V+DEiHgkPfRvktbkGZyZTT+N5h94fkK+srwpfC4ibqh2ICL6mxyPmU1jjeYfeH5C/rJ0NPdKWlLx9RpJL8g9OjObVhrNP/D8hPxlSQrvBr4EnJp+fRH4X8DPJZ1W74OSjpO0QdK9kpbXOOcoSbdLukvSv08wfjMrkEbzDzw/IX9ZksI24OURcXJEnAwcBDwDHA7UXKZTUhdJ4bzj088slXRQxTm9wOeBN0bEwcApk3oKMyuERvMPPD8hf1mSwpyI+G3Z9mbgwIh4jGQltlpeBdwbEfdFxLPAFcBJFee8DVgVEQ8BRMTm7KGbWdE0mn/g+Qn5y9LR/DNJ1wDfSbdPBm6StCcwXOdzfcDDZdsbSd4uyh0IdEu6EXgucFFEfL3yQpKWAcsAZs+enSFkM+tE453FtUYXNTpuu04RUf8EScASknkJAv4DuDIafFDSKcCiiHhPun0a8KqIeF/ZOZ8D+oHXAD3AL4ATIuI3ta7b398fa9Z4JKyZ2URIWptlxGjdN4W0X2B1RLwWuHKCMWwEDijb3h/YVOWcRyPiKeApSTcBhwI1k4KZmeWnbp9CRIwBT0vaexLXvhWYJ2mupN2BtwJXVZzzfeAvJe0maQZJ89Ldk7iXmZk1QZY+hT8C6yVdBzw1vjMi3l/vQxGxVdKZwGqgC7gsIu6SdEZ6/JKIuFvSj4BfkYxy+lJE3DnJZzEzs12UpU/hHdX2R8TXcomoAfcpmJlNXFP6FCD54S+pB5gdEZ42aGZWYFkW2TkRuB34Ubp9mKTKvgEzMyuALJPXPk4yEW0YICJuB+bmGJOZmbVIlo7mrRHxeDJdoaR+R4SZWQWXvO4MWZLCnZLeBnRJmge8H7g537DMrEhc8rpzZGk+eh9wMEkRvMuBJ4Cz8gzKzIrFJa87R5bRR08D/5h+mZlNmEted44sy3EeCHwImFN+fkQck19YZlYks3p7GKqSAFzyuv1k6VP4DnAJyUI7Yw3ONTPbycCi+Tv0KYBLXrerrKOPvpB7JGZWWC553TmyJIWrJf1P4Hsknc0ApIvsmNk0NJnhpYsX9jkJdIAsSWG89tFA2b4AXtL8cMys3Xl4abFlGX3k2ctmVlJveKmTQuerOU9B0ofLvj+l4tin8wzKzNqXh5cWW73Ja28t+35FxbHjcojFzDpArWGkHl5aDPWSgmp8X23bzKaJgUXz6enu2mGfh5cWR70+hajxfbVtM5smPLy02OolhUMlPUHyVtCTfk+6vUfukZlZ2/Lw0uKqmRQioqvWMTMzK6YsVVLNzGyacFIwM7MSJwUzMyvJUubCzAqgvF5R74xuIuDxkVGPHrIdOCmYTQOV9Yp+//Ro6ZhrF1k5Nx+ZTQPV6hWV89KYNs5JwWwayFKXyLWLDJwUzKaFLHWJXLvIwH0KZh1nMgvcVFsOs9xEaxdNJgbrDLm+KUg6TtIGSfdKWl7nvD+XNCbpzXnGY9bpxjuMh4ZHCLZ3Eg+uG6r7ucUL+zh/yQL6ensQsM+Mbnp7uhHQ19vD+UsWZP6hPtkYrDPk9qYgqQu4GHgdsBG4VdJVEfHrKuf9E7A6r1jMimJXFrhpVr0iL7JTbHm+KbwKuDci7ouIZ4ErgJOqnPc+4Epgc46xmBVCOyxw0w4xWH7yTAp9wMNl2xvTfSWS+oA3AZfUu5CkZZLWSFqzZcuWpgdq1inaYYGbdojB8pNnUqi2EE/lOgyfBc6OiNoDqIGIuDQi+iOif+bMmU0L0GxXDK4b4ogLbmDu8h9wxAU3TKpNfXDdEId94sfMWf4D5iz/AQvP/XHd67TDAjftEIPlJ8/RRxuBA8q29wc2VZzTD1whCWA/4PWStkbEYI5xme2yyhnCk5kVPLhuiIHv3MHotu2/K/3+6VEGvntHzeu0wwI37RCD5UcR+SyiJmk34DfAa4Ah4FbgbRFxV43zvwpcExHfrXfd/v7+WLNmTZOjNZuYIy64gaEqbeh9vT38fPkxu3SNiV7HLAtJayOiv9F5ub0pRMRWSWeSjCrqAi6LiLsknZEer9uPYNbOmtHZWu9cd9paq+Q6eS0irgWurdhXNRlExDvzjMWsmWb19lT9LX8ina21rjHR65g1k8tcmE1CMzpbBxbNp/s5O4/H6O6SO22tZVzmwmwSmtHZOn7ux6+6i+GRpJT1PjO6+diJB7vT1lomt47mvLij2cxs4rJ2NLv5yMzMStx8ZIXXzGUozxlczzdveag0C3PP3bv41JuyF5PrFK6COn05KVihNXMZynMG1/ONWx7aYd9Tz47x99+pPdmsEzVjYp51LjcfWaE1cxnKy3/5cNX9Y9uiUEtZ1quCasXnpGCF1sxlKMfqDMoo0mQzV0Gd3tx8ZC1X3n69d083Egw/Xb/Nf3DdUN2hnOPXzDK2rndG905xVLt3l1QzMRRpslkzJuZZ53JSsJaqbL8e/yEPtduyGxWSA+ouPVnpyT9u5ZzB9Vy5dqhuO/rSww/YqU8BoOs5xZpsVm3pTldBnT7cfGQtNZk2/5WrN+yQEMaNjiVt+42uudPntgWX//Lhhu3on1y8gLe/evYONeH33L2LC085tFAdsJVLd050uU7rbH5TsJaaTJt/HoXkajULVV7vk4sX8MnFCyZ1j07SrKU7rfM4KXS4Wu3g4/uHhkdKbeF9bTjevF5RuPJzsn5m/NxG16xUq79gIu3oHttvReDmow423h4/NDxCsL0d/JzB9aX9sP234PHjk1khLC/VCsuVq9aW3aiQXKNrVrvH0sMP2KUCd7X+Ldrp79osCyeFDlZrPHm19vHy4+003ryy/bq3p5t9ZnTXbctevLCPlaccSm9Pd2nfPjO6WfnmQ0vNHpVt4m9/9ezS9j4zuunt2fEen1y8YJfa0T2234rCBfE62NzlP8g05LKSgPsvOKHZ4Uxrtf4t/Hdt7cIF8aaBWu3dXdq5aSXL52zyav2d+u/aOo2TQgertdBLtfbx8uMeb958zVh0x6wdePRRB6u30Ev/i5/fEaOPiqIZi+6YtYNp0acwuG6IT1x9V6lCZm9PNx9/48E7zZKtN7Qz7//o5ffZo/s5PLN1G9siaQpaevgB02Js/FRqxfBRD1m1Vsrap1D4N4XBdUMMfPcORse2J7/hkVEGysod1yoVvObBxxqWPmhWjOX3HxndVjo2FlEqreDE0BytKA3tctTWKQrfp7By9YYdEsK40bJyxxMZ2pnHMMMsZRlqlW22iWvF8FEPWbVOUfikkKUkQq1zspY+2FVZrlevbLNNTCtKQ7sctXWKwieFekMCx49NdGhns4cZZrleo2Gmll0rho96yKp1isInhYFF8+nuqlISoazc8USGduYxzDBLWYalhx/Q1HtOZ60YPuohq9YpCt/RPN6JV2/0UZahnXmOGKm8v0cf5asVw0c9ZNU6xbQYkmpmNt25zIWZmU1YrklB0nGSNki6V9LyKsdPlfSr9OtmSYfmGY+ZmdWXW1KQ1AVcDBwPHAQslXRQxWn3A38dEYcA5wGX5hWPmZk1luebwquAeyPivoh4FrgCOKn8hIi4OSJ+n27eAuyfYzxmZtZAnkmhDyifhrsx3VfLu4EfVjsgaZmkNZLWbNmypYkhmplZuTyHpFabbVV1qJOko0mSwpHVjkfEpaRNS5L+IGm61QbYD3i01UFMsen2zNPtecHPPNVenOWkPJPCRqB8xtX+wKbKkyQdAnwJOD4ifpfhuhuyDKsqEklr/MzFNt2eF/zM7SrP5qNbgXmS5kraHXgrcFX5CZJmA6uA0yLiNznGYmZmGeT2phARWyWdCawGuoDLIuIuSWekxy8BPgrsC3xeSW2fre2eRc3MiizXMhcRcS1wbcW+S8q+fw/wngledjoOW/UzF990e17wM7eljitzYWZm+XGZCzMzK+mopNCobEYRSLpM0mZJd5bte76k6yT9V/rnPq2MsZkkHSDpp5LulnSXpA+k+4v8zHtI+k9Jd6TP/Il0f2GfGZIqB5LWSbom3S768z4gab2k2yWtSfe1/TN3TFLIWDajCL4KHFexbzlwfUTMA65Pt4tiK/D3EfFy4NXAe9N/1yI/8zPAMRFxKHAYcJykV1PsZwb4AHB32XbRnxfg6Ig4rGwATds/c8ckBTKUzSiCiLgJeKxi90nA19LvvwYsntKgchQRj0TEben3fyD5odFHsZ85IuLJdLM7/QoK/MyS9gdOIJmTNK6wz1tH2z9zJyWFiZbNKJIXRsQjkPwQBV7Q4nhyIWkOsBD4JQV/5rQp5XZgM3BdRBT9mT8LfBjYVravyM8LSaL/saS1kpal+9r+mTtp5bXMZTOs80jaC7gSOCsinlDB16SOiDHgMEm9wPck/VmrY8qLpDcAmyNiraSjWh3PFDoiIjZJegFwnaR7Wh1QFp30ppCpbEZB/VbSiwDSPze3OJ6mktRNkhC+GRGr0t2FfuZxETEM3EjSj1TUZz4CeKOkB0iafY+R9A2K+7wARMSm9M/NwPdImsDb/pk7KSk0LJtRYFcB70i/fwfw/RbG0lRKXgm+DNwdEf9cdqjIzzwzfUNAUg/wWuAeCvrMEbEiIvaPiDkk/29viIi3U9DnBZC0p6Tnjn8PHAvcSQc8c0dNXpP0epK2yfGyGZ9qcUhNJ+ly4CiSaoq/BT4GDALfBmYDDwGnRERlZ3RHknQk8DNgPdvbm/+BpF+hqM98CEknYxfJL2bfjohzJe1LQZ95XNp89KGIeEORn1fSS0jeDiBppv9WRHyqE565o5KCmZnlq5Oaj8zMLGdOCmZmVuKkYGZmJU4KZmZW4qRgZmYlTgpWKJLelFalLP/aJun4SV7vXEmvTb8/S9KMsmNP1v7kDtdYLOmjNY5lukaNz35G0jGT/bxZNR6SaoWW1pw5laRa5bZG5ze41gNAf0Q8mm4/GRF7ZfjczcAbxz9XcSzTNWpc98XAFyPi2Ml83qwavylYYUk6kGQd8NPGE4KkAUm3SvpV2ToGc9L1HL6Yrm/w43SmMZK+KunNkt4PzAJ+KumnZff4VLouwi2SXlgjhmfKEslcSb9IYziv4tydYkv3f0TSPWn9/cslfQggIh4E9pX0J839m7PpzEnBCimtp/QtktmzD6X7jgXmkdSgOQx4paS/Sj8yD7g4Ig4GhoGTy68XEf+XpNbW0RFxdLp7T+CWdF2Em4C/rRLKEcBtZdsXAV+IiD8H/rss3qqxSepPY1kILAH62dFt6T3MmqKTqqSaTcR5wF0RcUXZvmPTr3Xp9l4kP4gfAu6PiNvT/WuBORnu8SxwTdlnXlflnBcBW8q2j2B7wvlX4J8axPZc4PsRMQIg6eqK628meYMxawonBSuctL7OycArKg8B50fE/6s4fw7JamjjxoCeDLcaje2dcmNU//80Auxdsa9aR16t2D7YIIY90nuYNYWbj6xQ0jVvvwL8TbqSW7nVwLvStRuQ1JfWus/qDyS/uU/E3cBLy7Z/TlIpFJIO8Eax/QdwopJ1nfciWb2s3IEk1TfNmsJvClY0Z5CsZvWFioV6zo+If5P0cuAX6bEngbeT/JafxaXADyU9Utav0MhNwIWSlL5VfAD4lqQPkKwhAUBE/LhabBFxq6SrgDuAB4E1wONQ6jd5abrPrCk8JNUsZ5IuAq6OiJ9M8vN7RcST6RyJm4BlEXGbpDcBr4iIjzQzXpve3Hxklr9PAzManlXbpUrWc74NuDIixkcz7QZcuKvBmZXzm4KZmZX4TcHMzEqcFMzMrMRJwczMSpwUzMysxEnBzMxKnBTMzKzk/wN6sJLaRWZA7QAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "x = obs_table[\"ZEN_PNT\"]\n",
    "y = obs_table[\"SAFE_ENERGY_LO\"]\n",
    "plt.plot(x, y, \"o\")\n",
    "plt.xlabel(\"Zenith (deg)\")\n",
    "plt.ylabel(\"Energy threshold (TeV)\");"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "x = obs_table[\"ZEN_PNT\"]\n",
    "y = obs_table[\"EVENT_COUNT\"] / obs_table[\"ONTIME\"]\n",
    "plt.plot(x, y, \"o\")\n",
    "plt.xlabel(\"Zenith (deg)\")\n",
    "plt.ylabel(\"Rate (events / sec)\")\n",
    "plt.ylim(0, 10);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The energy threshold increases, as expected. It's a bit surprising that the total background rate doesn't decreases with increasing zenith angle. That's a bit of luck for this configuration, and because we're looking at the rate of background events in the whole field of view. As shown below, the energy threshold increases (reducing the total rate), but the rate at a given energy increases with zenith angle (increasing the total rate). Overall the background does change with zenith angle and that dependency should be taken into account.\n",
    "\n",
    "The remaining scatter you see in the plots above (in energy threshold and rate) is due to dependence on telescope optical efficiency, atmospheric changes from run to run and other effects. If you're interested in this, [2014APh....54...25H](http://adsabs.harvard.edu/abs/2014APh....54...25H) has some infos. We'll not consider this futher.\n",
    "\n",
    "When faced with the question whether and how to model the zenith angle dependence, we're faced with a complex optimisation problem: the closer we require off runs to be in zenith angle, the fewer off runs and thus event statistic we have available, which will lead do noise in the background model. The choice of zenith angle binning or \"on-off observation mathching\" strategy isn't the only thing that needs to be optimised, there's also energy and offset binnings and smoothing scales. And of course good settings will depend on the way you plan to use the background model, i.e. the science measurement you plan to do. Some say background modeling is the hardest part of IACT data analysis.\n",
    "\n",
    "Here we'll just code up something simple: make three background models, one from the off runs with zenith angle 0 to 20 deg, one from 20 to 40 deg, and one from 40 to 90 deg."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "zenith_bins = [\n",
    "    {\"min\": 0, \"max\": 20},\n",
    "    {\"min\": 20, \"max\": 40},\n",
    "    {\"min\": 40, \"max\": 90},\n",
    "]\n",
    "\n",
    "\n",
    "def make_model(observations):\n",
    "    ebounds = np.logspace(-1, 2, 20) * u.TeV\n",
    "    offset = sqrt_space(start=0, stop=3, num=10) * u.deg\n",
    "    estimator = BackgroundModelEstimator(ebounds, offset)\n",
    "    estimator.run(observations)\n",
    "    return estimator.background_rate\n",
    "\n",
    "\n",
    "def make_models():\n",
    "    for zenith in zenith_bins:\n",
    "        mask = zenith[\"min\"] <= obs_table[\"ZEN_PNT\"]\n",
    "        mask &= obs_table[\"ZEN_PNT\"] < zenith[\"max\"]\n",
    "        obs_ids = obs_table[\"OBS_ID\"][mask]\n",
    "        observations = data_store.get_observations(obs_ids)\n",
    "        yield make_model(observations)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 2.15 s, sys: 98.2 ms, total: 2.25 s\n",
      "Wall time: 2.12 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "models = list(make_models())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "background2d_peek(models[0])\n",
    "plt.figure()\n",
    "background2d_peek(models[2])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAY4AAAEOCAYAAACetPCkAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvnQurowAAIABJREFUeJzs3XdY1dUfwPH3ARkO3AMFBwhuBRVQMffChXvvlaMysxzt8dPUyp2VA9yKewSaWmlq7r1zp7h34mB+fn9cM0TBC9wLFziv57nPE9/7ved8vqn3cNbnKBFB0zRN04xlldoBaJqmaWmLbjg0TdO0RNENh6ZpmpYouuHQNE3TEkU3HJqmaVqi6IZD0zRNSxTdcGiapmmJohsOTdM0LVF0w6FpmqYlim44NE3TtETJlNoBmEPevHmlWLFiqR2GpmlamrJ///7bIpLvdfely4ajWLFi7Nu3L7XD0DRNS1OUUn8bc1+aGKpSSrVUSs1USq1RSjVM7Xg0TdMyMrM3HEqpQKXUTaXUsTjX/ZRSfymlziqlRiZUhoisFpF+QE+ggxnD1TRN014jJYaq5gDfA/P+vaCUsgamAQ2AUGCvUmotYA2MifP53iJy89l/f/Lsc5qmaVoqMXvDISJblVLF4lz2Ac6KyHkApVQQ0EJExgDN4pahlFLAWGC9iBwwb8SapiVFZGQkoaGhPH36NLVD0V7D3t4eZ2dnbGxskvT51JocdwIux/o5FKiSwP3vAPWBHEopNxH5Ke4NSqk3gTcBihQpYsJQNU0zRmhoKA4ODhQrVgzD73qaJRIR7ty5Q2hoKC4uLkkqI7Umx1/1tyreowhFZIqIVBaRAa9qNJ7dM0NEvETEK1++164m0zTNxJ4+fUqePHl0o2HhlFLkyZMnWT3D1Go4QoHCsX52Bq4mt1ClVHOl1IwHDx4kt6hUIyIcu/KA6w90d19Le3SjkTYk988ptRqOvYC7UspFKWULdATWplIsqS4mRjhw6R6jQ07wxrjNNJu6nebfb+fcrbDUDk3T0pRffvmFkiVL4ubmxtixY1M7nGS7fPkyderUoXTp0pQtW5bJkyc/f+/u3bs0aNAAd3d3GjRowL1791IsrpRYjrsY2AmUVEqFKqX6iEgU8DawATgJLBWR48mtS0R+FpE3c+TIkdyizC46Rthz4S5frD1O9XG/0/qHHczZcZGSjg580bwMIkKnGbs4rxsPTTNKdHQ0b731FuvXr+fEiRMsXryYEydOGP35u3fvmjG6pNWfKVMmxo8fz8mTJ9m1axfTpk17/kxjx46lXr16nDlzhnr16qVoQ2n2hkNEOolIQRGxERFnEQl4dn2diJQQkeIiMtoUdVn6UFVUdAw7zt7m09XHqDrmN9pP38miPZco75SDiR082P9pAwJ7etOzuguL+lUlOkboNHMXF28/Su3QNc3i7dmzBzc3N1xdXbG1taVjx46sWbMmwc88ffqUhQsXUqdOHQYPHvzS+5999hmenp54enri5OREr169AFiwYAE+Pj54enrSv39/oqOjAciWLRsff/wxHh4eVK1alRs3biRYf1RUFGvXrsXf359WrVq99H7BggWpVKkSAA4ODpQuXZorV64AsGbNGnr06AFAjx49WL169Wv+D5mOEol3TjrN8vLyEktJORIZHcPOc3dYf+waG47f4O6jCDLbWFOnVD4alytInVL5yWb36sVtf11/SKeZu7DLZEXQm1UpmidrCkevacY7efIkpUuXBuDLn49z4uo/Ji2/TKHsfN68bLzvL1++nF9++YVZs2YBMH/+fHbv3s3333//0r2HDx9m1qxZrF+/Hj8/P3r16kXlypXjLfvBgwfUqFGD2bNnkyVLFoYPH87KlSuxsbFh0KBBVK1ale7du6OUYu3atTRv3pzhw4eTPXt2Pvnkk5fKO3v2LAEBASxfvhxfX1969+5NrVq1Enz+ixcvUrNmTY4dO0b27NnJmTMn9+/ff/5+rly5EjVcFfvP619Kqf0i4vW6z6arXFVKqeZAczc3t1SNIzwqmj/P3mbd0etsOnGDB08iyWprTb3SBWhS3pFaJfKT2dY6/gIiDRPjJR0dWNi3Cp1n7qLTjF0s6V+NwrmzpNBTaFra8qpfgl81CTxhwgQ++ugjvv32W7777jvs7OxeW26XLl147733qFy5Mt9//z379+/H29sbgCdPnpA/f34AbG1tadbMsBWtcuXKbNq06aXyVqxYQYcOHfj44485cOAADg4Or322sLAw2rRpw6RJk8iePftr7ze3dNVwiMjPwM9eXl79UiuG+bv+5pv1p3gYHoWDfSYalClA43IFqeGeF3ubBBqLf4nAnKZw4zi41aN0qWYs7upLxwV/0XHGLoLerKobD83i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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "energy = models[0].data.axes[0].nodes.to(\"TeV\")\n",
    "y = models[0].data.evaluate(energy=energy, offset=\"0.5 deg\")\n",
    "plt.plot(energy, y, label=\"0 < zen < 20\")\n",
    "y = models[1].data.evaluate(energy=energy, offset=\"0.5 deg\")\n",
    "plt.plot(energy, y, label=\"20 < zen < 40\")\n",
    "y = models[2].data.evaluate(energy=energy, offset=\"0.5 deg\")\n",
    "plt.plot(energy, y, label=\"40 < zen < 90\")\n",
    "plt.loglog()\n",
    "plt.xlabel(\"Energy (TeV)\")\n",
    "plt.ylabel(\"Bkg rate (s-1 sr-1 MeV-1)\")\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Index tables\n",
    "\n",
    "So now we have radially symmetric background models for three zenith angle bins. To be able to use it from the high-level Gammapy classes like e.g. the MapMaker though, we also have to create a [HDU index table](https://gamma-astro-data-formats.readthedocs.io/en/latest/data_storage/hdu_index/index.html) that declares which background model to use for each observation.\n",
    "\n",
    "It sounds harder than it actually is. Basically you have to some code to make a new `astropy.table.Table`. The most tricky part is that before you can make the HDU index table, you have to decide where to store the data, because the HDU index table is a reference to the data location. Let's decide in this example that we want to re-use all existing files in `$GAMMAPY_DATA/hess-dl3-dr1` and put all the new HDUs (for background models and new index files) bundled in a single FITS file called `hess-dl3-dr3-with-background.fits.gz`, which we will put  in `$GAMMAPY_DATA/hess-dl3-dr1`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "filename = \"hess-dl3-dr3-with-background.fits.gz\"\n",
    "\n",
    "# Make a new table with one row for each observation\n",
    "# pointing to the background model HDU\n",
    "rows = []\n",
    "for obs_row in data_store.obs_table:\n",
    "    # TODO: pick the right background model based on zenith angle\n",
    "    row = {\n",
    "        \"OBS_ID\": obs_row[\"OBS_ID\"],\n",
    "        \"HDU_TYPE\": \"bkg\",\n",
    "        \"HDU_CLASS\": \"bkg_2d\",\n",
    "        \"FILE_DIR\": \"\",\n",
    "        \"FILE_NAME\": filename,\n",
    "        \"HDU_NAME\": \"BKG0\",\n",
    "    }\n",
    "    rows.append(row)\n",
    "\n",
    "hdu_table_bkg = Table(rows=rows)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Make a copy of the original HDU index table\n",
    "hdu_table = data_store.hdu_table.copy()\n",
    "hdu_table.meta.pop(\"BASE_DIR\")\n",
    "\n",
    "# Add the rows for the background HDUs\n",
    "hdu_table = vstack([hdu_table, hdu_table_bkg])\n",
    "hdu_table.sort(\"OBS_ID\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<i>HDUIndexTable masked=True length=7</i>\n",
       "<table id=\"table4588780176\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>OBS_ID</th><th>HDU_TYPE</th><th>HDU_CLASS</th><th>FILE_DIR</th><th>FILE_NAME</th><th>HDU_NAME</th><th>SIZE</th></tr></thead>\n",
       "<thead><tr><th>int64</th><th>str6</th><th>str9</th><th>str4</th><th>str36</th><th>str6</th><th>int64</th></tr></thead>\n",
       "<tr><td>20136</td><td>events</td><td>events</td><td>data</td><td>hess_dl3_dr1_obs_id_020136.fits.gz</td><td>events</td><td>414720</td></tr>\n",
       "<tr><td>20136</td><td>psf</td><td>psf_table</td><td>data</td><td>hess_dl3_dr1_obs_id_020136.fits.gz</td><td>psf</td><td>118080</td></tr>\n",
       "<tr><td>20136</td><td>edisp</td><td>edisp_2d</td><td>data</td><td>hess_dl3_dr1_obs_id_020136.fits.gz</td><td>edisp</td><td>377280</td></tr>\n",
       "<tr><td>20136</td><td>bkg</td><td>bkg_2d</td><td></td><td>hess-dl3-dr3-with-background.fits.gz</td><td>BKG0</td><td>--</td></tr>\n",
       "<tr><td>20136</td><td>gti</td><td>gti</td><td>data</td><td>hess_dl3_dr1_obs_id_020136.fits.gz</td><td>gti</td><td>5760</td></tr>\n",
       "<tr><td>20136</td><td>aeff</td><td>aeff_2d</td><td>data</td><td>hess_dl3_dr1_obs_id_020136.fits.gz</td><td>aeff</td><td>11520</td></tr>\n",
       "<tr><td>20137</td><td>events</td><td>events</td><td>data</td><td>hess_dl3_dr1_obs_id_020137.fits.gz</td><td>events</td><td>216000</td></tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<HDUIndexTable masked=True length=7>\n",
       "OBS_ID HDU_TYPE HDU_CLASS ... HDU_NAME  SIZE \n",
       "int64    str6      str9   ...   str6   int64 \n",
       "------ -------- --------- ... -------- ------\n",
       " 20136   events    events ...   events 414720\n",
       " 20136      psf psf_table ...      psf 118080\n",
       " 20136    edisp  edisp_2d ...    edisp 377280\n",
       " 20136      bkg    bkg_2d ...     BKG0     --\n",
       " 20136      gti       gti ...      gti   5760\n",
       " 20136     aeff   aeff_2d ...     aeff  11520\n",
       " 20137   events    events ...   events 216000"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "hdu_table[:7]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['PRIMARY', 'HDU_INDEX', 'OBS_INDEX', 'BKG0', 'BKG1', 'BKG2']\n"
     ]
    }
   ],
   "source": [
    "# Put index tables and background models in a FITS file\n",
    "hdu_list = fits.HDUList()\n",
    "\n",
    "hdu = fits.BinTableHDU(hdu_table)\n",
    "hdu.name = \"HDU_INDEX\"\n",
    "hdu_list.append(hdu)\n",
    "\n",
    "hdu = fits.BinTableHDU(data_store.obs_table)\n",
    "hdu_list.append(hdu)\n",
    "\n",
    "for idx, model in enumerate(models):\n",
    "    hdu = model.to_fits()\n",
    "    hdu.name = \"BKG{}\".format(idx)\n",
    "    hdu_list.append(hdu)\n",
    "\n",
    "print([_.name for _ in hdu_list])\n",
    "\n",
    "import os\n",
    "\n",
    "path = (\n",
    "    Path(os.environ[\"GAMMAPY_DATA\"])\n",
    "    / \"hess-dl3-dr1/hess-dl3-dr3-with-background.fits.gz\"\n",
    ")\n",
    "hdu_list.writeto(str(path), overwrite=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data store:\n",
      "HDU index table:\n",
      "BASE_DIR: /Users/deil/work/gammapy-tutorials/datasets/hess-dl3-dr1\n",
      "Rows: 630\n",
      "OBS_ID: 20136 -- 47829\n",
      "HDU_TYPE: ['aeff', 'bkg', 'edisp', 'events', 'gti', 'psf']\n",
      "HDU_CLASS: ['aeff_2d', 'bkg_2d', 'edisp_2d', 'events', 'gti', 'psf_table']\n",
      "\n",
      "Observation table:\n",
      "Observatory name: 'N/A'\n",
      "Number of observations: 105\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Let's see if it's possible to access the data\n",
    "ds2 = DataStore.from_file(path)\n",
    "ds2.info()\n",
    "obs = ds2.obs(20136)\n",
    "obs.events\n",
    "obs.aeff\n",
    "background2d_peek(obs.bkg)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "- Play with the parameters here (energy binning, offset binning, zenith binning)\n",
    "- Try to figure out why there are outliers on the zenith vs energy threshold curve.\n",
    "- Does azimuth angle or optical efficiency have an effect on background rate?\n",
    "- Use the background models for a 3D analysis (see \"hess\" notebook)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
