{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/spectrum_simulation.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[spectrum_simulation.ipynb](../_static/notebooks/spectrum_simulation.ipynb) |\n",
    "[spectrum_simulation.py](../_static/notebooks/spectrum_simulation.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Spectrum simulation for CTA\n",
    "\n",
    "A quick example how to use the functions and classes in gammapy.spectrum in order to simulate and fit spectra. \n",
    "\n",
    "We will simulate observations for the [Cherenkov Telescope Array (CTA)](https://www.cta-observatory.org) first using a power law model without any background. Than we will add a power law shaped background component. The next part of the tutorial shows how to use user defined models for simulations and fitting.\n",
    "\n",
    "We will use the following classes:\n",
    "\n",
    "* [gammapy.spectrum.SpectrumDatasetOnOff](..\/api/gammapy.spectrum.SpectrumDatasetOnOff.rst)\n",
    "* [gammapy.spectrum.SpectrumSimulation](..\/api/gammapy.spectrum.SpectrumSimulation.rst)\n",
    "* [gammapy.irf.load_cta_irfs](..\/api/gammapy.irf.load_cta_irfs.rst)\n",
    "* [gammapy.spectrum.models.PowerLaw](..\/api/gammapy.spectrum.models.PowerLaw.rst)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setup\n",
    "\n",
    "Same procedure as in every script ..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import astropy.units as u\n",
    "from gammapy.spectrum import SpectrumSimulation\n",
    "from gammapy.utils.fitting import Fit, Parameter\n",
    "from gammapy.spectrum.models import PowerLaw\n",
    "from gammapy.spectrum import models\n",
    "from gammapy.irf import load_cta_irfs"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Simulation of a single spectrum\n",
    "\n",
    "To do a simulation, we need to define the observational parameters like the livetime, the offset, the energy range to perform the simulation for and the choice of spectral model. This will then be convolved with the IRFs, and Poission fluctuated, to get the simulated counts for each observation.  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define simulation parameters parameters\n",
    "livetime = 1 * u.h\n",
    "offset = 0.5 * u.deg\n",
    "# Energy from 0.1 to 100 TeV with 10 bins/decade\n",
    "energy = np.logspace(-1, 2, 31) * u.TeV"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PowerLaw\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t   name     value   error      unit      min max frozen\n",
      "\t--------- --------- ----- -------------- --- --- ------\n",
      "\t    index 3.000e+00   nan                nan nan  False\n",
      "\tamplitude 2.500e-12   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "\treference 1.000e+00   nan            TeV nan nan   True\n"
     ]
    }
   ],
   "source": [
    "# Define spectral model - a simple Power Law in this case\n",
    "model_ref = PowerLaw(\n",
    "    index=3.0,\n",
    "    amplitude=2.5e-12 * u.Unit(\"cm-2 s-1 TeV-1\"),\n",
    "    reference=1 * u.TeV,\n",
    ")\n",
    "print(model_ref)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Get and set the model parameters after initialising\n",
    "The model parameters are stored in the `Parameters` object on the spectal model. Each model parameter is a `Parameter` instance. It has a `value` and a `unit` attribute, as well as a `quantity` property for convenience."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Parameters\n",
      "Parameter(name='index', value=3.0, factor=3.0, scale=1.0, unit='', min=nan, max=nan, frozen=False)\n",
      "Parameter(name='amplitude', value=2.5e-12, factor=2.5e-12, scale=1.0, unit='cm-2 s-1 TeV-1', min=nan, max=nan, frozen=False)\n",
      "Parameter(name='reference', value=1.0, factor=1.0, scale=1.0, unit='TeV', min=nan, max=nan, frozen=True)\n",
      "\n",
      "covariance: \n",
      "None\n"
     ]
    }
   ],
   "source": [
    "print(model_ref.parameters)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Parameter(name='index', value=3.0, factor=3.0, scale=1.0, unit='', min=nan, max=nan, frozen=False)\n",
      "Parameter(name='index', value=2.1, factor=2.1, scale=1.0, unit='', min=nan, max=nan, frozen=False)\n"
     ]
    }
   ],
   "source": [
    "print(model_ref.parameters[\"index\"])\n",
    "model_ref.parameters[\"index\"].value = 2.1\n",
    "print(model_ref.parameters[\"index\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Load IRFs\n",
    "filename = (\n",
    "    \"$GAMMAPY_DATA/cta-1dc/caldb/data/cta/1dc/bcf/South_z20_50h/irf_file.fits\"\n",
    ")\n",
    "cta_irf = load_cta_irfs(filename)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "A quick look into the effective area and energy dispersion:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "NDDataArray summary info\n",
      "MapAxis\n",
      "\n",
      "\tname       : energy    \n",
      "\tunit       : 'TeV'     \n",
      "\tnbins      : 42        \n",
      "\tnode type  : edges     \n",
      "\tedges min  : 1.3e-02 TeV\n",
      "\tedges max  : 2.0e+02 TeV\n",
      "\tinterp     : log       \n",
      "MapAxis\n",
      "\n",
      "\tname       : offset    \n",
      "\tunit       : 'deg'     \n",
      "\tnbins      : 6         \n",
      "\tnode type  : edges     \n",
      "\tedges min  : 0.0e+00 deg\n",
      "\tedges max  : 6.0e+00 deg\n",
      "\tinterp     : lin       \n",
      "Data           : size =   252, min =  0.000 m2, max = 5371581.000 m2\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYUAAAEKCAYAAAD9xUlFAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAgAElEQVR4nO3dd3hUZfr/8fedhNCLNKlSpEkRlIiuvYsiYBfLuuvatqj7U3ddXV3rKri6VtxVXOwr+l07ir0hdkLvREAJRQiQQCAh7f79MUOMkWQmyUzOJPm8risXmXPOnPmQc83c85xznucxd0dERAQgKegAIiKSOFQURESklIqCiIiUUlEQEZFSKgoiIlJKRUFEREqlBB2gJtq3b+89e/YMOoaISJ2Snp6e5e4ddreuTheFnj17MnPmzKBjiIjUKWb2XUXrdPpIRERKqSiIiEgpFQURESmloiAiIqVUFEREpJSKgoiIlKrTt6SKiNQFPa97M6rtVk0YFeckkdXJomBmo4HRffr0CTqKiNRDdelDPNbqZFFw96nA1LS0tEuCziIitSdzyw66tG5KUpLFbJ/ZOwrI2JDL8g25pf/G0ubtBVxzXD+e/vI7Nm7bCUD7Fo3JySugsNh56Xe/YHiPtjF9zZqok0VBRBqGWH9jj3Z/AKnJSfRq35w+e7agT4cWZOXuZNr8dWzZUVi6zSkPf8aYoV04eWhnOrZs8pPnZ2zYxuQZq3h5ViY7i0oAGNCpJRcd2osxw7rw0AcZTPwogxteWcDUKw6lUXJiXOJVURARKefDa45gr7bNSCn3QX3LmEHMWJ7Fa3PW8O6iH5izOps5q7P5+5uLOHjv9owZ2oUOrRrz1Oer+HjpxtLnHT2gIxcd2ouD926HWaiVc/nRfXh97lqWrN/GE5+t5NLD967V/2NFrC7P0ZyWluYa+0ik/tqaX8hlT6fzxYpNNE9N5sQhnXkxPZPOrZvw3tVH0KJx9b7XLlq7ldETZ1Dizku/O5j999qjyvvIKyhmn5vejmrbiloyHy/dwK+f+IamjZJ5/5oj6NqmaZVzVIeZpbt72u7WJUZ7RUSknPU5+Zz1yBd8sWITHVo25oXLfsFdp+/LkK6tWZeTz33vLavWfotLnOtfnkdxiXPBQT2qVRAAmqYmV+t5ZR3ZvyMnDelEXmExt76+sMb7iwWdPhKRhLPsh238+vGvWZuTT+8OzXnqwhF0b9sMgPGnDWHMxBk88dlKTt2vK4O7tq7Svp/6fBVzM3Po3LoJfx45oEY5Y3H30U0nD+KTpRt5d9EPvLfoB44buGeN91kTaimISEL5asUmzvj356zNyWd4jz146bcHlxYEgMFdW3PhIb0ocbj+5fkUl0R/Cjxzyw7ueXcpALePHVzt00+x1Kl1E645vj8At7y+kB0FRYHmUVEQkYTx5rx1/HLy12zNL+L4gXvy34sPZI/mqT/b7urj+tGldRPmr8nh6S9WRbVvd+em1xayo6CYUUM6c2zA38jLuuAXPRjUpRVrsvN44IPlgWZRURCRhPD4jJVcPmUWBcUl/PKgHvz7/OE0abT78/bNG6dw69jBANzzzlLW5eRF3P8b89bx4ZINtGySws2jB8Y0e02lJCdxx6lDMIPJn65k6fptgWVRURCRQJWUOHdOW8xtbyzCHa4d2Z/bxg4iOUIHteMG7skJg/Zke0Ext0S4SJu9o4Bbp4a2+etJ+9CxVZNKtw/CsO5tOP/AHhSVODe+Op+SKpwWi6XgT6iJSIMSqQPZP95eyj/eDp33j3Qhd1e/gXcW/sC7C9dz/KBOu91u/LQlZOUWMKJXW85O61694LXgTyf0560F6/lm1RZeTM/krANqP2udbCmY2Wgzm5STkxN0FBEJUOfWTfnTCaGLtDe/vpDcnT+/SPvFt5t4YeZqUpOTuPPUITEdIiPWWjdtxN9O3geAO99azObtBbWeQZ3XRKRKNmzNZ8O2nQzo1PJnPX4j2by9gAc/WM6zX35HUYnTtFEylx3Rm0sP702z1OqduCgucU55+DPmr8nhokN78beTf7xekF9YzIkPfMrKrO1cfVw/rjymb7Veoza5O+dP/orPMjZx5vBu3H3m0Ji/RmWd13T6SEQqFe14QSvHn1Q6hEN5+YXFPPX5KiZ+lMG2/CLM4Oy07lxzfL8an99PTrIK+y5M/DCDlVnb6duxBb89IjGGkYjEzLh97GBG3v8p/0vP5My07ozoVXsD5tXJ00ciEl8btubzfzNX8/v/pkf9nAPv/ICrX5jDS+mZrM/JB0Lfel+fu5Zj7/2E8W8tYVt+EYf1bc+0Kw/jrjP2jdkF38FdW/Obcn0XlqzfyiOffIsZTDh9CKkpdefjrneHFvzuyFARu/HV+RSEB9SrDTp9JCK4O7NXZ/PB4h/4aMlGFq3b+pP1vds358j+HTmyfwdG9GpLk0bJrM3O47OMLD7LyGJGxiaycndG9VrxmoNg+84ijrv3E9bm5HPjqH14Y9465qzO5pcH9eD2UwbH5TVjrSqjuNbk76jTRyLyM9F+AE3/81Hs1a7Zz5Z3adOUM9O6c2Zad9ydXtdPi3XEKmneOIXbxg7m4qdncse0xbhDp1ZNuHZk/0Bz1TUqCiINTMaGbbw+d13U2++uIJRnZj/55lpQVMLczGzWZudxzD57xn04ifIFbtcJkPVb8xlyy7ulyxN9prTd5cvK3Un7Fo1rLYOKgkgD8P2mHUydt5ap4fH7d2nXPJUTh3Ri9L5dOKBn25jdrpmaksQBPRNnNrG6rDYLAqgoiNQbBUUlZG7ZwdH//CSq7Z+5aAS/6N2uyreVJqJEbwHUJSoKInVQfmExL6ZnsnBtDt9t2sF3m3awLiePqoyMcFjfDvELKHWWioJIHRHtheGD925Hj3bN2Ktt8/C/zejTsUWFg8uJlKWiIFLPPHfJQUFHkDpMRUEkwWXvKOC+95aRnGQUlzitmzbimuP7ce6IverF9QBJLCoKIgmqqLiEKV9/zz/fW0b2jkKSLDQZy1XH9tvtxDMisaCiIJKAvvh2E7dOXVh6++gverfj5jEDGdCpVcDJpL5TURAJWDQXkL9YsUkFQWpFnTwhqfkURETio062FNx9KjA1LS3tkqCziFTX/Mwcnvv6O5qlJrOjoBiAPZo14sy07lx4SE86t24acEJpiOpkURCpq7bvLGLq3LU89/X3zMv8saU7oldbzjtwL0YO7kTjFPUnkOCoKIjEQVWGQH7/6sPp07FlHNOIRK9OXlMQqU9UECSRqKUgEgerJoxiZ1Ex/3h7KZNnrATg0D7tufHkfXQXkSQ0FQWROFixMZcrn5/NgjVbSUkyrjm+P5cd3jtmQ1OLxIuKgkgMuTsvzVrDTa8tYEdBMd3bNuXBcfux3157BB1NJCoqCiIxsi2/kL+9uoBX56wFYMzQLvz91MG0atIo4GQi0VNREImBuauzuWLKbL7fvIOmjZK5bewgzhjeDTOdLpK6RUVBpAZKSpzHPl3B3e8spajEGdi5FQ+dux97d2gRdDSRalFREKmCSP0PFq3byjH//ETTQ0qdpX4KIiJSSi0FkSpYNWEU7s6Et5bw6PQVNE5J4qnfjOCg3u2CjiYSE2opiFTRwx9l8Oj0FaQkGY+cP1wFQeoVFQWRKnjys5Xc8+4yzOC+s4dx1ICOQUcSiSkVBZEovZieyS1TFwEw/tQhjB7aJeBEIrGnoiAShbcXrOPaF+cCcOOofRg3Yq+AE4nEh4qCSATTl23kiimzKXG48pi+XHxY76AjicSNioJIJWau2sylz8yksNi58JCeXHVs36AjicSVioJIBRasyeHCJ74hv7CEM4d342+jBmrYCqn3VBREdiNjQy4XPP4123YWcdKQTkw4fV8Ney0NgjqviVD58BXT5q9n2vxpABq+Quq9OtlSMLPRZjYpJycn8sYiIhI1c/egM1RbWlqaz5w5M+gYUo9M+fp7rn95Ps1Sk3njikPprdFOpR4ys3R3T9vdukpPH5nZ1VHsf7u7P1qtZCIJZOn6bdzy+kIA7jh1sAqCNEiRTh/9GWgBtKzk55p4BhSpDXkFxVz+3Cx2FpVwxvBunLpft6AjiQQi0oXmZ9z9tso2MLPmMcwjEohbXl/I8g257N2hObeNHRR0HJHAVNpScPdrI+0gmm1EEtlrc9bwwszVpKYkMfHc/WmWqpvypOGKePeRmQ0ws2PMrEW55SPjF0ukdqzK2s5fX54PwE0nD2Sfzq0CTiQSrEqLgpldCbwGXAEsMLOxZVbfGc9gIvG2s6iYy6fMYntBMScN6cR5B2qQO5FI7eRLgOHunmtmPYEXzaynuz8AqHun1Gl3vbWUBWu20m2Ppow/bV8NYSFC5KKQ7O65AO6+ysyOJFQYeqCiIHXY+4t+4PHPVpKSZEw8d39aN20UdCSRhBDpmsJ6Mxu260G4QJwMtAeGxDOYSLyszc7jT+G5Ea4d2Z9h3dsEnEgkcUQqChcA68sucPcid78AODxuqUTipKi4hD8+P5vsHYUc2b8DFx+quRFEyqr09JG7Z+763cz2ALqXeU5eHHOJxERlA919vHQjvf+qge5Eyorqhmwzux34NfAtsGuwJAeOjk8sEREJQrS9dM4C9nb3gniGEYm1XS2AnLxCTrx/Omtz8rni6D5cc3z/gJOJJKZoh85eAOhqnNRJ7s4Nr8xnbU4+Q7u34cpjNKWmSEWibSmMB2ab2QJg566F7j4mLqlEYuiV2Wt4Y946mqUm88DZw2iUXCenERGpFdEWhaeAu4D5QEn84ojE1urNO7jptdBw2LeMHkTP9hq/UaQy0RaFLHd/MK5JRGKsqLiE//fCHHJ3FnHi4E6cmabhsEUiibYopJvZeOB1fnr6aFZcUonEwMMffUv6d1vo1KoJ408bomEsRKIQbVHYL/zvQWWW6ZZUSVjp323hwQ+XYwb3njWUNs1Sg44kUidEVRTc/ah4BxGJlW35hfy/F2ZTXOJcdnhvDu7TPuhIInVGpKGzT460g2i2EalNt7y+iNWb8xjUpRVXH98v6DgidUqklsLdZraGykdEvRN4I3aRRKpv6ty1vDQrkyaNknhg3DAapyQHHUmkTolUFH4A7o2wzfIYZRGpkbXZedzwSmgWtRtGDaRPx5YBJxKpeyINiHdkLeUQqZHiEueqF+awNb+IYwZ05HzNoiZSLeraKfXCpOkr+GrlZtq3aMxdZ2gWNZHqivaWVJGEUtGQ2Fm5O0n7+/uljzUktkjVqKUgIiKlom4pmNlgYCDQZNcyd386HqFEIlk1YRTFJc6vn/iaT5dnMbzHHjx/6UEa7E6khqKdZOdm4EhCRWEacCIwA1BRkMA89OFyPl2eRdvmqUw8dz8VBJEYiPZddAZwDLDe3S8EhgKN45ZKJILpyzbywAehYSweGDeMzq2bBh1JpF6ItijkuXsJUGRmrYANgGY8l0Cszc7jj8/Pxh2uOrYfh/XtEHQkkXoj2msKM82sDfAYkA7kAl/HLZVIBQqKSvjDc7PYsqOQw/t14PKj+gQdSaReiXZAvN+Hf33EzN4GWrn7vPjFEtm98W8tZvb32XRp3YT7zx5GUpL6I4jEUlSnjyzkfDO7yd1XAdlmNiKWQcwsyczuMLOHzOxXsdy31A9vzlvHE5+tolGyMfG8/WnbXMNhi8RatNcU/gX8Ajgn/Hgb8HCkJ5nZ42a2ITy3c9nlI81sqZllmNl14cVjga5AIZAZZS5pIL7dmMu1L84F4IaT9mH/vfYIOJFI/RRtUTjQ3f8A5AO4+xYgmq9pTwIjyy4ws2RCBeVEQre4nmNmA4H+wBfufjXwuyhzSQOQV1DM75+dxfaCYkbt25lfHdwz6Egi9Va0RaEw/GHuAGbWASiJ9CR3nw5sLrd4BJDh7ivcvQB4nlArIRPYEt6mOMpcUs+5Oze8Op+lP2yjd4fm3HW6xjUSiadoi8KDwCtARzO7g1DHtTur+ZpdgdVlHmeGl70MnGBmDwHTK3qymV1qZjPNbObGjRurGUHqihe+Wc3Ls9bQpFES/z5vOC0aa7gukXiK9u6j/5pZOqEObAac4u6Lq/mau/ua5+6+A7goiiyTgEkAaWlpXs0MkqAqGuguv7CEE+7/8buCBroTiY+IRcHMkoB57j4YWBKD18wEupd53A1YG4P9iohIDUUsCu5eYmZzzWwvd/8+Bq/5DdDXzHoBa4BxwLkx2K/UA6smjOKJz1Zy69RFAFx2eG+uO3GAriOI1JJoT9B2Bhaa2dfA9l0L3X1MZU8ysymEBtJrb2aZwM3uPtnMLgfeAZKBx919YXXCS/3i7tz73jIe+jADgOtPHMBlR+wdcCqRhiXaonBrdXbu7udUsHwaodFWq8XMRgOj+/TREAf1RXGJ87fXFvDcV9+TnGSMP20IZ6V1j/xEEYmpqO4+cvdPyv4ARcBZ8Y1WaZ6p7n5p69atg4ogMbSzqJgrpsziua++JzUliUfOH66CIBKQqkyyM4zQuf+zgJXAS/EKJQ1H7s4iLntmJp9lbKJl4xT+86s0DuzdLuhYIg1WpUXBzPoRuhB8DrAJeAEwdz+qFrJJPbcpdycXPvkN8zJzaN+iMU/95gAGdVHrTyRIkVoKS4BPgdHungFgZlfFPZXUe2uy8/jl5K9YsXE73ds25dmLDqRHu+ZBxxJp8CIVhdMJtRQ+Cg+Z/Ty773wmUqmKOqUBrN6cxxF3fwyoU5pI0Cq90Ozur7j72cAA4GPgKmBPM/u3mR1fC/lERKQWmXvVRoows7bAmcDZ7n50XFJFzrDrltRLli9fHkQEqYaMDdsYN+krsnJ3cvDe7Zj8qwNompocdCyRBsfM0t09bbfrqloUEklaWprPnDkz6BgSheU/bOOcx74kK7eAQ/u057EL0lQQRAJSWVHQkJMSd0vXb+Pcx75k0/YCDusbKghNGqkgiCQiFQWJqyXrt3LeY1+xaXsBh/frwKRfDldBEElg0c6ngJn1MLNjw783NbOW8Ysl9cHidVs5N1wQjlBBEKkToioKZnYJ8CLwaHhRN+DVeIWSum/R2q2c+9iXbN5ewFH9O/CoCoJInRBtS+EPwCHAVgB3Xw50jFcoqdsWrs3h3P98yZYdhRw9oCOPqCCI1BnRFoWd4fmUATCzFMLzNQfBzEab2aScnJygIkgFFqzJ4dzHviJ7RyHH7tORf5+/P41TVBBE6oqobkk1s38A2cAFwBXA74FF7n5DfONVTrekBquyXsrlqaeySOKo7JbUaFsK1wEbgfnAZYTmQrgxNvFERCRRRHtL6ljgaXd/LJ5hpG5ZNWEUn2Vk8ZeX5pG5JY+UJOOKo/vy+6P2plFy1De2iUgCibYojAHuN7PphAbFe8fdi+IXSxLdtvxCxr+1hOe+Ck3bPahLK+4+YygDu7QKOJmI1ERURcHdLzSzRsCJhCba+ZeZvefuF8c1nSSkT5dv5LqX5rMmO49GycaVR/flt0eqdSBSH0Tdo9ndC83sLUJ3HTUldEpJRaEB2ZZfyJ3TFjPl69UADO7ainvOHMqATmodiNQXURUFMxtJaF6FowgNof0fApyjWWrfJ8s2cv1L81ibk09qchJ/PLYvlx7eW60DkXom2pbCrwldS7jM3XfGL44kgki3mhYUl3D3O0v5w1F9aimRiNSWaK8pjIt3kKooM59C0FFEROqVSjuvmdkMdz/UzLbx0x7MBri7B3oyWZ3X4sfdmfDWEh6dvoKUJOPh8/bnhEGdgo4lIjFQ7fkU3P3Q8L8aEbUBUUEQabiiHSX1mWiWSd2ngiDSsEV768igsg/CA+INj30cCZIKgohUWhTM7Prw9YR9zWxr+Gcb8APwWq0klFqhgiAiEKEouPv48PWEu929Vfinpbu3c/fraymjxJkKgojsEu3po6/NrPWuB2bWxsxOiVMmqUUqCCJSVrRF4WZ3L53Rxt2zgZvjE0lqiwqCiJQXbY/m3RWPqMdNksRQWU/lohLnsmfSAU2II9KQRdtSmGlm95rZ3mbW28zuA9LjGawymo5TRCQ+op2OsznwN+DY8KJ3gTvcfXscs0WkHs1V5+7c8+5SHv7oW1KSjInn7s/IwTplJNKQVLtH8y7hD//rzKyFu+fGNJ3UqvveX87DH31LcpLx0Dn7qSCIyE9E26P5YDNbBCwKPx5qZv+KazKJuQfeX86DHywnOcl4YNwwThzSOehIIpJgor2mcB9wArAJwN3nAofHK5TE3sQPl3Pf+8tIMrjv7GGcvG+XoCOJSAKKeoYUd19dblFxjLNInPzr4wzueTdUEO49axhjhqogiMjuRXtb6WozOxhwM0sFrgQWxy+WxMqjn3zLP95eihncfcZQTtmva9CRRCSBRdtS+C3wB6ArkAkMCz+WBPafT1cw/q0lmMFdp+/L6cO7BR1JRBJcpS0FM7vL3f8CHOXu59VSJomByTNW8vc3Q425CacN4ay07gEnEpG6INLMa/OB/YGv3H3/WksVJfVTCIk0p/Iu6qksIlCzfgpvA1lAczPbSngaThJkOk4REYmtSC2Fxu6+08xec/extZgrKmophGzLL+Te95bx1OerKHHo0LIxt4wexKh91Q9BRH6uJi2FLwidPtoa81RSY+7O1Hnr+Psbi9iwbSdJBhce0pOrjutHqyaNgo4nInVQpKKQama/Ag42s9PKr3T3l+MTq3JmNhoY3adPnyBePiF8uzGXm15bwGcZmwDYb682/P2UwQzq0jrCM0VEKhapKPwWOA9oA4wut86BQIqCu08FpqalpV0SxOsHKa+gmIkfLWfS9BUUFjttmjXiupEDOCutO0lJFnQ8EanjKi0K7j4DmGFmM919ci1lkgp8tHQDN76ygDXZeQCMO6A7144cQNvmqQEnE5H6ItKF5mvd/R/h38909/+VWXenu/+1FjJWqL5faNatpiISD5VdaI7Uo3lcmd+vL7duZI1SiYhIwol0TcEq+H13jyXGVk0Yhbtz6TPpvLfoB9J67MHzlx5ESnLU4xiKiFRJpE8Xr+D33T2WOHj2q+95b9EPtGySwv3jhqkgiEhcRWopDC3Tk7lp+HfCj5vENZmwdP02/v7GIgDGnzaEbns0CziRiNR3ke4+Sq6tIPJT+YXFXDFlFjuLSjg7rbsmxRGRWqFzEQnqjjcXs+yHXHp3aM7NYwYGHUdEGggVhQT0zsL1PPPld6QmJ/HguP1olhrtXEgiIjWjopBg1uXk8ZeX5gFw7cj+DO6qYStEpPaoKCSQ4hLnqhfmkL2jkCP7d+A3h/QKOpKINDAqCgnkkU++5csVm2nfojH3nDlUYxmJSK1TUUgQ6d9t4d73lgFw71lDad+iccCJRKQhUlFIAFvzC/nj87MpLnEuOawXh/frEHQkEWmg6mRRMLPRZjYpJycn6Cg15u7c8MoCMrfkMbhrK/58woCgI4lIA1bpKKmJrq6OkqrRT0UkSDUZJVVERBoQ9YoKwKoJo1ibnceYiTPIyi3gksN6ccMo9VoWkeCppRCA/MJiLnsmnazcAg7t056/jNR1BBFJDCoKtczduf7l+cxfk0P3tk156Jz9NBy2iCQMfRrVsskzVvLK7DU0bZTMYxeksYfmVxaRBKKiUItmLM/izmmLAfjnWUMZ0KlVwIlERH5KRaGWfL9pB5dPmUWJwx+O2puThnQOOpKIyM+oKNSCHQVFXPrMTLJ3FHL0gI5cfVz/oCOJiOyWikKcuTt//t88lqzfRu/2zbnv7GEka6A7EUlQKgpx9q+Pv+XN+eto0TiFSRcMp3XTRkFHEhGpkIpCHH20ZAP3vLsUgPvPHkafji0DTiQiUjn1aI6hysY0uvjpH8do0phGIpKo1FIQEZFSainE0KoJo9iyvYAzH/2CjA25DO+xB89edCBNU5ODjiYiEhW1FGJoR0ERFz75DRkbcum3Zwsm/ypNBUFE6hQVhRgpKCrht8/OYs7qbLq2acrTvzmQNs00hIWI1C0qCjFQUuL86X9zmb5sI22bp/LMRSPo1LpJ0LFERKpMRaGG3J3b3ljE63PX0jw1mScvPIDeHVoEHUtEpFpUFGro4Y8yePLzVaQmJzHpgjT27dYm6EgiItWmolADz331Pfe8uwwzuH/cMA7p0z7oSCIiNVIni4KZjTazSTk5OYFleGv+Om58dT4At48drFFPRaReqJNFwd2nuvulrVu3DuT1P8/I4o/Pz6HE4erj+nH+QT0CySEiEmvm7kFnqLa0tDSfOXNm5A1roLKhK8rT8BUiUheYWbq7p+1uXZ1sKYiISHxomIsIyn77n/jhcu55dxk92jXj7T8ert7KIlLvqKUQpYwNuTz4QQYA408dooIgIvWSikIUSkqc61+eR0FxCWeldeNg3XoqIvWUikIU/vv193yzagvtWzTmhpMGBh1HRCRuVBQiWJeTx11vLQHgtrGDaN1M02mKSP2lolAJd+dvry4gd2cRxw/ckxMHdwo6kohIXKkoVOLN+et4f/EGWjZO4baxgzGzoCOJiMSVikIFtmwv4JbXFwJw3UkDNBS2iDQIKgoVuGPaYrJyCxjRqy3nHLBX0HFERGqFisJuzFiexYvpmaSmJDHhtCEkJem0kYg0DCoK5ewoKOL6V+YB8Mdj+mrCHBFpUFQUyrnvvWWs3pzHPp1bcenhvYOOIyJSq1QUypi7OpvJM1aSZHDX6UNolKw/j4g0LPrUCyssLuEvL82jxOGiQ3tpWk0RaZAa7Ciplc2T8NinK3ns05WA5kgQkYZFLQURESnVYFsK5VsAxSXO599mcVjfDgElEhEJnloKYclJpoIgIg2eioKIiJRSURARkVIqCiIiUkpFQURESqkoiIhIKRUFEREppaIgIiKlzN2DzlBtZrYR+K7c4tZAzm42L7+8PZAVp2iRVJQx3vuJdvtI21W2Ptq/f0XLgjouQR2Tqjynuselpsv1Xqn+don6Xunh7rvvmOXu9eoHmBTNcmBmomWM936i3T7SdpWtj/bvX8myQI5LUMekNo5LTZfrvRL7Y1LV41Kb75X6ePpoahWXByFWWaq6n2i3j7RdZeur8vfXManac6p7XGK1PAh6r0T3OjFTp08f1YSZzXT3tKBzyE/puCQeHZPEFK/jUh9bCtGaFHQA2S0dl8SjY5KY4nJcGllhKqAAAAUGSURBVGxLQUREfq4htxRERKQcFQURESmloiAiIqVUFHbDzHqb2WQzezHoLA2ZmTU3s6fM7DEzOy/oPBKi90fiMbNTwu+T18zs+Jrsq94VBTN73Mw2mNmCcstHmtlSM8sws+sq24e7r3D3i+KbtGGq4vE5DXjR3S8BxtR62AakKsdF74/aUcVj8mr4ffJr4OyavG69KwrAk8DIsgvMLBl4GDgRGAicY2YDzWyImb1R7qdj7UduUJ4kyuMDdANWhzcrrsWMDdGTRH9cpHY8SdWPyY3h9dWWUpMnJyJ3n25mPcstHgFkuPsKADN7Hhjr7uOBk2s3YcNWleMDZBIqDHOon19gEkYVj8ui2k3XMFXlmJjZYmAC8Ja7z6rJ6zaUN1pXfvzGCaEPm64VbWxm7czsEWA/M7s+3uGkwuPzMnC6mf2bxBp6oaHY7XHR+yNQFb1XrgCOBc4ws9/W5AXqXUuhArabZRX22nP3TUCN/rBSJbs9Pu6+HbiwtsNIqYqOi94fwanomDwIPBiLF2goLYVMoHuZx92AtQFlkZ/T8UlMOi6JJ+7HpKEUhW+AvmbWy8xSgXHA6wFnkh/p+CQmHZfEE/djUu+KgplNAb4A+ptZppld5O5FwOXAO8Bi4P/cfWGQORsqHZ/EpOOSeII6JhoQT0REStW7loKIiFSfioKIiJRSURARkVIqCiIiUkpFQURESqkoiIhIKRUFqbfMrNjM5pT5qXTI9NpiZqvMbL6ZpZnZK+FsGWaWUybrwRU892Ize6bcsj3DQyw3MrMXzGyzmZ1SO/8bqW/UT0HqLTPLdfcWMd5nSrgDUU32sQpIc/esMsuOBP7k7pWO2mtmewDLgW7unh9edjkwxN0vCz9+ltA8FK/WJKc0TGopSIMT/qZ+q5nNCn9jHxBe3jw8sck3ZjbbzMaGl//azP5nZlOBd80sycz+ZWYLw3NwTDOzM8zsGDN7pczrHGdmL9cg5wFm9omZpZvZW2a2p7tvAT4HRpXZdBwwpbqvI1KWioLUZ03LnT4qOyNVlrvvD/wb+FN42Q3Ah+5+AHAUcLeZNQ+v+wXwK3c/mtCMcD2BIcDF4XUAHwL7mFmH8OMLgSeqE9zMGgMPAKe7+3DgWeD28OophAoBZtY9nGV6dV5HpLyGMnS2NEx57j6sgnW7vsGnE/qQBzgeGGNmu4pEE2Cv8O/vufvm8O+HAv9z9xJgvZl9BKHxi8Pn+883sycIFYsLqpl9H2AQ8L6ZASQTGiETQgOgPWhmLQhNvfh/4SwiNaaiIA3VzvC/xfz4PjBC38yXlt3QzA4EtpddVMl+nyA0IVA+ocJR3esPBsxz98PKr3D37Wb2PqFZ0MYBv6vma4j8jE4fifzoHeAKC381N7P9KthuBqEZ4ZLMbE/gyF0r3H0tofHtbyQ0x251LSI0y9mIcJZUMxtUZv0U4M9AG3f/pgavI/ITKgpSn5W/pjAhwva3A42AeWa2gB/P4Zf3EqFTOQuAR4GvgJwy6/8LrHb3as9l7O47gTOAe81sLjAbOLDMJm8TOrX1fHVfQ2R3dEuqSDWYWQt3zzWzdsDXwCHuvj68biIw290nV/DcVZS7JTXG2XRLqlSbWgoi1fOGmc0BPgVuL1MQ0oF9Cd0tVJGNwAdmlhbrUGb2AnAIoWsaIlWmloKIiJRSS0FEREqpKIiISCkVBRERKaWiICIipVQURESklIqCiIiU+v/ZM7OVcow3WwAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "aeff = cta_irf[\"aeff\"].to_effective_area_table(offset=offset, energy=energy)\n",
    "aeff.plot()\n",
    "plt.loglog()\n",
    "print(cta_irf[\"aeff\"].data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "NDDataArray summary info\n",
      "MapAxis\n",
      "\n",
      "\tname       : e_true    \n",
      "\tunit       : 'TeV'     \n",
      "\tnbins      : 30        \n",
      "\tnode type  : edges     \n",
      "\tedges min  : 1.0e-01 TeV\n",
      "\tedges max  : 1.0e+02 TeV\n",
      "\tinterp     : log       \n",
      "MapAxis\n",
      "\n",
      "\tname       : e_reco    \n",
      "\tunit       : 'TeV'     \n",
      "\tnbins      : 30        \n",
      "\tnode type  : edges     \n",
      "\tedges min  : 1.0e-01 TeV\n",
      "\tedges max  : 1.0e+02 TeV\n",
      "\tinterp     : log       \n",
      "Data           : size =   900, min =  0.000, max =  0.926\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "edisp = cta_irf[\"edisp\"].to_energy_dispersion(\n",
    "    offset=offset, e_true=energy, e_reco=energy\n",
    ")\n",
    "edisp.plot_matrix()\n",
    "print(edisp.data)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The `SpectrumSimulation` class does the work of convolving the model with the effective area and the energy dispersion, and then Poission fluctuating the counts. An `obs_id` is needed by `SpectrumSimulation.simulate_obs()` to keep track of the simulated spectra. Here, we just pass a dummy index, but while simulating observations in a loop, this needs to be updated."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Simulate data\n",
    "sim = SpectrumSimulation(\n",
    "    aeff=aeff, edisp=edisp, source_model=model_ref, livetime=livetime\n",
    ")\n",
    "sim.simulate_obs(seed=42, obs_id=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<gammapy.spectrum.dataset.SpectrumDatasetOnOff object at 0x1235b59e8>\n"
     ]
    },
    {
     "data": {
      "image/png": "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REREskhObEJbWlrqZWVlUYchIi00d+7c1e7eM+o4spU+60TyQ0s/63IiOSsrK2POnDlRhyEiLWRmSxo/qnDps04kP7T0s06PNUVERESyiJIzERERkSyi5ExEREQki+TEnDORfLBz504qKirYtm1b1KFkXNu2benbty8lJSVRhyIiknOUnImEpKKigk6dOlFWVoaZRR1Oxrg7lZWVVFRUMHDgwKjDERHJOXqsKRKSbdu20aNHj7xOzADMjB49ehTECKGISCYoORMJUb4nZnGF8nuKiGSCHmuKROC2DCUvV7tn5LoiIhIejZyJiIiIZJG8GjkbOXIkADNmzIg0DpFUpWukK1MjcamaP38+APvvv3+kcRQSfd6JhC+sfpdXyZmINKy8vJyTTjqJL3/5y8ycOZM+ffrw97//nXbt2u1x7Lx587jsssvYsmULgwcP5v7776dbt26MHDmSo446ihdeeIF169Zx3333sddee0Xw2xS2q666KuoQRApOWP1OjzVFCsyCBQu44ooreP/99+natSuPPvpo0uMuuugibr31Vt555x0OOeQQfvrTn9a+V1VVxezZs7njjjt2a5fwnHbaaZx22mlRhyFSUMLqd0rORArMwIEDGTp0KADDhg2jvLx8j2PWr1/PunXrOPbYYwEYM2YML730Uu37Z511VoPnS+bNnz+/9nGyiIQjrH6nx5oiBaZNmza1r4uLi9m6dWuzr1FcXExVVVXaYpPUXXrppYDmnImEKax+l1fJ2eWXXx51CCJNEvVE/vp06dKFbt268fLLL/OVr3yFyZMn146iJdOzZ88QoxMRyW95lZyNHj066hBE8sakSZNqFwQMGjSIP/3pT/Ue27179xAjExHJb3mVnC1btgyAfv36RRyJSMOi2iy2rKyM9957b1ccV19d77FDhw7ltdde26M9cTi/tLSU8vJyduzYAUDr1q3TF6yISIHKq+TswgsvBDQHQyRsixcvBrTPmYhIOuRVciYiTXfFFVfw6quv7tZ25ZVX8t3vfjeiiCQV1113XdQhiBScsPqdkjORELl71hUFv/POO9N+TVeNz4w74YQTog5BpOCE1e+0z5lISNq2bUtlZWXeJy7uTmVlJW3bto06lLw2b9485s2bF3UYIgUlrH6nkTORkPTt25eKigpWrVoVdShp9/nnnwNQU1MDxBLRvn37RhlS3hs3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\n",
      "text/plain": [
       "<Figure size 720x720 with 4 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Take a quick look at the simulated counts\n",
    "sim.obs.peek()\n",
    "print(sim.obs)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Include Background \n",
    "\n",
    "In this section we will include a background component. Furthermore, we will also simulate more than one observation and fit each one individually in order to get average fit results."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "# We assume a PowerLaw shape of the background as well\n",
    "bkg_model = PowerLaw(\n",
    "    index=2.5, amplitude=1e-11 * u.Unit(\"cm-2 s-1 TeV-1\"), reference=1 * u.TeV\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 111 ms, sys: 1.97 ms, total: 113 ms\n",
      "Wall time: 112 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "# Now simulate 30 indepenent spectra using the same set of observation conditions.\n",
    "n_obs = 30\n",
    "seeds = np.arange(n_obs)\n",
    "\n",
    "sim = SpectrumSimulation(\n",
    "    aeff=aeff,\n",
    "    edisp=edisp,\n",
    "    source_model=model_ref,\n",
    "    livetime=livetime,\n",
    "    background_model=bkg_model,\n",
    "    alpha=0.2,\n",
    ")\n",
    "\n",
    "sim.run(seeds)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Before moving on to the fit let's have a look at the simulated observations."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 864x288 with 3 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "n_on = [obs.counts.data.sum() for obs in sim.result]\n",
    "n_off = [obs.counts_off.data.sum() for obs in sim.result]\n",
    "excess = [obs.excess.data.sum() for obs in sim.result]\n",
    "\n",
    "fix, axes = plt.subplots(1, 3, figsize=(12, 4))\n",
    "axes[0].hist(n_on)\n",
    "axes[0].set_xlabel(\"n_on\")\n",
    "axes[1].hist(n_off)\n",
    "axes[1].set_xlabel(\"n_off\")\n",
    "axes[2].hist(excess)\n",
    "axes[2].set_xlabel(\"excess\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, we fit each simulated spectrum individually "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 1.09 s, sys: 5.31 ms, total: 1.09 s\n",
      "Wall time: 1.09 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "results = []\n",
    "for obs in sim.result:\n",
    "    dataset = obs\n",
    "    dataset.model = model_ref.copy()\n",
    "    fit = Fit([dataset])\n",
    "    result = fit.optimize()\n",
    "    results.append(\n",
    "        {\n",
    "            \"index\": result.parameters[\"index\"].value,\n",
    "            \"amplitude\": result.parameters[\"amplitude\"].value,\n",
    "        }\n",
    "    )"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We take a look at the distribution of the fitted indices. This matches very well with the spectrum that we initially injected, index=2.1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "spectral index: 2.10 +/- 0.07\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "index = np.array([_[\"index\"] for _ in results])\n",
    "plt.hist(index, bins=10, alpha=0.5)\n",
    "plt.axvline(x=model_ref.parameters[\"index\"].value, color=\"red\")\n",
    "print(\"spectral index: {:.2f} +/- {:.2f}\".format(index.mean(), index.std()))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Adding a user defined model\n",
    "\n",
    "Many spectral models in gammapy are subclasses of `SpectralModel`. The list of available models is shown below."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[gammapy.spectrum.models.ConstantModel,\n",
       " gammapy.spectrum.models.CompoundSpectralModel,\n",
       " gammapy.spectrum.models.PowerLaw,\n",
       " gammapy.spectrum.models.PowerLaw2,\n",
       " gammapy.spectrum.models.ExponentialCutoffPowerLaw,\n",
       " gammapy.spectrum.models.ExponentialCutoffPowerLaw3FGL,\n",
       " gammapy.spectrum.models.PLSuperExpCutoff3FGL,\n",
       " gammapy.spectrum.models.LogParabola,\n",
       " gammapy.spectrum.models.TableModel,\n",
       " gammapy.spectrum.models.ScaleModel,\n",
       " gammapy.spectrum.models.AbsorbedSpectralModel,\n",
       " gammapy.spectrum.models.NaimaModel,\n",
       " gammapy.spectrum.models.SpectralGaussian,\n",
       " gammapy.spectrum.models.SpectralLogGaussian,\n",
       " gammapy.spectrum.crab.MeyerCrabModel]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "models.SpectralModel.__subclasses__()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This section shows how to add a user defined spectral model. \n",
    "\n",
    "To do that you need to subclass `SpectralModel`. All `SpectralModel` subclasses need to have an `__init__` function, which sets up the `Parameters` of the model and a `static` function called `evaluate` where the mathematical expression for the model is defined.\n",
    "\n",
    "As an example we will use a PowerLaw plus a Gaussian (with fixed width)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "class UserModel(models.SpectralModel):\n",
    "    def __init__(self, index, amplitude, reference, mean, width):\n",
    "        super().__init__(\n",
    "            [\n",
    "                Parameter(\"index\", index, min=0),\n",
    "                Parameter(\"amplitude\", amplitude, min=0),\n",
    "                Parameter(\"reference\", reference, frozen=True),\n",
    "                Parameter(\"mean\", mean, min=0),\n",
    "                Parameter(\"width\", width, min=0, frozen=True),\n",
    "            ]\n",
    "        )\n",
    "\n",
    "    @staticmethod\n",
    "    def evaluate(energy, index, amplitude, reference, mean, width):\n",
    "        pwl = models.PowerLaw.evaluate(\n",
    "            energy=energy,\n",
    "            index=index,\n",
    "            amplitude=amplitude,\n",
    "            reference=reference,\n",
    "        )\n",
    "        gauss = amplitude * np.exp(-(energy - mean) ** 2 / (2 * width ** 2))\n",
    "        return pwl + gauss"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "UserModel\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t   name     value   error      unit         min    max frozen\n",
      "\t--------- --------- ----- -------------- --------- --- ------\n",
      "\t    index 2.000e+00   nan                0.000e+00 nan  False\n",
      "\tamplitude 1.000e-12   nan cm-2 s-1 TeV-1 0.000e+00 nan  False\n",
      "\treference 1.000e+00   nan            TeV       nan nan   True\n",
      "\t     mean 5.000e+00   nan            TeV 0.000e+00 nan  False\n",
      "\t    width 2.000e-01   nan            TeV 0.000e+00 nan   True\n"
     ]
    }
   ],
   "source": [
    "model = UserModel(\n",
    "    index=2,\n",
    "    amplitude=1e-12 * u.Unit(\"cm-2 s-1 TeV-1\"),\n",
    "    reference=1 * u.TeV,\n",
    "    mean=5 * u.TeV,\n",
    "    width=0.2 * u.TeV,\n",
    ")\n",
    "print(model)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "energy_range = [1, 10] * u.TeV\n",
    "model.plot(energy_range=energy_range);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "* Change the observation time to something longer or shorter. Does the observation and spectrum results change as you expected?\n",
    "* Change the spectral model, e.g. add a cutoff at 5 TeV, or put a steep-spectrum source with spectral index of 4.0\n",
    "* Simulate spectra with the spectral model we just defined. How much observation duration do you need to get back the injected parameters?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## What next?\n",
    "\n",
    "In this tutorial we simulated and analysed the spectrum of source using CTA prod 2 IRFs.\n",
    "\n",
    "If you'd like to go further, please see the other tutorial notebooks."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
