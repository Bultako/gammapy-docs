{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy/master?urlpath=lab/tree/spectrum_simulation.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[spectrum_simulation.ipynb](../_static/notebooks/spectrum_simulation.ipynb) |\n",
    "[spectrum_simulation.py](../_static/notebooks/spectrum_simulation.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Spectrum simulation with Gammapy"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction\n",
    "\n",
    "This notebook explains how to use the functions and classes in [gammapy.spectrum](..\/spectrum/index.rst) in order to simulate and fit spectra.\n",
    "\n",
    "First, we will simulate and fit a pure power law without any background. Than we will add a power law shaped background component. Finally, we will see how to simulate and fit a user defined model. For all scenarios a toy detector will be simulated. For an example using real CTA IRFs, checkout [this notebook](https://github.com/gammapy/gammapy/blob/master/tutorials/spectrum_simulation_cta.ipynb).\n",
    "\n",
    "The following clases will be used:\n",
    "\n",
    "* [gammapy.irf.EffectiveAreaTable](..\/api/gammapy.irf.EffectiveAreaTable.rst)\n",
    "* [gammapy.irf.EnergyDispersion](https://docs.gammapy.org/dev/api/gammapy.irf.EnergyDispersion)\n",
    "* [gammapy.spectrum.SpectrumObservation](..\/api/gammapy.spectrum.SpectrumObservation.rst)\n",
    "* [gammapy.spectrum.SpectrumSimulation](..\/api/gammapy.spectrum.SpectrumSimulation.rst)\n",
    "* [gammapy.spectrum.models.PowerLaw](..\/api/gammapy.spectrum.models.PowerLaw.rst)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setup\n",
    "\n",
    "Same procedure as in every script ..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import astropy.units as u\n",
    "from gammapy.irf import EnergyDispersion, EffectiveAreaTable\n",
    "from gammapy.spectrum import SpectrumSimulation\n",
    "from gammapy.spectrum.models import PowerLaw\n",
    "from gammapy.utils.fitting import Fit"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create detector\n",
    "\n",
    "For the sake of self consistency of this tutorial, we will simulate a simple detector. For a real application you would want to replace this part of the code with loading the IRFs or your detector."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 864x432 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "e_true = np.logspace(-2, 2.5, 109) * u.TeV\n",
    "e_reco = np.logspace(-2, 2, 79) * u.TeV\n",
    "\n",
    "edisp = EnergyDispersion.from_gauss(\n",
    "    e_true=e_true, e_reco=e_reco, sigma=0.2, bias=0\n",
    ")\n",
    "aeff = EffectiveAreaTable.from_parametrization(energy=e_true)\n",
    "\n",
    "fig, axes = plt.subplots(1, 2, figsize=(12, 6))\n",
    "edisp.plot_matrix(ax=axes[0])\n",
    "aeff.plot(ax=axes[1]);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Power law\n",
    "\n",
    "In this section we will simulate one observation using a power law model."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PowerLaw\n",
      "\n",
      "Parameters: \n",
      "\n",
      "\t   name     value   error      unit      min max frozen\n",
      "\t--------- --------- ----- -------------- --- --- ------\n",
      "\t    index 2.300e+00   nan                nan nan  False\n",
      "\tamplitude 1.000e-11   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "\treference 1.000e+00   nan            TeV nan nan   True\n"
     ]
    }
   ],
   "source": [
    "pwl = PowerLaw(\n",
    "    index=2.3, amplitude=1e-11 * u.Unit(\"cm-2 s-1 TeV-1\"), reference=1 * u.TeV\n",
    ")\n",
    "print(pwl)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "*** Observation summary report ***\n",
      "Observation Id: 1\n",
      "Livetime: 2.000 h\n",
      "On events: 339\n",
      "Off events: 0\n",
      "Alpha: 1.000\n",
      "Bkg events in On region: 0.00\n",
      "Excess: 339.00\n",
      "Gamma rate: 2.83 1 / min\n",
      "Bkg rate: 0.00 1 / min\n",
      "Sigma: nan\n",
      "energy range: 0.01 TeV - 100.00 TeV\n"
     ]
    }
   ],
   "source": [
    "livetime = 2 * u.h\n",
    "sim = SpectrumSimulation(\n",
    "    aeff=aeff, edisp=edisp, source_model=pwl, livetime=livetime\n",
    ")\n",
    "sim.simulate_obs(seed=2309, obs_id=1)\n",
    "print(sim.obs)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : minuit\n",
      "\tsuccess    : True\n",
      "\tnfev       : 31\n",
      "\ttotal stat : -853.95\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\n"
     ]
    }
   ],
   "source": [
    "dataset = sim.obs.to_spectrum_dataset()\n",
    "dataset.model = pwl.copy()\n",
    "\n",
    "fit = Fit([dataset])\n",
    "\n",
    "result = fit.run()\n",
    "print(result)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Include background\n",
    "\n",
    "In this section we will include a background component. Furthermore, we will also simulate more than one observation and fit each one individuallt in order to get average fit results."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "bkg_model = PowerLaw(\n",
    "    index=2.5, amplitude=1e-11 * u.Unit(\"cm-2 s-1 TeV-1\"), reference=1 * u.TeV\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SpectrumObservationList\n",
      "Number of observations: 30\n",
      "*** Observation summary report ***\n",
      "Observation Id: 0\n",
      "Livetime: 2.000 h\n",
      "On events: 733\n",
      "Off events: 1915\n",
      "Alpha: 0.200\n",
      "Bkg events in On region: 383.00\n",
      "Excess: 350.00\n",
      "Excess / Background: 0.91\n",
      "Gamma rate: 2.92 1 / min\n",
      "Bkg rate: 0.04 1 / min\n",
      "Sigma: 14.17\n",
      "energy range: 0.01 TeV - 100.00 TeV\n",
      "CPU times: user 170 ms, sys: 4.37 ms, total: 174 ms\n",
      "Wall time: 171 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "n_obs = 30\n",
    "seeds = np.arange(n_obs)\n",
    "\n",
    "sim = SpectrumSimulation(\n",
    "    aeff=aeff,\n",
    "    edisp=edisp,\n",
    "    source_model=pwl,\n",
    "    livetime=livetime,\n",
    "    background_model=bkg_model,\n",
    "    alpha=0.2,\n",
    ")\n",
    "\n",
    "sim.run(seeds)\n",
    "print(sim.result)\n",
    "print(sim.result[0])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Before moving on to the fit let's have a look at the simulated observations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 864x288 with 3 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "n_on = [obs.total_stats.n_on for obs in sim.result]\n",
    "n_off = [obs.total_stats.n_off for obs in sim.result]\n",
    "excess = [obs.total_stats.excess for obs in sim.result]\n",
    "\n",
    "fix, axes = plt.subplots(1, 3, figsize=(12, 4))\n",
    "axes[0].hist(n_on)\n",
    "axes[0].set_xlabel(\"n_on\")\n",
    "axes[1].hist(n_off)\n",
    "axes[1].set_xlabel(\"n_off\")\n",
    "axes[2].hist(excess)\n",
    "axes[2].set_xlabel(\"excess\");"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 2.18 s, sys: 43.6 ms, total: 2.22 s\n",
      "Wall time: 2.08 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "results = []\n",
    "for obs in sim.result:\n",
    "    dataset = obs.to_spectrum_dataset()\n",
    "    dataset.model = pwl.copy()\n",
    "    fit = Fit([dataset])\n",
    "    result = fit.optimize()\n",
    "    results.append(\n",
    "        {\n",
    "            \"index\": result.parameters[\"index\"].value,\n",
    "            \"amplitude\": result.parameters[\"amplitude\"].value,\n",
    "        }\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "spectral index: 2.31 +/- 0.09\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "index = np.array([_[\"index\"] for _ in results])\n",
    "plt.hist(index, bins=10)\n",
    "print(\"spectral index: {:.2f} +/- {:.2f}\".format(index.mean(), index.std()))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "* Fit a pure power law and the user define model to the observation you just simulated. You can start with the user defined model described in the [spectrum_models.ipynb](https://github.com/gammapy/gammapy/blob/master/tutorials/spectrum_models.ipynb) notebook.\n",
    "* Vary the observation lifetime and see when you can distinguish the two models (Hint: You get the final likelihood of a fit from `fit.result[0].statval`)."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## What's next\n",
    "\n",
    "In this tutorial we learnd how to simulate and fit data using a toy detector. Go to [gammapy.spectrum](..\/spectrum/index.rst) to see what else you can do with gammapy."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
