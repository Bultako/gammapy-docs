{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy/master?urlpath=lab/tree/light_curve.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[light_curve.ipynb](../_static/notebooks/light_curve.ipynb) |\n",
    "[light_curve.py](../_static/notebooks/light_curve.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Light curves\n",
    "\n",
    "## Introduction\n",
    "\n",
    "This tutorial explain how to compute a light curve with Gammapy.\n",
    "\n",
    "We will use the four Crab nebula observations from the [H.E.S.S. first public test data release](https://www.mpi-hd.mpg.de/hfm/HESS/pages/dl3-dr1/) and compute per-observation fluxes. The Crab nebula is not known to be variable at TeV energies, so we expect constant brightness within statistical and systematic errors.\n",
    "\n",
    "The main classes we will use are:\n",
    "\n",
    "* [gammapy.time.LightCurve](..\/api/gammapy.time.LightCurve.rst)\n",
    "* [gammapy.time.LightCurveEstimator](..\/api/gammapy.time.LightCurveEstimator.rst)\n",
    "\n",
    "## Setup\n",
    "\n",
    "As usual, we'll start with some setup..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "import astropy.units as u\n",
    "from astropy.coordinates import SkyCoord, Angle\n",
    "from regions import CircleSkyRegion\n",
    "from gammapy.utils.energy import EnergyBounds\n",
    "from gammapy.data import DataStore\n",
    "from gammapy.spectrum import SpectrumExtraction\n",
    "from gammapy.spectrum.models import PowerLaw\n",
    "from gammapy.background import ReflectedRegionsBackgroundEstimator\n",
    "from gammapy.time import LightCurveEstimator"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spectrum\n",
    "\n",
    "The `LightCurveEstimator` is based on a 1d spectral analysis within each time bin.\n",
    "So before we can make the light curve, we have to extract 1d spectra."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_store = DataStore.from_dir(\"$GAMMAPY_DATA/hess-dl3-dr1/\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Observations\n",
      "Number of observations: 4\n",
      "Info for OBS_ID = 23523\n",
      "- Start time: 53343.92\n",
      "- Pointing pos: RA 83.63 deg / Dec 21.51 deg\n",
      "- Observation duration: 1687.0 s\n",
      "- Dead-time fraction: 6.240 %\n",
      "Info for OBS_ID = 23526\n",
      "- Start time: 53343.95\n",
      "- Pointing pos: RA 83.63 deg / Dec 22.51 deg\n",
      "- Observation duration: 1683.0 s\n",
      "- Dead-time fraction: 6.555 %\n",
      "Info for OBS_ID = 23559\n",
      "- Start time: 53345.96\n",
      "- Pointing pos: RA 85.25 deg / Dec 22.01 deg\n",
      "- Observation duration: 1686.0 s\n",
      "- Dead-time fraction: 6.398 %\n",
      "Info for OBS_ID = 23592\n",
      "- Start time: 53347.91\n",
      "- Pointing pos: RA 82.01 deg / Dec 22.01 deg\n",
      "- Observation duration: 1686.0 s\n",
      "- Dead-time fraction: 6.212 %\n",
      "\n"
     ]
    }
   ],
   "source": [
    "mask = data_store.obs_table[\"TARGET_NAME\"] == \"Crab\"\n",
    "obs_ids = data_store.obs_table[\"OBS_ID\"][mask].data\n",
    "observations = data_store.get_observations(obs_ids)\n",
    "print(observations)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Target definition\n",
    "target_position = SkyCoord(ra=83.63308, dec=22.01450, unit=\"deg\")\n",
    "on_region_radius = Angle(\"0.2 deg\")\n",
    "on_region = CircleSkyRegion(center=target_position, radius=on_region_radius)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 907 ms, sys: 17.9 ms, total: 925 ms\n",
      "Wall time: 927 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "bkg_estimator = ReflectedRegionsBackgroundEstimator(\n",
    "    on_region=on_region, observations=observations\n",
    ")\n",
    "bkg_estimator.run()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 811 ms, sys: 20.9 ms, total: 832 ms\n",
      "Wall time: 832 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "ebounds = EnergyBounds.equal_log_spacing(0.7, 100, 50, unit=\"TeV\")\n",
    "extraction = SpectrumExtraction(\n",
    "    observations=observations,\n",
    "    bkg_estimate=bkg_estimator.result,\n",
    "    containment_correction=False,\n",
    "    e_reco=ebounds,\n",
    "    e_true=ebounds,\n",
    ")\n",
    "extraction.run()\n",
    "spectrum_observations = extraction.spectrum_observations"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Light curve estimation\n",
    "\n",
    "OK, so now that we have prepared 1D spectra (not spectral models, just the 1D counts and exposure and 2D energy dispersion matrix), we can compute a lightcurve.\n",
    "\n",
    "To compute the light curve, a spectral model shape has to be assumed, and an energy band chosen.\n",
    "The method is then to adjust the amplitude parameter of the spectral model in each time bin to the data, resulting in a flux measurement in each time bin."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Creat list of time bin intervals\n",
    "# Here we do one time bin per observation\n",
    "time_intervals = [(obs.tstart, obs.tstop) for obs in observations]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Assumed spectral model\n",
    "spectral_model = PowerLaw(\n",
    "    index=2, amplitude=2.0e-11 * u.Unit(\"1 / (cm2 s TeV)\"), reference=1 * u.TeV\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "energy_range = [1, 100] * u.TeV"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 824 ms, sys: 21.3 ms, total: 845 ms\n",
      "Wall time: 848 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "lc_estimator = LightCurveEstimator(extraction)\n",
    "lc = lc_estimator.light_curve(\n",
    "    time_intervals=time_intervals,\n",
    "    spectral_model=spectral_model,\n",
    "    energy_range=energy_range,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Results\n",
    "\n",
    "The light curve measurement result is stored in a table. Let's have a look at the results:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['time_min', 'time_max', 'flux', 'flux_err', 'flux_ul', 'is_ul', 'livetime', 'alpha', 'n_on', 'n_off', 'measured_excess', 'expected_excess']\n"
     ]
    }
   ],
   "source": [
    "print(lc.table.colnames)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<i>Table length=4</i>\n",
       "<table id=\"table4416650040\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>time_min</th><th>time_max</th><th>flux</th><th>flux_err</th></tr></thead>\n",
       "<thead><tr><th></th><th></th><th>1 / (cm2 s)</th><th>1 / (cm2 s)</th></tr></thead>\n",
       "<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>\n",
       "<tr><td>53343.92234009259</td><td>53343.94186555556</td><td>1.839834550960819e-11</td><td>1.8993229053146408e-12</td></tr>\n",
       "<tr><td>53343.95421509259</td><td>53343.97369425926</td><td>1.997585378782766e-11</td><td>2.020285941359047e-12</td></tr>\n",
       "<tr><td>53345.96198129629</td><td>53345.98149518518</td><td>2.1920429489279916e-11</td><td>2.552730381710862e-12</td></tr>\n",
       "<tr><td>53347.913196574074</td><td>53347.93271046296</td><td>2.3191550721307975e-11</td><td>2.5669916434977504e-12</td></tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<Table length=4>\n",
       "     time_min           time_max     ...        flux_err       \n",
       "                                     ...      1 / (cm2 s)      \n",
       "     float64            float64      ...        float64        \n",
       "------------------ ----------------- ... ----------------------\n",
       " 53343.92234009259 53343.94186555556 ... 1.8993229053146408e-12\n",
       " 53343.95421509259 53343.97369425926 ...  2.020285941359047e-12\n",
       " 53345.96198129629 53345.98149518518 ...  2.552730381710862e-12\n",
       "53347.913196574074 53347.93271046296 ... 2.5669916434977504e-12"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lc.table[\"time_min\", \"time_max\", \"flux\", \"flux_err\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "lc.plot();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$$2.0740149 \\times 10^{-11} \\; \\mathrm{\\frac{1}{s\\,cm^{2}}}$$"
      ],
      "text/plain": [
       "<Quantity 2.07401493e-11 1 / (cm2 s)>"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Let's compare to the expected flux of this source\n",
    "from gammapy.spectrum import CrabSpectrum\n",
    "\n",
    "crab_spec = CrabSpectrum().model\n",
    "crab_flux = crab_spec.integral(*energy_range).to(\"cm-2 s-1\")\n",
    "crab_flux"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = lc.plot(marker=\"o\", lw=2)\n",
    "ax.hlines(\n",
    "    crab_flux.value,\n",
    "    xmin=lc.table[\"time_min\"].min(),\n",
    "    xmax=lc.table[\"time_max\"].max(),\n",
    ");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "* Change the assumed spectral model shape (e.g. to a steeper power-law), and see how the integral flux estimate for the lightcurve changes.\n",
    "* Try a time binning where you split the observation time for every run into two time bins.\n",
    "* Try to analyse the PKS 2155 flare data from the H.E.S.S. first public test data release.\n",
    "  Start with per-observation fluxes, and then try fluxes within 5 minute time bins for one or two of the observations where the source was very bright."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
