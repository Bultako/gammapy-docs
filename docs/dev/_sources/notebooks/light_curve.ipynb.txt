{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/light_curve.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[light_curve.ipynb](../_static/notebooks/light_curve.ipynb) |\n",
    "[light_curve.py](../_static/notebooks/light_curve.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Light curves\n",
    "\n",
    "## Introduction\n",
    "\n",
    "This tutorial explain how to compute a light curve with Gammapy.\n",
    "\n",
    "We will use the four Crab nebula observations from the [H.E.S.S. first public test data release](https://www.mpi-hd.mpg.de/hfm/HESS/pages/dl3-dr1/) and compute per-observation fluxes. The Crab nebula is not known to be variable at TeV energies, so we expect constant brightness within statistical and systematic errors.\n",
    "\n",
    "The main classes we will use are:\n",
    "\n",
    "* [gammapy.time.LightCurve](..\/api/gammapy.time.LightCurve.rst)\n",
    "* [gammapy.time.LightCurveEstimator](..\/api/gammapy.time.LightCurveEstimator.rst)\n",
    "\n",
    "## Setup\n",
    "\n",
    "As usual, we'll start with some setup..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "import astropy.units as u\n",
    "from astropy.coordinates import SkyCoord, Angle\n",
    "from regions import CircleSkyRegion\n",
    "from gammapy.utils.energy import energy_logspace\n",
    "from gammapy.data import DataStore\n",
    "from gammapy.spectrum import SpectrumExtraction\n",
    "from gammapy.spectrum.models import PowerLaw\n",
    "from gammapy.background import ReflectedRegionsBackgroundEstimator\n",
    "from gammapy.time import LightCurveEstimator"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spectrum\n",
    "\n",
    "The `LightCurveEstimator` is based on a 1d spectral analysis within each time bin.\n",
    "So before we can make the light curve, we have to extract 1d spectra."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_store = DataStore.from_dir(\"$GAMMAPY_DATA/hess-dl3-dr1/\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Observations\n",
      "Number of observations: 4\n",
      "Info for OBS_ID = 23523\n",
      "- Start time: 53343.92\n",
      "- Pointing pos: RA 83.63 deg / Dec 21.51 deg\n",
      "- Observation duration: 1687.0 s\n",
      "- Dead-time fraction: 6.240 %\n",
      "Info for OBS_ID = 23526\n",
      "- Start time: 53343.95\n",
      "- Pointing pos: RA 83.63 deg / Dec 22.51 deg\n",
      "- Observation duration: 1683.0 s\n",
      "- Dead-time fraction: 6.555 %\n",
      "Info for OBS_ID = 23559\n",
      "- Start time: 53345.96\n",
      "- Pointing pos: RA 85.25 deg / Dec 22.01 deg\n",
      "- Observation duration: 1686.0 s\n",
      "- Dead-time fraction: 6.398 %\n",
      "Info for OBS_ID = 23592\n",
      "- Start time: 53347.91\n",
      "- Pointing pos: RA 82.01 deg / Dec 22.01 deg\n",
      "- Observation duration: 1686.0 s\n",
      "- Dead-time fraction: 6.212 %\n",
      "\n"
     ]
    }
   ],
   "source": [
    "mask = data_store.obs_table[\"TARGET_NAME\"] == \"Crab\"\n",
    "obs_ids = data_store.obs_table[\"OBS_ID\"][mask].data\n",
    "observations = data_store.get_observations(obs_ids)\n",
    "print(observations)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Target definition\n",
    "target_position = SkyCoord(ra=83.63308, dec=22.01450, unit=\"deg\")\n",
    "on_region_radius = Angle(\"0.2 deg\")\n",
    "on_region = CircleSkyRegion(center=target_position, radius=on_region_radius)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 833 ms, sys: 35.2 ms, total: 868 ms\n",
      "Wall time: 869 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "bkg_estimator = ReflectedRegionsBackgroundEstimator(\n",
    "    on_region=on_region, observations=observations\n",
    ")\n",
    "bkg_estimator.run()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 724 ms, sys: 18.5 ms, total: 742 ms\n",
      "Wall time: 743 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "ebounds = energy_logspace(0.7, 100, 51, unit=\"TeV\")\n",
    "extraction = SpectrumExtraction(\n",
    "    observations=observations,\n",
    "    bkg_estimate=bkg_estimator.result,\n",
    "    containment_correction=False,\n",
    "    e_reco=ebounds,\n",
    "    e_true=ebounds,\n",
    ")\n",
    "extraction.run()\n",
    "spectrum_observations = extraction.spectrum_observations"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Light curve estimation\n",
    "\n",
    "OK, so now that we have prepared 1D spectra (not spectral models, just the 1D counts and exposure and 2D energy dispersion matrix), we can compute a lightcurve.\n",
    "\n",
    "To compute the light curve, a spectral model shape has to be assumed, and an energy band chosen.\n",
    "The method is then to adjust the amplitude parameter of the spectral model in each time bin to the data, resulting in a flux measurement in each time bin."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Creat list of time bin intervals\n",
    "# Here we do one time bin per observation\n",
    "time_intervals = [(obs.tstart, obs.tstop) for obs in observations]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Assumed spectral model\n",
    "spectral_model = PowerLaw(\n",
    "    index=2, amplitude=2.0e-11 * u.Unit(\"1 / (cm2 s TeV)\"), reference=1 * u.TeV\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "energy_range = [1, 100] * u.TeV"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 668 ms, sys: 19.1 ms, total: 687 ms\n",
      "Wall time: 687 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "lc_estimator = LightCurveEstimator(extraction)\n",
    "lc = lc_estimator.light_curve(\n",
    "    time_intervals=time_intervals,\n",
    "    spectral_model=spectral_model,\n",
    "    energy_range=energy_range,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Results\n",
    "\n",
    "The light curve measurement result is stored in a table. Let's have a look at the results:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['time_min', 'time_max', 'flux', 'flux_err', 'flux_ul', 'is_ul', 'livetime', 'alpha', 'n_on', 'n_off', 'measured_excess', 'expected_excess']\n"
     ]
    }
   ],
   "source": [
    "print(lc.table.colnames)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<i>Table length=4</i>\n",
       "<table id=\"table4424872624\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>time_min</th><th>time_max</th><th>flux</th><th>flux_err</th></tr></thead>\n",
       "<thead><tr><th></th><th></th><th>1 / (cm2 s)</th><th>1 / (cm2 s)</th></tr></thead>\n",
       "<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>\n",
       "<tr><td>53343.92234009259</td><td>53343.94186555556</td><td>1.8146297133610075e-11</td><td>1.9030024008573683e-12</td></tr>\n",
       "<tr><td>53343.95421509259</td><td>53343.97369425926</td><td>2.021512918192134e-11</td><td>2.0197699838963666e-12</td></tr>\n",
       "<tr><td>53345.96198129629</td><td>53345.98149518518</td><td>2.1946481289003035e-11</td><td>2.5542764764051463e-12</td></tr>\n",
       "<tr><td>53347.913196574074</td><td>53347.93271046296</td><td>2.3206878724784264e-11</td><td>2.570008209682963e-12</td></tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<Table length=4>\n",
       "     time_min           time_max     ...        flux_err       \n",
       "                                     ...      1 / (cm2 s)      \n",
       "     float64            float64      ...        float64        \n",
       "------------------ ----------------- ... ----------------------\n",
       " 53343.92234009259 53343.94186555556 ... 1.9030024008573683e-12\n",
       " 53343.95421509259 53343.97369425926 ... 2.0197699838963666e-12\n",
       " 53345.96198129629 53345.98149518518 ... 2.5542764764051463e-12\n",
       "53347.913196574074 53347.93271046296 ...  2.570008209682963e-12"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lc.table[\"time_min\", \"time_max\", \"flux\", \"flux_err\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "lc.plot();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$$2.0740149 \\times 10^{-11} \\; \\mathrm{\\frac{1}{s\\,cm^{2}}}$$"
      ],
      "text/plain": [
       "<Quantity 2.07401493e-11 1 / (cm2 s)>"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Let's compare to the expected flux of this source\n",
    "from gammapy.spectrum import create_crab_spectral_model\n",
    "\n",
    "crab_spec = create_crab_spectral_model()\n",
    "crab_flux = crab_spec.integral(*energy_range).to(\"cm-2 s-1\")\n",
    "crab_flux"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = lc.plot(marker=\"o\", lw=2)\n",
    "ax.hlines(\n",
    "    crab_flux.value,\n",
    "    xmin=lc.table[\"time_min\"].min(),\n",
    "    xmax=lc.table[\"time_max\"].max(),\n",
    ");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "* Change the assumed spectral model shape (e.g. to a steeper power-law), and see how the integral flux estimate for the lightcurve changes.\n",
    "* Try a time binning where you split the observation time for every run into two time bins.\n",
    "* Try to analyse the PKS 2155 flare data from the H.E.S.S. first public test data release.\n",
    "  Start with per-observation fluxes, and then try fluxes within 5 minute time bins for one or two of the observations where the source was very bright."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
