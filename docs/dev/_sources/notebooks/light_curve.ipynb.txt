{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/light_curve.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[light_curve.ipynb](../_static/notebooks/light_curve.ipynb) |\n",
    "[light_curve.py](../_static/notebooks/light_curve.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Light curves\n",
    "\n",
    "## Introduction\n",
    "\n",
    "This tutorial explain how to compute a light curve with Gammapy.\n",
    "\n",
    "We will use the four Crab nebula observations from the [H.E.S.S. first public test data release](https://www.mpi-hd.mpg.de/hfm/HESS/pages/dl3-dr1/) and compute per-observation fluxes. The Crab nebula is not known to be variable at TeV energies, so we expect constant brightness within statistical and systematic errors.\n",
    "\n",
    "The main classes we will use are:\n",
    "\n",
    "* [gammapy.time.LightCurve](..\/api/gammapy.time.LightCurve.rst)\n",
    "* [gammapy.time.LightCurveEstimator](..\/api/gammapy.time.LightCurveEstimator.rst)\n",
    "\n",
    "## Setup\n",
    "\n",
    "As usual, we'll start with some setup..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "import astropy.units as u\n",
    "from astropy.coordinates import SkyCoord, Angle\n",
    "from regions import CircleSkyRegion\n",
    "from gammapy.utils.energy import energy_logspace\n",
    "from gammapy.data import DataStore\n",
    "from gammapy.spectrum import SpectrumExtraction\n",
    "from gammapy.spectrum.models import PowerLaw\n",
    "from gammapy.background import ReflectedRegionsBackgroundEstimator\n",
    "from gammapy.time import LightCurveEstimator"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spectrum\n",
    "\n",
    "The `LightCurveEstimator` is based on a 1d spectral analysis within each time bin.\n",
    "So before we can make the light curve, we have to extract 1d spectra."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_store = DataStore.from_dir(\"$GAMMAPY_DATA/hess-dl3-dr1/\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Observations\n",
      "Number of observations: 4\n",
      "Info for OBS_ID = 23523\n",
      "- Start time: 53343.92\n",
      "- Pointing pos: RA 83.63 deg / Dec 21.51 deg\n",
      "- Observation duration: 1687.0 s\n",
      "- Dead-time fraction: 6.240 %\n",
      "Info for OBS_ID = 23526\n",
      "- Start time: 53343.95\n",
      "- Pointing pos: RA 83.63 deg / Dec 22.51 deg\n",
      "- Observation duration: 1683.0 s\n",
      "- Dead-time fraction: 6.555 %\n",
      "Info for OBS_ID = 23559\n",
      "- Start time: 53345.96\n",
      "- Pointing pos: RA 85.25 deg / Dec 22.01 deg\n",
      "- Observation duration: 1686.0 s\n",
      "- Dead-time fraction: 6.398 %\n",
      "Info for OBS_ID = 23592\n",
      "- Start time: 53347.91\n",
      "- Pointing pos: RA 82.01 deg / Dec 22.01 deg\n",
      "- Observation duration: 1686.0 s\n",
      "- Dead-time fraction: 6.212 %\n",
      "\n"
     ]
    }
   ],
   "source": [
    "mask = data_store.obs_table[\"TARGET_NAME\"] == \"Crab\"\n",
    "obs_ids = data_store.obs_table[\"OBS_ID\"][mask].data\n",
    "observations = data_store.get_observations(obs_ids)\n",
    "print(observations)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Target definition\n",
    "target_position = SkyCoord(ra=83.63308, dec=22.01450, unit=\"deg\")\n",
    "on_region_radius = Angle(\"0.2 deg\")\n",
    "on_region = CircleSkyRegion(center=target_position, radius=on_region_radius)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 892 ms, sys: 22.6 ms, total: 914 ms\n",
      "Wall time: 922 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "bkg_estimator = ReflectedRegionsBackgroundEstimator(\n",
    "    on_region=on_region, observations=observations\n",
    ")\n",
    "bkg_estimator.run()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 866 ms, sys: 26.1 ms, total: 892 ms\n",
      "Wall time: 898 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "ebounds = energy_logspace(0.7, 100, 51, unit=\"TeV\")\n",
    "extraction = SpectrumExtraction(\n",
    "    observations=observations,\n",
    "    bkg_estimate=bkg_estimator.result,\n",
    "    containment_correction=False,\n",
    "    e_reco=ebounds,\n",
    "    e_true=ebounds,\n",
    ")\n",
    "extraction.run()\n",
    "spectrum_observations = extraction.spectrum_observations"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Light curve estimation\n",
    "\n",
    "OK, so now that we have prepared 1D spectra (not spectral models, just the 1D counts and exposure and 2D energy dispersion matrix), we can compute a lightcurve.\n",
    "\n",
    "To compute the light curve, a spectral model shape has to be assumed, and an energy band chosen.\n",
    "The method is then to adjust the amplitude parameter of the spectral model in each time bin to the data, resulting in a flux measurement in each time bin."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Creat list of time bin intervals\n",
    "# Here we do one time bin per observation\n",
    "time_intervals = [(obs.tstart, obs.tstop) for obs in observations]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Assumed spectral model\n",
    "spectral_model = PowerLaw(\n",
    "    index=2, amplitude=2.0e-11 * u.Unit(\"1 / (cm2 s TeV)\"), reference=1 * u.TeV\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "energy_range = [1, 100] * u.TeV"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 767 ms, sys: 23.1 ms, total: 790 ms\n",
      "Wall time: 795 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "lc_estimator = LightCurveEstimator(extraction)\n",
    "lc = lc_estimator.light_curve(\n",
    "    time_intervals=time_intervals,\n",
    "    spectral_model=spectral_model,\n",
    "    energy_range=energy_range,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Results\n",
    "\n",
    "The light curve measurement result is stored in a table. Let's have a look at the results:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['time_min', 'time_max', 'flux', 'flux_err', 'flux_ul', 'is_ul', 'livetime', 'alpha', 'n_on', 'n_off', 'measured_excess', 'expected_excess']\n"
     ]
    }
   ],
   "source": [
    "print(lc.table.colnames)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<i>Table length=4</i>\n",
       "<table id=\"table4713147248\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>time_min</th><th>time_max</th><th>flux</th><th>flux_err</th></tr></thead>\n",
       "<thead><tr><th></th><th></th><th>1 / (cm2 s)</th><th>1 / (cm2 s)</th></tr></thead>\n",
       "<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>\n",
       "<tr><td>53343.92234009259</td><td>53343.94186555556</td><td>1.8415530028767494e-11</td><td>1.901096920855279e-12</td></tr>\n",
       "<tr><td>53343.95421509259</td><td>53343.97369425926</td><td>1.998670964314257e-11</td><td>2.0213838634857846e-12</td></tr>\n",
       "<tr><td>53345.96198129629</td><td>53345.98149518518</td><td>2.193396904197396e-11</td><td>2.5543071221453397e-12</td></tr>\n",
       "<tr><td>53347.913196574074</td><td>53347.93271046296</td><td>2.321856396079876e-11</td><td>2.5699816445058737e-12</td></tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<Table length=4>\n",
       "     time_min           time_max     ...        flux_err       \n",
       "                                     ...      1 / (cm2 s)      \n",
       "     float64            float64      ...        float64        \n",
       "------------------ ----------------- ... ----------------------\n",
       " 53343.92234009259 53343.94186555556 ...  1.901096920855279e-12\n",
       " 53343.95421509259 53343.97369425926 ... 2.0213838634857846e-12\n",
       " 53345.96198129629 53345.98149518518 ... 2.5543071221453397e-12\n",
       "53347.913196574074 53347.93271046296 ... 2.5699816445058737e-12"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lc.table[\"time_min\", \"time_max\", \"flux\", \"flux_err\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "lc.plot();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$$2.0740149 \\times 10^{-11} \\; \\mathrm{\\frac{1}{s\\,cm^{2}}}$$"
      ],
      "text/plain": [
       "<Quantity 2.07401493e-11 1 / (cm2 s)>"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Let's compare to the expected flux of this source\n",
    "from gammapy.spectrum import CrabSpectrum\n",
    "\n",
    "crab_spec = CrabSpectrum().model\n",
    "crab_flux = crab_spec.integral(*energy_range).to(\"cm-2 s-1\")\n",
    "crab_flux"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = lc.plot(marker=\"o\", lw=2)\n",
    "ax.hlines(\n",
    "    crab_flux.value,\n",
    "    xmin=lc.table[\"time_min\"].min(),\n",
    "    xmax=lc.table[\"time_max\"].max(),\n",
    ");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "* Change the assumed spectral model shape (e.g. to a steeper power-law), and see how the integral flux estimate for the lightcurve changes.\n",
    "* Try a time binning where you split the observation time for every run into two time bins.\n",
    "* Try to analyse the PKS 2155 flare data from the H.E.S.S. first public test data release.\n",
    "  Start with per-observation fluxes, and then try fluxes within 5 minute time bins for one or two of the observations where the source was very bright."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
